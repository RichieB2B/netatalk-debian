<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>Netatalk 2.0 Manual</title><link rel="stylesheet" href="netatalk.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.65.1"><link rel="stylesheet" type="text/css" charset="iso-8859-1" href="printer.css" media="print"><link rel="alternate stylesheet" type="text/css" charset="iso-8859-1" href="printer.css" title="Printer"><link rel="copyright" title="GNU General Public License" href="http://www.gnu.org/copyleft/gpl.html#SEC1"><link rel="author" title="The Netatalk Development Team" href="http://netatalk.sf.net"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="book" lang="en"><div class="titlepage"><div><div><h1 class="title"><a name="netatalk-manual"></a>Netatalk 2.0 Manual</h1></div><div><p class="releaseinfo">2.0.3</p></div></div><div></div><hr></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="preface"><a href="#id2878179">Legal Notice</a></span></dt><dt><span class="chapter"><a href="#intro">1. Introduction to Netatalk</a></span></dt><dt><span class="chapter"><a href="#installation">2. Installation</a></span></dt><dd><dl><dt><span class="sect1"><a href="#id2865486">How to obtain Netatalk</a></span></dt><dd><dl><dt><span class="sect2"><a href="#id2865508">Binary packages</a></span></dt><dt><span class="sect2"><a href="#id2816810">Source packages</a></span></dt></dl></dd><dt><span class="sect1"><a href="#id2817100">Compiling Netatalk</a></span></dt><dd><dl><dt><span class="sect2"><a href="#id2817106">Prerequisites</a></span></dt><dt><span class="sect2"><a href="#compiling-netatalk">Compiling Netatalk</a></span></dt><dt><span class="sect2"><a href="#build-bdb">Compiling a new Berkeley DB for Netatalk</a></span></dt></dl></dd></dl></dd><dt><span class="chapter"><a href="#configuration">3. Setting up Netatalk</a></span></dt><dd><dl><dt><span class="sect1"><a href="#id2815063">Appletalk</a></span></dt><dd><dl><dt><span class="sect2"><a href="#id2815098">To use AppleTalk or not</a></span></dt><dt><span class="sect2"><a href="#id2815197">No AppleTalk routing</a></span></dt><dt><span class="sect2"><a href="#id2815406">atalkd acting as an AppleTalk router</a></span></dt></dl></dd><dt><span class="sect1"><a href="#id2815878">File Services</a></span></dt><dd><dl><dt><span class="sect2"><a href="#id2815941">Setting up the AFP file server</a></span></dt><dt><span class="sect2"><a href="#CNID-backends">CNID backends</a></span></dt><dt><span class="sect2"><a href="#charsets">Charsets/Unicode</a></span></dt><dt><span class="sect2"><a href="#authentication">Authentication</a></span></dt></dl></dd><dt><span class="sect1"><a href="#printing">Printing</a></span></dt><dd><dl><dt><span class="sect2"><a href="#papserver">Setting up the PAP print server</a></span></dt><dt><span class="sect2"><a href="#papclient">Using AppleTalk printers</a></span></dt></dl></dd><dt><span class="sect1"><a href="#timeservices">Time Services</a></span></dt><dd><dl><dt><span class="sect2"><a href="#timelord">Using Netatalk as a time server for Macintoshes</a></span></dt></dl></dd><dt><span class="sect1"><a href="#id2882707">Starting and stopping Netatalk</a></span></dt></dl></dd><dt><span class="chapter"><a href="#upgrade">4. Upgrading from a previous version of Netatalk</a></span></dt><dd><dl><dt><span class="sect1"><a href="#id2882998">Overview</a></span></dt><dt><span class="sect1"><a href="#volumes-and-filenames">Volumes and filenames</a></span></dt><dd><dl><dt><span class="sect2"><a href="#volupgrade">How to upgrade a volume to 2.0</a></span></dt><dt><span class="sect2"><a href="#capvol">How to use a 1.x CAP encoded volume with 2.0</a></span></dt><dt><span class="sect2"><a href="#id2883427">How to use a 1.x NLS volume with 2.0</a></span></dt></dl></dd><dt><span class="sect1"><a href="#choosecnidscheme">Choosing a CNID storage scheme</a></span></dt><dd><dl><dt><span class="sect2"><a href="#id2883994">How to upgrade if no persistent CNID storage was used</a></span></dt><dt><span class="sect2"><a href="#id2884034">How to upgrade if a persistent CNID storage scheme was
      used</a></span></dt><dt><span class="sect2"><a href="#bruteforceupgrade">How to upgrade if a persistent CNID storage scheme was used, the
      brute force approach</a></span></dt></dl></dd><dt><span class="sect1"><a href="#testserver">Setting up a test server on the same machine</a></span></dt><dd><dl><dt><span class="sect2"><a href="#id2884534">Setting up an empty test share</a></span></dt><dt><span class="sect2"><a href="#id2884563">Duplicating an already existing share</a></span></dt><dt><span class="sect2"><a href="#id2884598">Configuring and running the test afpd</a></span></dt></dl></dd></dl></dd><dt><span class="chapter"><a href="#man-pages">5. Manual Pages</a></span></dt><dt><span class="index"><a href="#manual-index">Index</a></span></dt></dl></div><div class="list-of-tables"><p><b>List of Tables</b></p><dl><dt>3.1. <a href="#id2881099">Netatalk UAM overview</a></dt></dl></div><div class="list-of-examples"><p><b>List of Examples</b></p><dl><dt>3.1. <a href="#id2815239">atalkd.conf containing one entry</a></dt><dt>3.2. <a href="#id2815268">atalkd.conf containing one entry after atalkd
            started</a></dt><dt>3.3. <a href="#id2815305">atalkd.conf containing several entries with the -dontroute
            option</a></dt><dt>3.4. <a href="#id2815331">atalkd.conf containing several entries with the -dontroute
            option after atalkd started</a></dt><dt>3.5. <a href="#id2815686">atalkd.conf making netatalk a seed router on two
        interfaces</a></dt><dt>3.6. <a href="#id2815734">atalkd.conf configured for "zone mapping"</a></dt><dt>3.7. <a href="#id2815766">atalkd.conf for a soft-seed router configuration</a></dt><dt>3.8. <a href="#id2815791">atalkd.conf for a soft-seed router configuration after atalkd
        started</a></dt><dt>3.9. <a href="#id2815839">atalkd.conf ready for mixed seed/soft-seed mode</a></dt><dt>3.10. <a href="#id2882500">pap printing to a PostScript
        LaserWriter</a></dt><dt>3.11. <a href="#id2882538">pap printing to a non-PostScript
        printer</a></dt><dt>5.1. <a href="#id2888575">Three server definitions using 2 different server
            signatures</a></dt><dt>5.2. <a href="#id2888705">Some ways to change afpd's logging behaviour via
            -[un]setuplog</a></dt><dt>5.3. <a href="#id2888802">afpd.conf default configuration</a></dt><dt>5.4. <a href="#id2888820">afpd.conf MacCyrillic setup / UTF8 unix locale</a></dt><dt>5.5. <a href="#id2888837">afpd.conf setup for Kerberos V auth</a></dt><dt>5.6. <a href="#id2888856">afpd.conf letting afpd appear as three servers on the net</a></dt><dt>5.7. <a href="#id2890378">Using variable substitution when defining volumes</a></dt><dt>5.8. <a href="#id2890804">use a 1.x style volume</a></dt><dt>5.9. <a href="#id2890844">use a 1.x style volume, created with maccode.iso8859-1</a></dt><dt>5.10. <a href="#id2900462">papd.conf System V printing system examples</a></dt><dt>5.11. <a href="#id2900521">papd.conf examples using pipes</a></dt><dt>5.12. <a href="#id2900619">papd.conf CUPS examples</a></dt></dl></div><div class="preface" lang="en"><div class="titlepage"><div><div><h2 class="title"><a name="id2878179"></a>Legal Notice</h2></div></div><div></div></div><p>
This documentation is distributed under the GNU General Public License (GPL) version 2.  
A copy of the license is included in this documentation, as well as within the Netatalk source
distribution.  An on-line copy can be found at <a href="http://www.fsf.org/licenses/gpl.txt" target="_top">http://www.fsf.org/licenses/gpl.txt</a>
</p></div><div class="chapter" lang="en"><div class="titlepage"><div><div><h2 class="title"><a name="intro"></a>Chapter 1. Introduction to Netatalk</h2></div></div><div></div></div><p>Netatalk is an OpenSource software package, that can be used to turn
  an inexpensive *NIX machine into an extremely performant and reliable file
  and print server for Macintosh computers.</p><p>Using Netatalk's AFP 3.1 compliant file-server leads to significantly
  higher transmission speeds compared with Macs accessing a server via
  SaMBa/NFS while providing clients with the best possible user experience
  (full support for Macintosh metadata, flawlessly supporting mixed
  environments of classic MacOS and MacOS X clients)</p><p>Due to Netatalk speaking AppleTalk, the print-server task can provide
  printing clients with full AppleTalk support as well as the server itself
  with printing capabilities for AppleTalk-only printers. Starting with
  version 2.0, Netatalk seamlessly interacts with CUPS on the server.</p><p>After all, Netatalk can be used to act as an AppleTalk router,
  providing both segmentation and zone names in Macintosh networks.</p></div><div class="chapter" lang="en"><div class="titlepage"><div><div><h2 class="title"><a name="installation"></a>Chapter 2. Installation</h2></div></div><div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="sect1"><a href="#id2865486">How to obtain Netatalk</a></span></dt><dd><dl><dt><span class="sect2"><a href="#id2865508">Binary packages</a></span></dt><dt><span class="sect2"><a href="#id2816810">Source packages</a></span></dt></dl></dd><dt><span class="sect1"><a href="#id2817100">Compiling Netatalk</a></span></dt><dd><dl><dt><span class="sect2"><a href="#id2817106">Prerequisites</a></span></dt><dt><span class="sect2"><a href="#compiling-netatalk">Compiling Netatalk</a></span></dt><dt><span class="sect2"><a href="#build-bdb">Compiling a new Berkeley DB for Netatalk</a></span></dt></dl></dd></dl></div><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Warning</h3><p>If you have previously used an older version of Netatalk, please
    read the chapter about <a href="#upgrade" title="Chapter 4. Upgrading from a previous version of Netatalk">upgrading</a> first
    !!!</p></div><p></p><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="id2865486"></a>How to obtain Netatalk</h2></div></div><div></div></div><p>Please have a look at the netatalk page on sourceforge for the most
    recent informations on this issue.</p><p><a href="http://sourceforge.net/projects/netatalk/" target="_top">http://sourceforge.net/projects/netatalk/</a></p><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="id2865508"></a>Binary packages</h3></div></div><div></div></div><p>Binary packages of Netatalk are included in some Linux and UNIX
      distributions. You might want to have a look at the usual locations, too
      (<a href="http://rpmfind.net/" target="_top">http://rpmfind.net/</a>, <a href="http://packages.debian.org/" target="_top">http://packages.debian.org/</a>,
      <a href="http://www.blastwave.org/" target="_top">http://www.blastwave.org/</a>
      <a href="http://www.freebsd.org/ports/index.html" target="_top">http://www.freebsd.org/ports/index.html</a>,
      etc.)<a class="indexterm" name="id2816767"></a><a class="indexterm" name="id2816780"></a><a class="indexterm" name="id2816794"></a></p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="id2816810"></a>Source packages</h3></div></div><div></div></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="id2816817"></a>Tarballs</h4></div></div><div></div></div><p>Prepacked tarballs in .tar.gz and tar.bz2 format are available
        on the netatalk page on sourceforge</p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="id2816832"></a>Anonymous CVS<a class="indexterm" name="id2816839"></a></h4></div></div><div></div></div><p>Downloading of the CVS source can be done quickly and
        easily.</p><div class="orderedlist"><ol type="1"><li><p>Make sure you have cvs installed. <span><b class="command">which
            cvs</b></span> should produce a path to cvs.</p><pre class="screen"><tt class="prompt">$&gt;</tt> <b class="userinput"><tt>which cvs</tt></b>
<tt class="computeroutput">/usr/bin/cvs</tt></pre></li><li><p>If you don't have one make a source directory.
            <span><b class="command">cd</b></span> to this directory.</p><pre class="screen"><tt class="prompt">$&gt;</tt> <b class="userinput"><tt>mkdir /path/to/new/source/dir</tt></b>
<tt class="prompt">$&gt;</tt> <b class="userinput"><tt>cd /path/to/new/source/dir</tt></b></pre></li><li><p>Authenticate yourself with cvs. Just hit enter for the
            password for the anonymous user.</p><pre class="screen"><tt class="prompt">$&gt;</tt> <b class="userinput"><tt>cvs -d:pserver:anonymous@cvs.sourceforge.net:/cvsroot/netatalk login</tt></b>
<tt class="computeroutput">Logging in to :pserver:anonymous@cvs.sourceforge.net:2401/cvsroot/netatalk
CVS password: </tt><b class="userinput"><tt>[Enter]</tt></b>
</pre></li><li><p>Now get the source:</p><pre class="screen"><tt class="prompt">$&gt;</tt> <b class="userinput"><tt>cvs -z3 -d:pserver:anonymous@cvs.sourceforge.net:/cvsroot/netatalk
    -r branch-netatalk-2-0 co netatalk
</tt></b><tt class="computeroutput">cvs server: Updating netatalk
U netatalk/.cvsignore
U netatalk/CONTRIBUTORS
U netatalk/COPYING
...
</tt></pre><p>This will create a local directory called "netatalk" and
            downloads a complete and fresh copy of the netatalk source from
            the CVS repository.</p></li><li><p>Now <span><b class="command">cd</b></span> to the netatalk directory and run
            <span><b class="command">./autogen.sh</b></span>. This will create the
            <tt class="filename">configure</tt> script required in the next
            step.</p><pre class="screen"><tt class="prompt">$&gt;</tt> <b class="userinput"><tt>./autogen.sh</tt></b></pre></li></ol></div><p></p></div></div></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="id2817100"></a>Compiling Netatalk</h2></div></div><div></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="id2817106"></a>Prerequisites</h3></div></div><div></div></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="id2817114"></a>System requirements</h4></div></div><div></div></div><p>Your system needs to meet the following requirements:</p><div class="itemizedlist"><ul type="disc"><li><p>A C compiler, Netatalk compiles fine with gcc &gt;
            2.7.95</p></li></ul></div><p>To be able to compile with AFP3 support, your system has to
        support large files (&gt;2GB).</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>On linux systems glibc &gt; 2.2 is required.</p></div><p></p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="id2817163"></a>Required third party software</h4></div></div><div></div></div><p>Netatalk makes use of sleepycats' Berkeley DB<a class="indexterm" name="id2817175"></a>. At the time of writing, the following versions are
        supported:</p><div class="itemizedlist"><ul type="disc"><li><p>4.1.25</p></li><li><p>4.2.52 (recommended)</p></li></ul></div><p>In case Berkeley DB is not installed on your system, please
        download it from:</p><p><a href="http://www.sleepycat.com/download/db/index.shtml" target="_top">http://www.sleepycat.com/download/db/index.shtml</a></p><p>and follow the <a href="#build-bdb" title="Compiling a new Berkeley DB for Netatalk">installation
        instructions</a>.</p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="id2817243"></a>Optional third party software</h4></div></div><div></div></div><p>Netatalk can use the following third party software to enhance
        it's functionality.</p><div class="itemizedlist"><ul type="disc"><li><p>OpenSSL (recommended)</p><p>OpenSSL is required for encrypted passwords. Without it, the
            password will be sent over the network in clear text.</p></li><li><p>TCP wrappers</p><p>Wietse Venema's network logger, also known as TCPD or
            LOG_TCP.</p><p>Security options are: access control per host, domain and/or
            service; detection of host name spoofing or host address spoofing;
            booby traps to implement an early-warning system.</p><p>TCP Wrappers can be downloaded from: <a href="ftp://ftp.porcupine.org/pub/security" target="_top">ftp://ftp.porcupine.org/pub/security</a>/</p></li><li><p>PAM<a class="indexterm" name="id2817317"></a></p><p>PAM provides a flexible mechanism for authenticating users.
            PAM was invented by SUN<a class="indexterm" name="id2817339"></a> Microsystems. Linux-PAM is a suite of shared
            libraries that enable the local system administrator to choose how
            applications authenticate users.</p><p>You can get the Linux PAM documentation and sources from
            <a href="http://www.kernel.org/pub/linux/libs/pam/" target="_top">http://www.kernel.org/pub/linux/libs/pam/</a>.</p></li><li><p>OpenSLP</p><p>SLP<a class="indexterm" name="id2817384"></a> (Service Location Protocol) is an IETF<a class="indexterm" name="id2817400"></a> standards track protocol that provides a framework
            to allow networking applications to discover the existence,
            location, and configuration of networked services in enterprise
            networks.</p><p>Mac OS X uses it to locate AFP servers, even though newer
            version prefer Rendezvous.</p><p>You can download OpenSLP from: <a href="http://www.openslp.org/" target="_top">http://www.openslp.org/</a>.</p></li><li><p>iconv</p><p>iconv provides conversion routines for many character
            encodings. Netatalk uses it to provide charsets it does not have
            built in conversions for, like ISO-8859-1. On glibc systems,
            Netatalk can use the glibc provided iconv implementation.
            Otherwise you can use the GNU libiconv implementation.</p><p>You can download GNU libiconv from: <a href="http://www.gnu.org/software/libiconv/" target="_top">http://www.gnu.org/software/libiconv/</a>.</p></li></ul></div></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="compiling-netatalk"></a>Compiling<a class="indexterm" name="id2817487"></a> Netatalk</h3></div></div><div></div></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="id2817503"></a>Configuring the build</h4></div></div><div></div></div><p>To build the binaries, first run the program
        <span><b class="command">./configure</b></span> in the source directory. This should
        automatically configure Netatalk for your operating system. If you
        have unusual needs, then you may wish to run</p><pre class="screen">$&gt; <b class="userinput"><tt>./configure --help</tt></b></pre><p>to see what special options you can enable.</p><p>The most used configure options are:</p><div class="itemizedlist"><ul type="disc"><li><p>--enable-[redhat/suse/cobalt/netbsd/fhs]</p><p>This option helps netatalk to determine where to install the
            start scripts.</p></li><li><p><tt class="option">--with-bdb</tt>=<i class="replaceable"><tt>/path/to/bdb/installation/</tt></i></p><p>In case you installed Berkeley DB in a non-standard
            location, you will <span class="emphasis"><em>have</em></span> to give the install
            location to netatalk, using this switch.</p></li></ul></div><p>Now run configure with any options you need</p><pre class="screen"><tt class="prompt">$&gt;</tt> <b class="userinput"><tt>./configure [arguments] [--with-bdb=/bdb/install/path]</tt></b></pre><p>Configure will end up in an overview showing the settings the
        Netatalk Makefiles have been created with.</p><p>If this step fails please visit the <a href="http://netatalk.sourceforge.net/wiki/index.php/Troubleshooting" target="_top">troubleshooting
        guide</a>.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>With recent RedHat releases, Berkeley DB links to libpthread.
          Netatalk does not link to libpthread, so detection of Berkeley DB
          fails when running configure. It's recommended to <a href="#build-bdb" title="Compiling a new Berkeley DB for Netatalk">(re)compile Berkeley DB</a> with
          <tt class="option">--with-mutex="x86/gcc-assembly"</tt> (on x86 platforms)
          to disable the use of libpthread. Alternatively you could use</p><pre class="screen"><tt class="prompt">$&gt;</tt><b class="userinput"><tt> LIBS="-lpthread" ./configure [arguments]</tt></b></pre><p>to trick Netatalk into linking to libpthread. However, this is
          not recommended, as there have been some trouble reports indicating
          that linking to libpthread badly damages performance.</p></div><p>Next, running</p><pre class="screen"><tt class="prompt">$&gt;</tt> <b class="userinput"><tt>make</tt></b></pre><p>should produce the Netatalk binaries (this step can take several
        minutes to complete).</p><p>When the process finished you can use</p><pre class="screen"><tt class="prompt">$&gt;</tt> <b class="userinput"><tt>make install</tt></b></pre><p>to install the binaries and documentation (must be done as
        "root" when using default locations).</p></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="build-bdb"></a>Compiling a new Berkeley DB for Netatalk</h3></div></div><div></div></div><p>Netatalk 2.0 requires Berkeley DB version 4.1.25 or newer. Even if
      you already have a supported version of Berkeley DB installed on your
      system, there are several reasons, why you might still want to consider
      building a new version for Netatalk.</p><p>Many linux distributions provide a precompiled Berkeley DB
      version. This is usually nice, but also has one major drawback: If you
      update your system to a newer release, the installed version of Berkeley
      DB may change. This can lead to a number of problems, starting with
      strange behaviour of Netatalk, unreadable CNID Databases. Most likely
      Netatalk(afpd) won't start anymore, so you'll have to recompile
      Netatalk.</p><p>For instructions compiling Berkeley DB, you should generally refer
      to the documentation provided by Sleepycat. The following information is
      meant to help you avoid problems, users experienced in the past.</p><p>In case you are building on a recent RedHat release, please use
      <tt class="option">--with-mutex="x86/gcc-assembly"</tt> on x86 platforms to
      prevent Berkeley DB from linking against libpthread.</p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="id2817798"></a>Using a statically linked Berkeley DB</h4></div></div><div></div></div><p>To link Netatalk statically to Berkeley DB, you have to disable
        shared libraries when building Berkeley DB. If shared libraries exist,
        Netatalk will always link to them, even if a static version exists in
        the same location.</p><pre class="screen"><tt class="prompt">root#</tt> <b class="userinput"><tt>cd build_unix</tt></b>
<tt class="prompt">root#</tt> <b class="userinput"><tt>../dist/configure --prefix=/install/path --disable-shared</tt></b>
<tt class="prompt">root#</tt> <b class="userinput"><tt>make</tt></b>
<tt class="prompt">root#</tt> <b class="userinput"><tt>make install</tt></b></pre><p>You should now continue with <a href="#compiling-netatalk" title="Compiling Netatalk">building Netatalk</a>.</p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="id2814884"></a>Using a dynamically linked Berkeley DB</h4></div></div><div></div></div><p>Building a shared version of Berkeley DB is rather
        straightforward. However, especially under Linux, some care needs to
        be taken. Underlying system libraries, i.e. libnss_db, might be using
        Berkeley DB as well. As these libraries have likely been build with
        another, i.e. older, version of Berkeley DB, linking afpd to a newer
        version can lead to unexpected results.</p><p>You need to configure Berkeley DB with the
        <tt class="option">--with-uniquename</tt> configure switch to avoid these
        kind of problems. This insures your new version will not interfere
        with another installation of Berkeley DB on your system.</p><pre class="screen"><tt class="prompt">root#</tt> <b class="userinput"><tt>cd build_unix</tt></b>
<tt class="prompt">root#</tt> <b class="userinput"><tt>../dist/configure --prefix=/install/path --with-uniquename</tt></b>
<tt class="prompt">root#</tt> <b class="userinput"><tt>make</tt></b>
<tt class="prompt">root#</tt> <b class="userinput"><tt>make install</tt></b></pre><p>If you select an install path other than
        <tt class="filename">/usr/local</tt>, you will have to configure your
        linker to look for libraries in this directory.</p><p>On many operating systems, this is done by adding a new entry to
        <tt class="filename">/etc/ld.so.conf</tt>.</p><pre class="screen"><tt class="prompt">root#</tt> <b class="userinput"><tt>echo /install/path/lib &gt;/etc/ld.so.conf</tt></b>
<tt class="prompt">root#</tt> <b class="userinput"><tt>ldconfig</tt></b></pre><p>You should now continue with <a href="#compiling-netatalk" title="Compiling Netatalk">building Netatalk</a>.</p></div></div></div></div><div class="chapter" lang="en"><div class="titlepage"><div><div><h2 class="title"><a name="configuration"></a>Chapter 3. Setting up Netatalk</h2></div></div><div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="sect1"><a href="#id2815063">Appletalk</a></span></dt><dd><dl><dt><span class="sect2"><a href="#id2815098">To use AppleTalk or not</a></span></dt><dt><span class="sect2"><a href="#id2815197">No AppleTalk routing</a></span></dt><dt><span class="sect2"><a href="#id2815406">atalkd acting as an AppleTalk router</a></span></dt></dl></dd><dt><span class="sect1"><a href="#id2815878">File Services</a></span></dt><dd><dl><dt><span class="sect2"><a href="#id2815941">Setting up the AFP file server</a></span></dt><dt><span class="sect2"><a href="#CNID-backends">CNID backends</a></span></dt><dt><span class="sect2"><a href="#charsets">Charsets/Unicode</a></span></dt><dt><span class="sect2"><a href="#authentication">Authentication</a></span></dt></dl></dd><dt><span class="sect1"><a href="#printing">Printing</a></span></dt><dd><dl><dt><span class="sect2"><a href="#papserver">Setting up the PAP print server</a></span></dt><dt><span class="sect2"><a href="#papclient">Using AppleTalk printers</a></span></dt></dl></dd><dt><span class="sect1"><a href="#timeservices">Time Services</a></span></dt><dd><dl><dt><span class="sect2"><a href="#timelord">Using Netatalk as a time server for Macintoshes</a></span></dt></dl></dd><dt><span class="sect1"><a href="#id2882707">Starting and stopping Netatalk</a></span></dt></dl></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="id2815063"></a>Appletalk<a class="indexterm" name="id2815069"></a></h2></div></div><div></div></div><p>AppleTalk, the network protocol family founded by Apple, contains
    different protocols for different uses (address resolution, address/name
    mapping, service location, establishing connections, and the like)</p><p>A complete overview can be found inside the developer
    documentation.</p><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="id2815098"></a>To use AppleTalk or not</h3></div></div><div></div></div><p>You'll need the AppleTalk support built into netatalk in case you
      want to provide printing services via PAP by <a href="papd.8.html"><span class="citerefentry"><span class="refentrytitle">papd</span>(8)</span></a> or file services via AppleTalk via <a href="afpd.8.html"><span class="citerefentry"><span class="refentrytitle">afpd</span>(8)</span></a> for older AFP clients not capable of using AFP over
      TCP. You'll need it also, if you want to use the deprecated
      AppleTalk-based timeserver <a href="timelord.8.html"><span class="citerefentry"><span class="refentrytitle">timelord</span>(8)</span></a> for older Mac clients.</p><p>But even if you don't need PAP or AFP over AppleTalk, you might
      consider using AppleTalk for service propagation/location, having the
      ease of use for your network clients in mind. The Apple engineers
      implemented a way to easily locate an AFP server via AppleTalk but
      establishing the AFP connection itself via AFP over TCP (see the
      developer documentation for details on this cool feature, too).</p><p>To use the different base AppleTalk protocols with netatalk, one
      has to use <a href="atalkd.8.html"><span class="citerefentry"><span class="refentrytitle">atalkd</span>(8)</span></a>. It can also be used as an AppleTalk router to connect
      different independent network segments to each other.</p><p>To use AppleTalk/atalkd, your system has to have kernel support
      for AppleTalk. On some systems supported by netatalk, this isn't
      currently true (notably True64 Unix) so you can use only netatalk
      services that do not rely on AppleTalk (which means "AFP over TCP" and
      requires the -noddp switch in afpd.conf).</p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="id2815197"></a>No AppleTalk routing</h3></div></div><div></div></div><p>This is the most simple form, you can use AppleTalk with netatalk.
      In case, you have only one network interface up and running, you haven't
      to deal with atalkd's config at all: atalkd will use AppleTalk's
      self-configuration features to get an AppleTalk address and to register
      itself in the network automagically.</p><p>In case, you have more than one active network interface, you have
      to make a decision:</p><div class="itemizedlist"><ul type="disc"><li><p>Using only one interface: Just add the interface name (en1,
          le0, eth2, ... for example) to atalkd.conf on a single line. Do only
          list <span class="emphasis"><em>one</em></span> interface here.</p><div class="example"><a name="id2815239"></a><p class="title"><b>Example 3.1. atalkd.conf containing one entry</b></p><pre class="programlisting">eth0</pre><p>Appletalk networking
            should be enabled on eth0 interface. All the necessary
            configuration will be fetched from the network</p></div><p>At startup time, atalkd will add the real settings (address
          and network and eventually a zone) to atalkd.conf on its own</p><div class="example"><a name="id2815268"></a><p class="title"><b>Example 3.2. atalkd.conf containing one entry after atalkd
            started</b></p><pre class="programlisting">eth0 -phase 2 -net 0-65534 -addr 65280.166</pre><p>
            atalkd filled in the AppleTalk settings that apply to this network
            segment. A netrange of 0-65534 indicates that there is no
            AppleTalk router present, so atalkd will fetch an address that
            matches the following criteria: netrange from inside the so called
            "startup range" 65280-65533 and a node address between 142 and
            255.</p></div></li><li><p>When using several interfaces you have to add them line by
          line following the "-dontroute" switch in atalkd.conf.</p><div class="example"><a name="id2815305"></a><p class="title"><b>Example 3.3. atalkd.conf containing several entries with the -dontroute
            option</b></p><pre class="programlisting">eth0 -dontroute
eth1 -dontroute
eth2 -dontroute</pre><p>Appletalk networking should be enabled on all
            three interfaces, but no routing should be done between the
            different segments. Again, all the necessary configuration will be
            fetched from the connected networks.</p></div><div class="example"><a name="id2815331"></a><p class="title"><b>Example 3.4. atalkd.conf containing several entries with the -dontroute
            option after atalkd started</b></p><pre class="programlisting">eth0 -dontroute -phase 2 -net 0-65534 -addr 65280.152
eth1 -dontroute -phase 2 -net 0-65534 -addr 65280.208
eth2 -dontroute -phase 2 -net 1-1000 -addr 10.142 -zone "Printers"</pre><p>
            On eth0 and eth1, there are no other routers present, so atalkd
            chooses an address from within the startup range. But on eth2
            there lives an already connected AppleTalk router, publishing one
            zone called "Printers" and forcing clients to assign themselves an
            address in a netrange between 1 and 1000.</p></div><p>In this case, atalkd will handle each interface as it would be
          the only active one. This can have some side effects when it comes
          to the point where AFP clients want to do the magic switch from
          AppleTalk to TCP, so use this with caution.</p></li></ul></div><p>In case, you have more than one active network interface and do
      not take special precautions as outlined above, then autoconfiguration
      of the interfaces might fail in a situation where one of your network
      interfaces is connected to a network where <span class="emphasis"><em>no</em></span> other
      active AppleTalk router is present and supplies appropriate routing
      settings.</p><p>For further information see <a href="atalkd.conf.5.html"><span class="citerefentry"><span class="refentrytitle">atalkd.conf</span>(5)</span></a> and the developer documentation.</p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="id2815406"></a>atalkd acting as an AppleTalk router<a class="indexterm" name="id2815413"></a></h3></div></div><div></div></div><p>There exist several types of AppleTalk routers: seed, non-seed and
      so called soft-seed routers.</p><div class="itemizedlist"><ul type="disc"><li><p>A seed router has its own configuration and publishes this
          into the network segments it is configured for.</p></li><li><p>A non-seed router needs a seed router on the interface to
          which it is connected to learn the network configuration. So this
          type of AppleTalk router can work completely without manual
          configuration.</p></li><li><p>A so called soft-seed router is exactly the same as a non-seed
          router except the fact, that it can also remember the configuration
          of a seed router and act as a replacement in case, the real seed
          router disappears from the net.</p></li></ul></div><p>Netatalk's atalkd can act as both a seed and a soft-seed router,
      even in a mixed mode, where it acts on one interface in this way and on
      the other in another.</p><p>If you leave your atalkd.conf completely empty or simply add all
      active interfaces line by line without using seed settings (atalkd will
      act identically in both cases), then atalkd is forced to act as a
      soft-seed router on each interface, so it will fail on the first
      interface, where no seed router is accessible to fetch routing
      information from.</p><p>In this case, other services, that depend on atalkd, might also
      fail.</p><p>So you should have atalkd act as a seed router on one or all
      active interfaces. A seed router has to supply informations
      about:</p><div class="itemizedlist"><ul type="disc"><li><p>The specific netrange on this segment</p></li><li><p>Its own AppleTalk address</p></li><li><p>The zones (one to many) available in this segment</p></li><li><p>The so called "default zone" for this segment</p></li></ul></div><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Warning</h3><p>Unless you are the network admin yourself, consider asking
        her/him before changing anything related to AppleTalk routing, as
        changing these settings might have side effects for all of your
        AppleTalk network clients!</p></div><p>In an AppleTalk network netranges have to be unique and must not
      overlap each other. Fortunately netatalk's atalkd is polite enough to
      check whether your settings are in conflict with already existing ones
      on the net. In such a case it simply discards your settings and tries to
      adapt the already established ones on the net (if in doubt, always check
      syslog for details).</p><p>Netranges, you can use, include pretty small ones, eg. 42-42, to
      very large ones, eg. 1-65279 - the latter one representing the maximum.
      In routed environments you can use any numbers in the range between 1
      and 65279 unless they do not overlap with settings of other connected
      subnets.</p><p>The own AppleTalk address consists of a net part and a node part
      (the former 16 bit, the latter 8 bit, for example 12057.143). Apple
      recommends using node addresses of 128 or above for servers, letting
      client Macs assign themselves an address faster (as they will primarily
      search for a node address within 1-127 in the supplied netrange). As we
      don't want to get in conflict with Apple servers, we prefer using node
      addresses of 142 or above.</p><p>AppleTalk zones have <span class="emphasis"><em>nothing</em></span> to do with
      physical networks. They're just a hint for your client's convenience,
      letting them locate network resources in a more comfortable/faster way.
      You can either use one zone name across multiple physical segments as
      well as more than one zone name on a single segment (and various
      combinations of this).</p><p>So all you have to do is to <span class="emphasis"><em>draw a network
      chart</em></span> containing the physical segments, the netranges you
      want to assign to each one, the zone names you want to publish in which
      segments and the default zone per segment (this is always the first zone
      name, you supply with the "-zone" switch in atalkd.conf).</p><p>Given, you finished the steps outlined above, you might want to
      edit atalkd.conf to fit your needs.</p><p>You'll have to set the following options in atalkd.conf:</p><div class="itemizedlist"><ul type="disc"><li><p>-net (use reasonable values between 1-65279 for each
          interface)</p><p>In case, this value is suppressed but -addr is present, the
          netrange from this specific address will be used</p></li><li><p>-addr (the net part must match the -net settings if present,
          the node address should be between 142 and 255)</p></li><li><p>-zone (can be used multiple times in one single line, the
          first entry is the default zone)</p></li></ul></div><p>Note that you are able to set up "zone mapping", that means
      publishing exactly the same zone name on all AppleTalk segments, as well
      as providing more than one single zone name per interface. Dumb
      AppleTalk devices, like LaserWriters, will always register themselves in
      the default zone (the first zone entry you use in atalkd.conf per
      interface), more intelligent ones will have the ability to choose one
      specific zone via a user interface.</p><div class="example"><a name="id2815686"></a><p class="title"><b>Example 3.5. atalkd.conf making netatalk a seed router on two
        interfaces</b></p><pre class="programlisting">eth0 -seed -phase 2 -net 1-1000 -addr 1000.142 -zone "Printers" -zone "Spoolers"
eth1 -seed -phase 2 -net 1001-2000 -addr 2000.142 -zone "Macs" -zone "Servers"</pre><p>
        The settings for eth0 force AppleTalk devices within the connected
        network to assign themselves an address in the netrange 1-1000. Two
        zone names are published into this segment, "Printers" being the so
        called "standard zone", forcing dumb AppleTalk devices like Laser
        printers to show up automatically into this zone. AppleTalk printer
        queues supplied by netatalk's papd can be registered into the zone
        "Spoolers" simply by adjusting the settings in <a href="papd.conf.5.html"><span class="citerefentry"><span class="refentrytitle">papd.conf</span>(5)</span></a>. On eth1 we use the different and non-overlapping
        netrange 1001-2000, set the default zone to "Macs" and publish a
        fourth zone name "Servers".</p></div><div class="example"><a name="id2815734"></a><p class="title"><b>Example 3.6. atalkd.conf configured for "zone mapping"</b></p><pre class="programlisting">eth0 -seed -phase 2 -net 1-1000 -addr 1000.142 -zone "foo"
lo0 -phase 1 -net 1 -addr 1.142 -zone "foo"</pre><p> We use the same
        network settings as in the example above but let atalkd publish the
        same zone name on both segments. As the same zone name will be used on
        all segments of the AppleTalk network no zone names will show up at
        all... but AppleTalk routing will still be active. In this case, we
        connect a so called "non-extended" LocalTalk network (phase 1) to an
        EtherTalk "extended" network (phase 2) transparently.</p></div><div class="example"><a name="id2815766"></a><p class="title"><b>Example 3.7. atalkd.conf for a soft-seed router configuration</b></p><pre class="programlisting">eth0
eth1
eth2</pre><p> As we have more than one interface, atalkd will try to
        act as an AppleTalk router between both segments. As we don't supply
        any network configuration on our own we depend on the availability of
        seed routers in every connected segment. If only one segment is
        without such an available seed router the whole thing will
        fail.</p></div><div class="example"><a name="id2815791"></a><p class="title"><b>Example 3.8. atalkd.conf for a soft-seed router configuration after atalkd
        started</b></p><pre class="programlisting">eth0 -phase 2 -net 10-10 -addr 10.166 -zone "Parking"
eth1 -phase 2 -net 10000-11000 -addr 10324.151 -zone "No Parking" -zone "Parking"
eth2 -phase 2 -net 65279-65279 -addr 65279.142 -zone "Parking" -zone "No Parking"</pre><p>
        In this case, active seed routers are present in all three connected
        networks, so atalkd was able to fetch the network configuration from
        them and, since the settings do not conflict, act as a soft-seed
        router from now on between the segments. So even in case, all of the
        three seed routers would disappear from the net, atalkd would still
        supply the connected network with the network configuration once
        learned from them. Only in case, atalkd would be restarted afterwards,
        the routing information will be lost (as we're not acting as seed
        router).</p></div><div class="example"><a name="id2815839"></a><p class="title"><b>Example 3.9. atalkd.conf ready for mixed seed/soft-seed mode</b></p><pre class="programlisting">eth0
eth1 -seed -phase 2 -net 99-100 -addr 99.200 -zone "Testing"</pre><p>
        In case in the network connected to eth0 lives no active seed router
        or one with a mismatching configuration (eg. an overlapping netrange
        of 1-200) atalkd will fail. Otherwise it will fetch the configuration
        from this machine and will route between eth0 and eth1, on the latter
        acting as a seed router itself.</p></div><p>By the way: It is perfectly legal to have more than one seed
      router connected to a network segment. But in this case, you should take
      care that the configuration of all connected routers is exactly the same
      regarding netranges, published zone names and also the "standard zone"
      per segment</p></div></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="id2815878"></a>File Services<a class="indexterm" name="id2815884"></a></h2></div></div><div></div></div><p>Netatalk supplies two different transport protocols for
    AFP<a class="indexterm" name="id2815902"></a> services and both can run at the same time. Classic AFP
    over AppleTalk requires the <span><b class="command">afpd</b></span> and
    <span><b class="command">atalkd</b></span> daemons. AFP over IP only requires
    <span><b class="command">afpd</b></span>.</p><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="id2815941"></a>Setting up the AFP file server</h3></div></div><div></div></div><p>AFP (the Apple Filing Protocol) is the protocol Apple Macintoshes
      use for file services. The protocol has evolved over the years, at the
      time of this writing 7 different "versions" exist. The latest changes to
      the protocol, called "AFP 3.1", were added with the release of
      Panther<a class="indexterm" name="id2815958"></a> (Mac OS X 10.3).</p><p>AFP3 brought some big changes. For the first time,
      AppleShare<a class="indexterm" name="id2878784"></a> Clients can use filenames up to 255 characters (actually
      255 bytes leading to 85-255 chars depending on the glyphs used), UTF-8
      is used on the wire and large files (&gt;4GB) are supported.</p><p>The afpd daemon offers the fileservices to Apple Clients. It's
      configured using the <tt class="filename">afpd.conf</tt> and the
      <tt class="filename">AppleVolumes.*</tt> files.</p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="id2878827"></a>afpd.conf</h4></div></div><div></div></div><p>afpd.conf is the configuration file used by afpd to determine
        the behaviour and configuration of the different virtual file servers
        that it provides. Any line not prefixed with <span class="keycode">'#</span>' is
        interpreted.</p><p>If afpd switches set on the command line are in conflict with
        afpd.conf settings, the latter will have higher priority.</p><p>Format: - [options] to specify options for the default server
        and/or "Server name" [options] to specify an additional server.</p><p>Leaving the afpd.conf file empty equals to the following
        configuration:</p><pre class="programlisting">- -transall -uamlist uams_guest.so,uams_clrtxt.so,uams_dhx.so -nosavepassword</pre><p>For a more detailed explanation of the available options, please
        refer to the <a href="afpd.conf.5.html"><span class="citerefentry"><span class="refentrytitle">afpd.conf</span>(5)</span></a> man page.</p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="id2878895"></a>AppleVolumes.default</h4></div></div><div></div></div><p>The AppleVolumes.default file is used to define volumes that
        will by default be shown to all users, including users logged in as
        guest. A volume will not be presented in the chooser, if the user has
        no read access to the specified volume path.</p><p>You can limit access to a specific volume by using the
        <tt class="option">allow</tt> and <tt class="option">deny</tt> options.</p><p>For a more detailed explanation of the available options, please
        refer to the <a href="AppleVolumes.default.5.html"><span class="citerefentry"><span class="refentrytitle">AppleVolumes.default</span>(5)</span></a> man page.</p></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="CNID-backends"></a>CNID<a class="indexterm" name="id2878957"></a> backends<a class="indexterm" name="id2878972"></a></h3></div></div><div></div></div><p>Unlike other protocols like smb or nfs, the AFP protocol mostly
      refers to files and directories by ID and not by a path (the IDs are
      also called CNID, that means Catalog Node ID). A typical AFP request
      uses a directory ID<a class="indexterm" name="id2878995"></a> and a filename, something like <span>"server, please
      open the file named 'Test' in the directory with id 167"</span>. For
      example "Aliases" on the Mac basically work by ID (with a fallback to
      the absolute path in more recent AFP clients. But this applies only to
      Finder, not to applications).</p><p>Every file in an AFP volume has to have a unique file ID<a class="indexterm" name="id2879025"></a>, IDs must, according to the specs, never be reused, and
      IDs are 32 bit numbers (Directory IDs use the same ID pool). So, after
      ~4 billion files/folders have been written to an AFP volume, the ID pool
      is depleted and no new file can be written to the volume. No whining
      please :-)</p><p>Netatalk needs to map IDs to files and folders in the host
      filesystem. To achieve this, several different CNID backends<a class="indexterm" name="id2879053"></a> are available and can be choosed by the
      <tt class="option">cnidscheme</tt><a class="indexterm" name="id2879068"></a> option in the <a href="AppleVolumes.default.5.html"><span class="citerefentry"><span class="refentrytitle">AppleVolumes.default</span>(5)</span></a> configuration file. A CNID backend is basically a
      database storing ID &lt;-&gt; name mappings.</p><p>In the past, many users used the so called "last" CNID scheme.
      However, this scheme has some serious drawbacks, as it is based on the
      device and inode of a file. Therefore, IDs will be eventually be reused
      and you can get duplicate IDs as well.</p><p>The CNID Databases are by default located in the
      .AppleDB<a class="indexterm" name="id2879114"></a> folder in every afpd volume root. With the new
      ADv2<a class="indexterm" name="id2879130"></a> format, afpd stores the files/directories ID in the
      corresponding .AppleDouble file as well.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>There are some CNID related things you should keep in mind when
        working with netatalk:</p><div class="itemizedlist"><ul type="disc"><li><p>Don't use unix symlinks<a class="indexterm" name="id2879168"></a>. Just don't. With a symlink a file/directory
            "exists" twice, something AFP doesn't allow. There's currently no
            way this can be resolved, as we either end up with two file/dirs
            having the same id, or a file having two parents. If you still
            insist on using them, be aware you're <span class="emphasis"><em>heavily</em></span>
            violating the specs. You have been warned...</p></li><li><p>Don't nest volumes<a class="indexterm" name="id2879204"></a>.</p></li><li><p>CNID backends are databases, so they turn afpd into a file
            server/database mix. Keep this in mind, killing an afpd process
            with <span><b class="command">kill -9</b></span> will likely leave the database
            unusable.</p></li><li><p>If there's no more space on the filesystem left, the
            database will get corrupted. You can work around this by either
            using the -dbpath option and put the database files into another
            location or, if you use quotas, make sure the .AppleDB folder is
            owned by a user/group without a quota<a class="indexterm" name="id2879249"></a>.</p></li><li><p>Be careful with CNID databases for volumes that are mounted
            via NFS. That is a pretty audacious decision to make anyway, but
            putting a database there as well is really asking for trouble,
            i.e. database corruption. Use the dbpath: directive in the
            <tt class="filename">AppleVolumes.*</tt> configuration files to put the
            databases onto a local disk if you must use NFS<a class="indexterm" name="id2879288"></a> mounted volumes.</p></li></ul></div></div><p></p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="id2879310"></a>cdb<a class="indexterm" name="id2879317"></a></h4></div></div><div></div></div><p>The "concurrent database" backend is based on sleepycat's
        Berkeley DB. With this backend, several afpd daemons access the CNID
        database directly. Berkeley DB locking is used to synchronize access,
        if more than one afpd process is active for a volume. The drawback is,
        that the crash of a single afpd process might corrupt the
        database.</p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="id2879343"></a>dbd<a class="indexterm" name="id2879351"></a></h4></div></div><div></div></div><p>Access to the CNID database is restricted to the cnid_dbd daemon
        process. afpd processes communicate with the daemon for database reads
        and updates. If built with Berkeley DB transactions, the probability
        for database corruption is practically zero, but performance can be
        slower than with cdb. As a database process gets spawned for each
        volume, you're probably better off using cdb for sharing home
        directories for a larger number of users.</p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="id2879389"></a>last<a class="indexterm" name="id2879396"></a></h4></div></div><div></div></div><p>The last backend is a semi-persistent backend. IDs will be
        reused and, what is much worse, you can get duplicate IDs. You should
        use it for sharing cdroms only, <span class="emphasis"><em>don't</em></span> use it for
        sharing normal volumes.</p></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="charsets"></a>Charsets<a class="indexterm" name="id2879436"></a>/Unicode<a class="indexterm" name="id2879451"></a></h3></div></div><div></div></div><p></p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="id2879464"></a>Why Unicode?</h4></div></div><div></div></div><p>Internally, computers don't know anything about characters and
        texts, they only know numbers. Therefore, each letter is assigned a
        number. A character set, often referred to as
        <span class="emphasis"><em>charset</em></span> or
        <span class="emphasis"><em>codepage</em></span><a class="indexterm" name="id2879486"></a>, defines the mappings between numbers and
        letters.</p><p>If two or more computer systems need to communicate with each
        other, the have to use the same character set. In the 1960s the
        ASCII<a class="indexterm" name="id2879505"></a> (American Standard Code for Information Interchange)
        character set was defined by the American Standards Association. The
        original form of ASCII represented 128 characters, more than enough to
        cover the English alphabet and numerals. Up to date, ASCII has been
        the normative character scheme used by computers.</p><p>Later versions defined 256 characters to produce a more
        international fluency and to include some slightly esoteric graphical
        characters. Using this mode of encoding each character takes exactly
        one byte. Obviously, 256 characters still wasn't enough to map all the
        characters used in the various languages into one character
        set.</p><p>As a result localized character sets were defined later, e.g the
        ISO-8859 character sets. Most operating system vendors introduced
        their own characters sets to satisfy their needs, e.g. IBM defined the
        <span class="emphasis"><em>codepage 437 (DOSLatinUS)</em></span>, Apple introduced the
        <span class="emphasis"><em>MacRoman</em></span><a class="indexterm" name="id2879555"></a> codepage and so on. The characters that were assigned
        number larger than 127 were referred to as
        <span class="emphasis"><em>extended</em></span> characters. These character sets
        conflict with another, as they use the same number for different
        characters, or vice versa.</p><p>Almost all of those characters sets defined 256 characters,
        where the first 128 (0-127) character mappings are identical to ASCII.
        As a result, communication between systems using different codepages
        was effectively limited to the ASCII charset.</p><p>To solve this problem new, larger character sets were defined.
        To make room for more character mappings, these character sets use at
        least 2 bytes to store a character. They are therefore referred to as
        <span class="emphasis"><em>multibyte</em></span> character sets.</p><p>One standardized multibyte charset encoding scheme is known as
        <a href="http://www.unicode.org/" target="_top">unicode</a>. A big advantage
        of using a multibyte charset is that you only need one. There is no
        need to make sure two computers use the same charset when they are
        communicating.</p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="id2879620"></a>character sets used by Apple</h4></div></div><div></div></div><p>In the past, Apple clients used single-byte charsets to
        communicate over the network. Over the years Apple defined a number of
        codepages, western users will most likely be using the
        <span class="emphasis"><em>MacRoman</em></span> codepage.</p><p>Codepages defined by Apple include:</p><div class="itemizedlist"><ul type="disc"><li><p>MacArabic, MacFarsi</p></li><li><p>MacCentralEurope</p></li><li><p>MacChineseSimple</p></li><li><p>MacChineseTraditional</p></li><li><p>MacCroation</p></li><li><p>MacCyrillic</p></li><li><p>MacDevanagari</p></li><li><p>MacGreek</p></li><li><p>MacHebrew</p></li><li><p>MacIcelandic</p></li><li><p>MacKorean</p></li><li><p>MacJapanese</p></li><li><p>MacRoman</p></li><li><p>MacRomanian</p></li><li><p>MacThai</p></li><li><p>MacTurkish</p></li></ul></div><p>Starting with Mac OS X and AFP3, <a href="http://www.utf-8.com/" target="_top">UTF-8</a> is used. UTF-8 encodes
        Unicode characters in an ASCII compatible way, each Unicode character
        is encoded into 1-6 ASCII characters. UTF-8 is therefore not really a
        charset itself, it's an encoding of the Unicode charset.</p><p>To complicate things, Unicode defines several <span class="emphasis"><em><a href="http://www.unicode.org/reports/tr15/index.html" target="_top">normalization</a></em></span>
        forms. While <a href="http://www.samba.org" target="_top">samba</a><a class="indexterm" name="id2879823"></a> uses <span class="emphasis"><em>precomposed</em></span><a class="indexterm" name="id2879837"></a> Unicode, which most Unix tools prefer as well, Apple
        decided to use the <span class="emphasis"><em>decomposed</em></span><a class="indexterm" name="id2879858"></a> normalization.</p><p>For example lets take the German character
        '<span class="keycode">ä</span>'. Using the precomposed normalization, Unicode
        maps this character to 0xE4. In decomposed normalization, 'ä' is
        actually mapped to two characters, 0x61 and 0x308. 0x61 is the mapping
        for an 'a', 0x308 is the mapping for a <span class="emphasis"><em>COMBINING
        DIAERESIS</em></span>.</p><p>Netatalk refers to precomposed UTF-8 as
        <span class="emphasis"><em>UTF8</em></span><a class="indexterm" name="id2879908"></a> and to decomposed UTF-8 as
        <span class="emphasis"><em>UTF8-MAC</em></span><a class="indexterm" name="id2879928"></a>.</p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="id2879945"></a>afpd and character sets</h4></div></div><div></div></div><p>To support new AFP 3.x and older AFP 2.x clients at the same
        time, afpd needs to be able to convert between the various charsets
        used. AFP 3.x clients always use UTF-8, AFP 2.2 clients use one of the
        Apple codepages.</p><p>At the time of this writing, netatalk supports the following
        Apple codepages:</p><div class="itemizedlist"><ul type="disc"><li><p>MAC_CENTRALEUROPE</p></li><li><p>MAC_CYRILLIC</p></li><li><p>MAC_HEBREW</p></li><li><p>MAC_ROMAN</p></li><li><p>MAC_TURKISH</p></li></ul></div><p>afpd handles three different character set options:</p><div class="variablelist"><dl><dt><span class="term">unixcodepage<a class="indexterm" name="id2880031"></a></span></dt><dd><p>This is the codepage used internally by your operating
              system. If not specified and your system support Unix locales,
              afpd tries to detect the codepage, otherwise it defaults to
              ASCII<a class="indexterm" name="id2880057"></a>. afpd uses this codepage to read its
              configuration files, so you can use extended characters for
              volume names, login messages, etc. see <a href="afpd.conf.5.html"><span class="citerefentry"><span class="refentrytitle">afpd.conf</span>(5)</span></a>.</p></dd><dt><span class="term">maccodepage<a class="indexterm" name="id2880103"></a></span></dt><dd><p>As already mentioned, older MacOS clients (up to AFP 2.2)
              use codepages to communicate with afpd. However, there is no
              support for negotiating the codepage used by the client in the
              AFP protocol. If not specified otherwise, afpd assumes the
              <span class="emphasis"><em>MacRoman</em></span> codepage is used. In case you're
              clients use another codepage, e.g.
              <span class="emphasis"><em>MacCyrillic</em></span>, you'll <span class="bold"><b>have</b></span> to explicitly configure this. see
              <a href="afpd.conf.5.html"><span class="citerefentry"><span class="refentrytitle">afpd.conf</span>(5)</span></a>.</p></dd><dt><span class="term">volcharset<a class="indexterm" name="id2880170"></a></span></dt><dd><p>This defines the charset afpd should use for filenames on
              disk. The default is UTF8. If you have <a href="http://www.gnu.org/software/libiconv/" target="_top">iconv</a><a class="indexterm" name="id2880201"></a> installed, you can use any iconv provided charset
              as well.</p><p>afpd needs a way to preserve extended macintosh
              characters, or characters illegal in unix filenames, when saving
              files on a unix filesystem. Earlier versions used the the so
              called CAP encoding<a class="indexterm" name="id2880226"></a>. An extended character (&gt;0x7F) would be
              converted to a :xx hex sequence, e.g. the Apple Logo (MacRoman:
              0XF0) was saved as :f0. Some special characters will be
              converted as to :xx notation as well. '/' will be encoded to
              :2f, if -usedots is not specified, a leading dot '.' will be
              encoded as :2e. Even though this version now uses UTF-8 as the
              default encoding for filenames, special characters, like '/' and
              a leading '.' will still be CAP style encoded. For western users
              another useful setting could be <span class="emphasis"><em>-volcharset
              ISO-8859-15</em></span>.</p><p>If a character cannot be converted from the mac codepage
              to the selected volcharset, afpd will save it as a CAP encoded
              character. For AFP3 clients, afpd will convert the UTF-8
              character to <span class="emphasis"><em>maccodepage</em></span> first. If this
              conversion fails, you'll receive a -50 error on the mac.
              <span class="emphasis"><em>Note</em></span>: Whenever you can, please stick with
              the default UTF-8 volume format. see <a href="AppleVolumes.default.5.html"><span class="citerefentry"><span class="refentrytitle">AppleVolumes.default</span>(5)</span></a>.</p></dd></dl></div></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="authentication"></a>Authentication<a class="indexterm" name="id2880323"></a></h3></div></div><div></div></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="id2880338"></a>AFP authentication basics</h4></div></div><div></div></div><p>Apple chose a flexible model called "User Authentication
        Modules"<a class="indexterm" name="id2880351"></a> (UAMs) for authentication purposes between AFP client
        and server. An AFP client initially connecting to an AFP server will
        ask for the list of UAMs which the server provides, and will choose
        the one with strongest encryption that the client supports.</p><p>Several UAMs have been developed by Apple over the time, some by
        3rd-party developers.</p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="id2880379"></a>UAMs supported by Netatalk</h4></div></div><div></div></div><p>Netatalk supports the following ones by default:</p><div class="itemizedlist"><ul type="disc"><li><p>"No User Authent"<a class="indexterm" name="id2880402"></a> UAM (guest access without authentication)</p></li><li><p>"Cleartxt Passwrd"<a class="indexterm" name="id2880428"></a> UAM (no password encryption)</p></li><li><p>"Randnum exchange"<a class="indexterm" name="id2880453"></a>/"2-Way Randnum exchange"<a class="indexterm" name="id2880470"></a> UAMs (weak password encryption, separate password
            storage)</p></li><li><p>"DHCAST128"<a class="indexterm" name="id2880496"></a> UAM (stronger password encryption, should be used
            these days)</p></li></ul></div><p>There exist other optional UAMs as well:</p><div class="itemizedlist"><ul type="disc"><li><p>"PGPuam 1.0"<a class="indexterm" name="id2880531"></a><a class="indexterm" name="id2880546"></a> UAM (PGP-based authentication for pre-Mac OS X
            clients. You'll also need the <a href="http://www.vmeng.com/vinnie/papers/pgpuam.html" target="_top">PGPuam
            client</a> to let this work)</p><p>You'll have to add <tt class="filename">"--enable-pgp-uam"</tt>
            to your configure switches to have this UAM available.</p></li><li><p>"Kerberos IV"<a class="indexterm" name="id2880592"></a><a class="indexterm" name="id2880607"></a>/"AFS Kerberos"<a class="indexterm" name="id2880623"></a> UAMs (suitable to use <a href="http://web.mit.edu/macdev/KfM/Common/Documentation/faq.html" target="_top">Kerberos
            v4 based authentication</a> and AFS file servers)</p><p>Use <tt class="filename">"--enable-krb4-uam"</tt> at compile time
            to activate the build of this UAM.</p></li><li><p>"Client Krb v2"<a class="indexterm" name="id2880669"></a> UAM (Kerberos V, suitable for "Single Sign On"
            Scenarios with Mac OS X clients -- see below)</p><p><tt class="filename">"--enable-krbV-uam"</tt> will provide you
            with the ability to use this UAM.</p></li></ul></div><p>You can configure which UAMs should be activated by defining
        <tt class="filename">$AFPD_UAM_LIST</tt> in <a href="netatalk.conf.5.html"><span class="citerefentry"><span class="refentrytitle">netatalk.conf</span>(5)</span></a>. <span><b class="command">afpd</b></span> will log which UAMs it's
        using and if problems occur while activating them in either
        <tt class="filename">netatalk.log</tt> or syslog at startup time.
        <a href="asip-status.pl.1.html"><span class="citerefentry"><span class="refentrytitle">asip-status.pl</span>(1)</span></a> can be used to query the available UAMs of AFP
        servers as well.</p><p>Having a specific UAM available at the server does not
        automatically mean that a client can use it. Client-side support is
        also necessary. Fortunately this isn't such a problem these days since
        Mac OS X' AFP-client supports DHCAST128 from the beginning on. For
        older Macintoshes running Mac OS &lt; X DHCAST128 support exists since
        AppleShare client 3.8.x.</p><p>On Mac OS X, there exist some client-side techniques to make the
        AFP-client more verbose, so one can have a look what's happening while
        negotiating the UAMs to use. Compare with this <a href="http://article.gmane.org/gmane.network.netatalk.devel/7383/" target="_top">hint</a>.</p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="id2880792"></a>Which UAMs to activate?</h4></div></div><div></div></div><p>It depends primarily on your needs and on the kind of Mac OS
        versions you have to support. Basically one should try to use
        DHCAST128 where possible because of its strength of password
        encryption.</p><div class="itemizedlist"><ul type="disc"><li><p>Unless you really have to supply guest access to your
            server's volumes ensure that you disable "No User Authent" since
            it might lead accidentally to unauthorized access. In case you
            must enable guest access take care that you enforce this on a per
            volume base using the access controls the <a href="AppleVolumes.default.5.html"><span class="citerefentry"><span class="refentrytitle">AppleVolumes.default</span>(5)</span></a> config file supplies or think about setting up
            an own server definition serving these public shares in
            <a href="afpd.conf.5.html"><span class="citerefentry"><span class="refentrytitle">afpd.conf</span>(5)</span></a>.</p></li><li><p>The "ClearTxt Passwrd" UAM is as bad as it sounds since
            passwords go unencrypted over the wire. Try to avoid it at both
            the server's side as well as on the client's. Note: If you want to
            provide Mac OS 8/9 clients with NetBoot-services then you need
            uams_cleartext.so since the AFP-client integrated into the Mac's
            firmware can only deal with this basic form of
            authentication.</p></li><li><p>Since "Randnum exchange"/"2-Way Randnum exchange" uses only
            56 bit DES for encryption it should be avoided as well. Another
            disadvantage is the fact that the passwords have to be stored in
            cleartext on the server and that it doesn't integrate into both
            PAM scenarios or classic /etc/shadow (you have to administrate
            passwords separately by using the <a href="afppasswd.1.html"><span class="citerefentry"><span class="refentrytitle">afppasswd</span>(1)</span></a> utility, if clients should use these
            UAMs)</p></li><li><p>"DHCAST128" should be a good compromise for most people
            since it combines stronger encryption with PAM integration.
            Hopefully Netatalk will support its successor "DHX2" (Diffie
            Hellman Exchange 2) in the future, which provides even stronger
            encryption.</p></li><li><p>Using the Kerberos V<a class="indexterm" name="id2880922"></a> ("Client Krb v2") UAM, it's possible to implement
            real single sign on scenarios using Kerberos tickets. The password
            is not sent over the network. Instead, the user password is used
            to decrypt a service ticket for the appleshare server. The service
            ticket contains an encryption key for the client and some
            encrypted data (which only the appleshare server can decrypt). The
            encrypted portion of the service ticket is sent to the server and
            used to authenticate the user. Because of the way that the afpd
            service principal detection is implemented, this authentication
            method is vulnerable to man-in-the-middle attacks.</p></li></ul></div><p>For a more detailed overview over the technical implications of
        the different UAMs, please have a look at Apple's <a href="http://developer.apple.com/documentation/Networking/Conceptual/AFP/Chapter_1/chapter_2_section_6.html" target="_top">File
        Server Security</a> pages.</p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="id2880972"></a>Using different authentication sources with specific
        UAMs</h4></div></div><div></div></div><p>Some UAMs provide the ability to use different authentication
        "backends", namely <tt class="filename">uams_cleartext.so</tt> and
        <tt class="filename">uams_dhx.so</tt>. They can both use either classic
        Unix passwords from <tt class="filename">/etc/passwd</tt>
        (<tt class="filename">/etc/shadow</tt>) or PAM if the system supports that.
        <tt class="filename">uams_cleartext.so</tt> can be symlinked to either
        <tt class="filename">uams_passwd.so</tt> or
        <tt class="filename">uams_pam.so</tt>, <tt class="filename">uams_dhx.so</tt> to
        <tt class="filename">uams_dhx_passwd.so</tt> or
        <tt class="filename">uams_dhx_pam.so</tt>. So, if it looks like this in
        Netatalk's UAMs folder (per default
        <tt class="filename">/etc/netatalk/uams/</tt>):</p><pre class="programlisting">uams_clrtxt.so -&gt; uams_pam.so
uams_dhx.so -&gt; uams_dhx_pam.so</pre><p> then you're using PAM,
        otherwise classic Unix passwords. The main advantage of using PAM is
        that one can integrate Netatalk in centralized authentication
        scenarios, eg. via LDAP, NIS and the like. Please always keep in mind
        that the protection of your user's login credentials in such scenarios
        also depends on the strength of encryption that the UAM in question
        supplies. So think about eliminating weak UAMs like "ClearTxt Passwrd"
        and "Randnum exchange" completely from your network.</p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="id2881086"></a>Netatalk UAM overview table</h4></div></div><div></div></div><p>A small overview of the most common used UAMs.</p><div class="table"><a name="id2881099"></a><p class="title"><b>Table 3.1. Netatalk UAM overview</b></p><table summary="Netatalk UAM overview" border="1"><colgroup><col align="center"><col align="center"><col align="center"><col align="center"><col align="center"><col align="center"></colgroup><tbody><tr><td align="center" valign="middle">UAM</td><td align="center">No User Authent<a class="indexterm" name="id2881205"></a></td><td align="center">Cleartxt Passwrd<a class="indexterm" name="id2881225"></a></td><td align="center">(2-Way) Randnum exchange<a class="indexterm" name="id2881244"></a></td><td align="center">DHCAST128<a class="indexterm" name="id2881264"></a></td><td align="center">Client Krb v2<a class="indexterm" name="id2881283"></a></td></tr><tr><td align="center" valign="middle">pssword
                length</td><td align="center">guest access</td><td align="center">max. 8 characters</td><td align="center">max. 8 characters</td><td align="center">max. 64 characters</td><td align="center">Kerberos tickets</td></tr><tr><td align="center" valign="middle">Client
                support</td><td align="center">built-in into all Mac OS versions</td><td align="center">built-in in all Mac OS versions except 10.0. Has to be
                activated explicitly in recent Mac OS X versions</td><td align="center">built-in into almost all Mac OS versions</td><td align="center">built-in since AppleShare client 3.8.4, available as a
                plug-in for 3.8.3, integrated in Mac OS X' AFP client</td><td align="center">built-in since MacOS X 10.2</td></tr><tr><td align="center" valign="middle">Encryption</td><td align="center">Enables guest access without authentication between
                client and server.</td><td align="center">Password will be sent in cleartext over the wire. Just
                as bad as it sounds, therefore avoid at all if possible (note:
                providing NetBoot services requires the ClearTxt UAM)</td><td align="center">8-byte random numbers are sent over the wire,
                comparable with DES, 56 bits. Vulnerable to offline dictionary
                attack. Requires passwords in clear on the server.</td><td align="center">Password will be encrypted with 128 bit SSL, user will
                be authenticated against the server but not vice versa.
                Therefor weak against man-in-the-middle attacks.</td><td align="center">Password is not sent over the network. Due to the
                service principal detection method, this authentication method
                is vulnerable to man-in-the-middle attacks.</td></tr><tr><td align="center" valign="middle">Server
                support</td><td align="center" valign="middle">uams_guest.so</td><td align="center" valign="middle">uams_cleartxt.so</td><td align="center" valign="middle">uams_randnum.so</td><td align="center" valign="middle">uams_dhx.so</td><td align="center" valign="middle">uams_gss.so</td></tr><tr><td align="center" valign="middle">Password
                storage method</td><td align="center" valign="middle">None</td><td align="center" valign="middle">Either /etc/passwd
                (/etc/shadow) or PAM</td><td align="center" valign="middle">Passwords stored in
                clear text in a separate text file</td><td align="center" valign="middle">Either /etc/passwd
                (/etc/shadow) or PAM</td><td align="center" valign="middle">At the Kerberos Key
                Distribution Center*</td></tr></tbody></table></div><p>* Have a look at this <a href="http://cryptnet.net/fdp/admin/kerby-infra/en/kerby-infra.html" target="_top">Kerberos
        overview</a></p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="sshtunnel"></a>SSH tunneling</h4></div></div><div></div></div><p>Tunneling and all sort of VPN stuff has nothing to do with AFP
        authentication and UAMs in general. But since Apple introduced an
        option called "Allow Secure Connections Using SSH" and many people
        tend to confuse both things, we'll speak about that here too.</p><div class="sect4" lang="en"><div class="titlepage"><div><div><h5 class="title"><a name="manualsshtunnel"></a>Manually tunneling an AFP session</h5></div></div><div></div></div><p>This works since the first AFP servers that spoke "AFP over
          TCP" appeared in networks. One simply tunnels the remote server's
          AFP port to a local port different than 548 and connects locally to
          this port afterwards. On MacOS X this can be done by</p><pre class="programlisting">ssh -l $USER $SERVER -L 10548:127.0.0.1:548 sleep 3000</pre><p>After establishing the tunnel one will use
          <tt class="filename">"afp://127.0.0.1:10548"</tt> in the "Connect to
          server" dialog. All AFP traffic including the initial connection
          attempts will be sent encrypted over the wire since the local AFP
          client will connect to the Mac's local port 10548 which will be
          forwarded to the remote server's AFP port (we used the default 548)
          over SSH.</p><p>These sorts of tunnels are an ideal solution if you've to
          access an AFP server providing weak authentications mechanisms
          through the Internet without having the ability to use a "real" VPN.
          Note that you can let <span><b class="command">ssh</b></span> compress the data by
          using its "-C" switch and that the tunnel endpoints can be different
          from both AFP client and server (compare with the SSH documentation
          for details).</p></div><div class="sect4" lang="en"><div class="titlepage"><div><div><h5 class="title"><a name="autosshtunnel"></a>Automatically establishing a tunneled AFP connection</h5></div></div><div></div></div><p>Starting with Mac OS X 10.2 Apple added an "Allow Secure
          Connections Using SSH" checkbox to the "Connect to Server" dialog.
          The idea behind: When the server signals that it can be contacted by
          SSH then Mac OS X' AFP client tries to establish the tunnel and
          automagically sends all AFP traffic through it.</p><p>But it took until the release of Mac OS X 10.3 that this
          feature worked the first time... partly. In case, the SSH tunnel
          can't be established the AFP client <span class="strong">silently</span> fell back to an unencrypted AFP
          connection attempt.</p><p>Netatalk's afpd will report that it is capable of handling SSH
          tunneled AFP requests, when both <tt class="filename">-advertise_ssh</tt>
          and <tt class="filename">-fqdn</tt> options are set in <a href="afpd.conf.5.html"><span class="citerefentry"><span class="refentrytitle">afpd.conf</span>(5)</span></a> (double check with <a href="asip-status.pl.1.html"><span class="citerefentry"><span class="refentrytitle">asip-status.pl</span>(1)</span></a> after you restarted afpd when you made changes to
          the settings). But there are a couple of reasons why you don't want
          to use this option at all:</p><div class="itemizedlist"><ul type="disc"><li><p>Tunneling TCP over TCP (as SSH does) is not the best idea.
              There exist better solutions like VPNs based on the IP
              layer.</p></li><li><p>Since this SSH kludge isn't a normal UAM that integrates
              directly into the AFP authentication mechanisms but instead uses
              a single flag signalling clients whether they can <span class="strong">try</span> to establish a tunnel or not, it
              makes life harder to see what's happening when things go
              wrong.</p></li><li><p>You cannot control which machines are logged on by
              Netatalk tools like <span><b class="command">nu</b></span> or
              <span><b class="command">macusers</b></span> since all connection attempts seem
              to be made from localhost.</p></li><li><p>On the other side you've to limit access to afpd to
              localhost only (TCP wrappers) and disable AFP over DDP when you
              want to ensure that all AFP sessions are SSH encrypted
              or...</p></li><li><p>...when you're using 10.2 - 10.3.3 then you get the
              opposite of what you'd expect: potentially unencrypted AFP
              communication (including logon credentials) on the network
              without a single notification that establishing the tunnel
              failed. Apple fixed that not until Mac OS X 10.3.4.</p></li><li><p>Encrypting all AFP sessions via SSH can lead to a
              significantly higher load on the Netatalk server</p></li></ul></div></div></div></div></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="printing"></a>Printing<a class="indexterm" name="id2881882"></a></h2></div></div><div></div></div><p>Netatalk can act as both a PAP<a class="indexterm" name="id2881896"></a> client to access AppleTalk-capable printers and a PAP
    server. The former by using the <a href="pap.1.html"><span class="citerefentry"><span class="refentrytitle"><span><b class="command">pap</b></span></span>(1)</span></a> utility and the latter by starting the <a href="papd.8.html"><span class="citerefentry"><span class="refentrytitle"><span><b class="command">papd</b></span></span>(8)</span></a> service.</p><p>The "Printer Access Protocol" as part of the AppleTalk protocol
    suite is a fully 8 bit aware and bidirectional printing protocol,
    developed by Apple in 1985. <span class="emphasis"><em>8 bit aware</em></span> means that
    the whole set of bytes can be used for printing (binary encoding). This
    has been a great advantage compared with other protocols like Adobe's
    Standard Protocol to drive serial and parallel PostScript printers
    (compare with <a href="http://partners.adobe.com/asn/tech/ps/specifications.jsp" target="_top">Adobe
    TechNote 5009</a>) or LPR<a class="indexterm" name="id2881973"></a> which made only use of the lower 128 bytes for printing
    because the 8th bit has been reserved for control codes.</p><p><span class="emphasis"><em>Bidirectional</em></span> means that printing source
    (usually a Macintosh computer) and destination (a printer or spooler
    implementation) communicate about both destination's capabilities via
    feature queries (compare with <a href="http://partners.adobe.com/asn/tech/ps/archive.jsp" target="_top">Adobe TechNote
    5133</a>) and device status. This allows the LaserWriter driver on the
    Macintosh to generate appropriate device specific PostScript code (color
    or b/w, only embedding needed fonts, and so on) on the one hand and
    notifications about the printing process or problems (paper jam for
    example) on the other.</p><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="papserver"></a>Setting up the PAP print server</h3></div></div><div></div></div><p>Netatalk's <span><b class="command">papd</b></span> is able to provide AppleTalk
      printing services for Macintoshes or, to be more precise, PAP clients in
      general. Netatalk does not contain a full-blown spooler implementation
      itself, papd only handles the bidirectional communication and
      submittance of printjobs from PAP clients. So normally one needs to
      integrate papd with a Unix printing system like eg. classic SysV
      lpd<a class="indexterm" name="id2882044"></a>, BSD lpr<a class="indexterm" name="id2882060"></a>, LPRng<a class="indexterm" name="id2882075"></a>, CUPS<a class="indexterm" name="id2882091"></a> or the like.</p><p>Since it is so important to answer the client's feature queries
      correctly, how does papd achieve this? By parsing the relevant keywords
      of the assigned PPD<a class="indexterm" name="id2882114"></a> file. That said, it's always necessary to carefully
      choose the right PPD at the server's side.</p><p>Netatalk formerly had built-in support for System V lpd printing
      in a way that papd saved the printed job directly into the spooldir and
      calls <span><b class="command">lpd</b></span> afterwards, to pick up the file and do the
      rest. Due to incompatibilities with many lpd implementations the normal
      behaviour was to print directly into a pipe instead of specifying a
      printer by name and using lpd interaction. With Netatalk 2.0 another
      alternative has been implemented: direct interaction with CUPS (Note:
      when CUPS support is compiled in, then the SysV lpd support doesn't work
      at all). Detailed examples can be found in the <a href="papd.conf.5.html"><span class="citerefentry"><span class="refentrytitle">papd.conf</span>(5)</span></a> manual page.</p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="paplpdsupport"></a>Integrating <span><b class="command">papd</b></span> with SysV lpd</h4></div></div><div></div></div><p>Unless CUPS support has been compiled in (which is default from
        Netatalk 2.0 on) one simply defines the lpd queue in question by
        setting the <tt class="option">pr</tt> parameter to the queue name. If no
        <tt class="option">pr</tt> parameter is set, the default printer will be
        used.</p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="pappipesupport"></a>Using pipes with <span><b class="command">papd</b></span></h4></div></div><div></div></div><p>An alternative to the technique outlined above is to direct
        papd's output via a pipe into another program. Using this mechanism
        almost all printing systems can be driven. Netatalk supplies three
        "wildcards" that get substituted with values of the already printed
        job:</p><div class="variablelist"><dl><dt><span class="term">%F</span></dt><dd><p>will be substituted with the contents of the
              <span class="emphasis"><em>%%For:</em></span> comment in the PostScript
              stream.</p></dd><dt><span class="term">%U</span></dt><dd><p>If authenticated printing<a class="indexterm" name="id2882273"></a> has been enabled then this will be substituted
              with the user name of the printjob's originator.</p></dd><dt><span class="term">%J</span></dt><dd><p>will be substituted with the contents of the
              <span class="emphasis"><em>%%Title:</em></span> comment of the PostScript
              stream.</p></dd></dl></div><p>Using these wildcards, one can pass those parameters directly to
        programs or implement small wrapper scripts to call the printing
        system in question.</p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="papcupssupport"></a>Using direct CUPS support</h4></div></div><div></div></div><p>Starting with Netatalk 2.0, direct CUPS integration is
        available. In this case, defining only a queue name as
        <tt class="option">pr</tt> parameter won't invoke the SysV lpd daemon but
        uses CUPS instead. Unless a specific PPD has been assigned using the
        <tt class="option">pd</tt> switch, the PPD configured in CUPS will be used by
        <span><b class="command">papd</b></span>, too.</p><p>There exists one special share named "cupsautoadd". If this is
        present in papd.conf, then all available CUPS queues will be served
        automagically using the parameters assigned to this global share. But
        subsequent printer definitions can be used to override these global
        settings for individual spoolers.</p></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="papclient"></a>Using AppleTalk printers</h3></div></div><div></div></div><p>Netatalk's <a href="papstatus.8.html"><span class="citerefentry"><span class="refentrytitle"><span><b class="command">papstatus</b></span></span>(8)</span></a> can be used to query AppleTalk printers, <a href="pap.1.html"><span class="citerefentry"><span class="refentrytitle"><span><b class="command">pap</b></span></span>(1)</span></a> to print to them. With <a href="psf.8.html"><span class="citerefentry"><span class="refentrytitle"><span><b class="command">psf</b></span></span>(8)</span></a> there exists a lpd filter program suitable for
      converting other formats (like text) to PostScript output, do page
      accounting<a class="indexterm" name="id2882441"></a> and eventually change the page order using <a href="psorder.1.html"><span class="citerefentry"><span class="refentrytitle"><span><b class="command">psorder</b></span></span>(1)</span></a>. But these days, modern printing systems like CUPS can
      do the latter tasks for themselves in a more reliable way.</p><p><span><b class="command">pap</b></span> can be used stand-alone or as part of an
      output filter or a CUPS backend<a class="indexterm" name="id2882483"></a> (which is the preferred method since one does not have to
      deal with all the options).</p><div class="example"><a name="id2882500"></a><p class="title"><b>Example 3.10. <span>pap</span> printing to a PostScript
        LaserWriter</b></p><pre class="programlisting">pap -p"ColorLaserWriter 16/600@*" /usr/share/doc/gs/examples/tiger.ps</pre><p>
        The file <tt class="filename">/usr/share/doc/gs/examples/tiger.ps</tt> is
        sent to a printer called "ColorLaserWriter 16/600" in the standard
        zone "*". The device type is "LaserWriter" (can be suppressed since it
        is the default).</p></div><div class="example"><a name="id2882538"></a><p class="title"><b>Example 3.11. <span>pap</span> printing to a non-PostScript
        printer</b></p><pre class="programlisting">gs -q -dNOPAUSE -sDEVICE=cdjcolor -sOutputFile=- test.ps | pap -E</pre><p>GhostScript
        is used to convert a PostScript job to PCL3 output suitable for a
        Color DeskWriter. Since no file has been supplied on the command line,
        <span><b class="command">pap</b></span> reads the data from stdin. The printer's
        address will be read from the <tt class="filename">.paprc</tt> file in the
        same directory, <span><b class="command">pap</b></span> will be called (in our example
        simply containing "Color DeskWriter:DeskWriter@Printers"). The
        <tt class="option">-E</tt> switch forces <span><b class="command">pap</b></span> to not wait
        for an EOF from the printer.</p></div></div></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="timeservices"></a>Time Services<a class="indexterm" name="id2882615"></a><a class="indexterm" name="id2882625"></a></h2></div></div><div></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="timelord"></a>Using Netatalk as a time server for Macintoshes</h3></div></div><div></div></div><p><span><b class="command">timelord</b></span><a class="indexterm" name="id2882659"></a>, an AppleTalk based time server, is deprecated these
      days. Use NTP<a class="indexterm" name="id2882671"></a> instead.</p><p>For further information please have a look at the <a href="timelord.8.html"><span class="citerefentry"><span class="refentrytitle">timelord</span>(8)</span></a> manual page.</p></div></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="id2882707"></a>Starting and stopping Netatalk</h2></div></div><div></div></div><p>The Netatalk distribution comes with several operating system
    specific startup script templates that are tailored according to the
    options given to the "configure" script before compiling. Currently,
    templates are provided for NetBSD, BSD, RedHat, SuSE and True64. You can
    select to install the generated startup script(s)<a class="indexterm" name="id2882725"></a> by specifying a system type to "configure". To
    automatically install startup scripts for e.g. the SuSE Linux distribution
    try to give the <tt class="option">--enable-suse</tt> option to "configure". Some
    of the scripts can be further parametrized by the configuration file
    netatalk.conf (described in the <a href="netatalk.conf.5.html"><span class="citerefentry"><span class="refentrytitle">netatalk.conf</span>(5)</span></a> manual page), some obtain that information in another,
    operating system specific way (like Netbsd).</p><p>Since new releases of Linux distributions appear all the time and
    the startup procedure for the other systems mentioned above might change
    as well, it is probably a good idea to not blindly install a startup
    script but to look at it first to see if it will work on your system. If
    you use Netatalk as part of a fixed setup, like a Linux distribution, an
    RPM or a BSD package, things will probably have been arranged properly for
    you. The following therefore applies mostly for people who have compiled
    Netatalk themselves.</p><p>The following daemons need to be started by whatever startup script
    mechanism is used:</p><div class="itemizedlist"><ul type="disc"><li><p>atalkd<a class="indexterm" name="id2882796"></a> (if you use the AppleTalk protocol)</p></li><li><p>afpd<a class="indexterm" name="id2882816"></a></p></li><li><p>cnid_metad<a class="indexterm" name="id2882834"></a> (if the dbd CNID backend is used)</p></li><li><p>papd<a class="indexterm" name="id2882854"></a> (if you want to provide print services via
        AppleTalk)</p></li><li><p>timelord<a class="indexterm" name="id2882874"></a> (for old style time synchronisation via
        AppleTalk)</p></li></ul></div><p>Additionally, make sure that the various configuration files
    (<tt class="filename">afpd.conf</tt>,
    <tt class="filename">AppleVolumes.default</tt>, <tt class="filename">papd.conf</tt>
    etc.) are in the right place and that
    <tt class="filename">netatalk.conf</tt><a class="indexterm" name="id2882921"></a> (if used) contains the right entries. If you want e.g. papd
    to be started using this mechanism, set the environment variable
    "<tt class="option">PAPD_RUN</tt>"<a class="indexterm" name="id2882939"></a> to "yes" in netatalk.conf. See the manual pages for
    details.</p></div></div><div class="chapter" lang="en"><div class="titlepage"><div><div><h2 class="title"><a name="upgrade"></a>Chapter 4. Upgrading from a previous version of Netatalk</h2></div><div><div class="author"><h3 class="author"><span class="firstname">Jörg</span> <span class="surname">Lenneis</span></h3><span class="contrib">initial version</span></div></div><div><p class="pubdate">26 June, 2004</p></div></div><div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="sect1"><a href="#id2882998">Overview</a></span></dt><dt><span class="sect1"><a href="#volumes-and-filenames">Volumes and filenames</a></span></dt><dd><dl><dt><span class="sect2"><a href="#volupgrade">How to upgrade a volume to 2.0</a></span></dt><dt><span class="sect2"><a href="#capvol">How to use a 1.x CAP encoded volume with 2.0</a></span></dt><dt><span class="sect2"><a href="#id2883427">How to use a 1.x NLS volume with 2.0</a></span></dt></dl></dd><dt><span class="sect1"><a href="#choosecnidscheme">Choosing a CNID storage scheme</a></span></dt><dd><dl><dt><span class="sect2"><a href="#id2883994">How to upgrade if no persistent CNID storage was used</a></span></dt><dt><span class="sect2"><a href="#id2884034">How to upgrade if a persistent CNID storage scheme was
      used</a></span></dt><dt><span class="sect2"><a href="#bruteforceupgrade">How to upgrade if a persistent CNID storage scheme was used, the
      brute force approach</a></span></dt></dl></dd><dt><span class="sect1"><a href="#testserver">Setting up a test server on the same machine</a></span></dt><dd><dl><dt><span class="sect2"><a href="#id2884534">Setting up an empty test share</a></span></dt><dt><span class="sect2"><a href="#id2884563">Duplicating an already existing share</a></span></dt><dt><span class="sect2"><a href="#id2884598">Configuring and running the test afpd</a></span></dt></dl></dd></dl></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="id2882998"></a>Overview</h2></div></div><div></div></div><p>Version 2.0 of the Netatalk suite includes significant changes and
    enhancements in functionality compared to previous versions. AFP 3.x is
    now supported which allows UTF-8 encoded filenames of up to 255 bytes
    (85-255 chars) in length amongst other things. The Catalogue Node ID
    (CNID) subsystem has been reworked as well and should now be much more
    robust. For an overview of what CNIDs are and why you need them please see
    the <a href="#CNID-backends" title="CNID backends">CNID</a> section in the
    manual.</p><p>The downside of these enhancements is that upgrading to Netatalk 2.0
    is not a process that can be easily automated. Too many factors depend on
    site specific configuration and administrators have to make choices that
    suit their requirements. This document attempts to clarify the issues and
    outline the steps that need to be taken for a successful upgrade. As
    usual, the first of these steps should be to make a complete backup of all
    volumes and home directories that were in use with Netatalk before.
    Afterwards, you'll have to decide</p><div class="orderedlist"><ol type="1"><li><p>what encoding to use for filenames in the future and how to
        convert existing filenames</p></li><li><p>what storage scheme to use for CNIDs and maybe convert an
        existing database to that scheme</p></li></ol></div><p>The following two sections deal with each of these areas in
    turn.</p></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="volumes-and-filenames"></a>Volumes and filenames</h2></div></div><div></div></div><p>Previous Netatalk versions saved filenames in the so called
    <span class="emphasis"><em>CAP<a class="indexterm" name="id2883099"></a></em></span> encoding by default. Alternatively, there was
    the NLS<a class="indexterm" name="id2883114"></a> system, that allowed you to convert filenames to other
    codepages, like ISO-8859-1.</p><p>For Netatalk 2.0 the charset conversion routines had to be
    completely rewritten to support AFP 3.x. For more indepth information on
    character sets please read the <a href="#charsets" title="Charsets/Unicode">Unicode/charsets</a> section in the manual.</p><p>As a consequence, Netatalk 2.0 now stores filenames in UTF-8 by
    default. Additionally you <span class="bold"><b>have</b></span> to specify
    a maccodepage in afpd.conf, if your Mac clients are not using
    <span class="emphasis"><em>MacRoman</em></span>.</p><p>The format of the metadata files stored in the .AppleDouble folders
    has changed from AppleDouble v1 to AppleDouble v2<a class="indexterm" name="id2883172"></a>. Netatalk 2.0 is still able to use AD1 files, if
    configured. Otherwise ADv1<a class="indexterm" name="id2883189"></a> files will silently be updated to the new ADv2 format,
    which will prevent you from using this volume with 1.x again.</p><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Warning</h3><p>Do not share a 1.x volume with Netatalk 2.0 without setting the
      proper options!</p></div><p></p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>You should consider 'upgrading' your volumes using the new
      defaults UTF-8 and AppleDouble v2, even if this is a time consuming
      process. AFP 3.x uses UTF-8 and it is impossible to fully map UTF-8 to
      any of the old volume formats.</p></div><p></p><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="volupgrade"></a>How to upgrade a volume to 2.0</h3></div></div><div></div></div><p>To convert the 1.x CAP or NLS encoded volumes on the server, we
      provide the <a href="uniconv.1.html"><span class="citerefentry"><span class="refentrytitle">uniconv</span>(1)</span></a> utility. Please see the man page for details.</p><p>Another option to perform an upgrade, is to copy all files using a
      Mac client. Either copy the volume to a Mac while you are still running
      1.6, then install 2.0 and copy the data back to a fresh share, or try to
      set up the volume with the compatibility options described below and do
      a share to share copy.</p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="capvol"></a>How to use a 1.x CAP encoded volume with 2.0</h3></div></div><div></div></div><p>Using a 1.x CAP encoded volume is still possible with Netatalk
      2.0. To work properly, the following options need to be set, matching
      your 1.x setup:</p><p>afpd.conf:</p><div class="itemizedlist"><ul type="disc"><li><p>maccodepage</p></li></ul></div><p>AppleVolumes.default:</p><div class="itemizedlist"><ul type="disc"><li><p>volcharset</p></li><li><p>adouble</p></li></ul></div><p>You have to make sure <tt class="option">maccodepage</tt> matches your
      Apple clients codepage. For western users the default
      <span class="emphasis"><em>Mac_Roman</em></span> should be fine.</p><p>Set <tt class="option">volcharset</tt> to
      <span class="emphasis"><em>ASCII</em></span>.</p><p>Set <tt class="option">adouble:v1</tt>, this will make sure the metadata
      files will not be changed to AppleDouble v2. If you do not set this
      option, it will not be possible to use the volume with Netatalk 1.x
      anymore.</p><p><span class="bold"><b>Example</b></span>:</p><p><tt class="filename">afpd.conf</tt>:</p><pre class="programlisting"> - -transall -maccodepage:MAC_CENTRALEUROPE</pre><p><tt class="filename">AppleVolumes.default</tt>:</p><pre class="programlisting"> /path/to/share "1.x Volume" adouble:v1 volcharset:ASCII</pre><p></p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="id2883427"></a>How to use a 1.x NLS volume with 2.0</h3></div></div><div></div></div><p>Whether you can still use an 1.x NLS encoded volume with Netatalk
      2.0 mainly depends on which NLS setting you used with 1.x.</p><p>Make sure you set the correct <tt class="option">maccodepage</tt> in
      <tt class="filename">afpd.conf</tt> !</p><div class="variablelist"><dl><dt><span class="term">maccode.iso8859-1</span></dt><dd><p>Use the following settings in
            <tt class="filename">AppleVolumes.default</tt>:</p><pre class="programlisting"> /path/to/share "1.x Volume" adouble:v1 volcharset:ISO-8859-1</pre></dd><dt><span class="term">maccode.iso8859-1.adapted</span></dt><dd><p>Sorry, you're out of luck. This NLS contains a non standard
            mapping and is not supported by afpd anymore. You'll have to <a href="#volupgrade" title="How to upgrade a volume to 2.0">convert</a> the volume to a supported
            encoding.</p></dd><dt><span class="term">maccode.437</span></dt><dd><p>Using the following settings in
            <tt class="filename">AppleVolumes.default</tt> might work, but is
            untested:</p><pre class="programlisting"> /path/to/share "1.x Volume" adouble:v1 volcharset:CP437</pre></dd><dt><span class="term">maccode.850</span></dt><dd><p>Using the following settings in
            <tt class="filename">AppleVolumes.default</tt> might work, but is
            untested:</p><pre class="programlisting"> /path/to/share "1.x Volume" adouble:v1 volcharset:CP850</pre></dd><dt><span class="term">maccode.koi8-r</span></dt><dd><p>Using the following settings in
            <tt class="filename">AppleVolumes.default</tt> might work, but is
            untested:</p><pre class="programlisting"> /path/to/share "1.x Volume" adouble:v1 volcharset:KOI8-R</pre></dd></dl></div><p></p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>All of the above require <a href="http://www.gnu.org/software/libiconv/" target="_top">iconv</a> to be
        installed and to supply the volcharset codepage!</p></div><p></p></div></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="choosecnidscheme"></a>Choosing a CNID<a class="indexterm" name="id2883660"></a> storage scheme</h2></div></div><div></div></div><p>Previous versions of Netatalk allocated CNIDs either on the fly or
    CNIDs were recorded in a persistent database. "On the fly methods" work by
    either generating a CNID from the device and inode number or simply by
    using a counter that is increased by one on each access to a file or
    directory from the client. The counter only lasts for the lifetime of an
    afpd daemon process and inode numbers are reused for a different file once
    the original file has been deleted. These methods therefore violate a
    fundamental assumption: A CNID once assigned must never be reused for the
    lifetime of a volume. Netatalk 2.0 supports one "On the fly scheme" called
    <span class="emphasis"><em>last</em></span>. It computes CNIDs for files from
    device and inode of the file and uses a counter for directories. You
    should think twice about using it in production. Depending on your needs
    and the semantics of the underlying file system it might be OK on read
    only volumes, but even there we are not certain if OS X clients will work
    properly.</p><p>That leaves the CNID schemes that use persistent storage for CNIDs.
    Netatalk 2.0 supports two: <span class="emphasis"><em>cdb</em></span> and
    <span class="emphasis"><em>dbd</em></span>. Both are based on the Berkeley DB
    database library as before. One difference is, though, that you are not
    restricted to using a single scheme for all of your volumes that has to be
    determined at compile time. The CNID scheme (also called a "CNID backend")
    is now a runtime option for a volume. That means that you can make the
    choice per volume based on your requirements. Here are the properties as
    well as the advantages and disadvantages of the three supported schemes:
    </p><div class="orderedlist"><ol type="1"><li><p><span class="bold"><b>last<a class="indexterm" name="id2883754"></a>:</b></span> See above. Avoid, if at all
          possible.</p></li><li><p><span class="bold"><b>cdb<a class="indexterm" name="id2883784"></a>: </b></span>Roughly analogous to the Netatalk 1.6.x
          versions with what was called then the "DID scheme" option set to
          "cnid" and the "CNID with Concurrent Data Store" option set to
          "yes". Access to the CNID database for a volume happens directly
          from the Netatalk afpd daemons. A Berkeley DB locking scheme (the
          "Concurrent Data Store" bit) is used to avoid database
          inconsistencies. Robustness is much improved compared to previous
          releases. The CNID database can only become corrupted if an afpd
          daemon crashes unexpectedly, is killed by the administrator or the
          whole machine crashes.</p></li><li><p><span class="bold"><b>dbd<a class="indexterm" name="id2883826"></a>:</b></span> There is only a single daemon that
          accesses the CNID database for a given volume. Any afpd process that
          wishes to retrieve or update CNIDs for that volume needs to do it
          via the daemon. The CNID can database be (this is a compile time
          option) updated under Berkeley DB transactional protection. This
          design combined with the transactional updates makes the CNID
          database crashproof: Any of the participating afpd daemons, the
          database daemon itself or the whole machine can crash and the CNID
          database should still be in a consistent state. The downside to this
          is that the speed of updates and retrieval is slower than with the
          <span class="emphasis"><em>cdb</em></span> scheme. If this is a problem, you
          might want to disable transactions at Netatalk compile time
          (currently, the default is to compile without transactions anyway).
          That will give you safety against afpd crashing, but not if the
          machine goes down unexpectedly. Also, have a look at the nosync
          option documented in the cnid_dbd manual page.</p></li></ol></div><p>It is also possible to switch between <span class="emphasis"><em>cdb</em></span> and <span class="emphasis"><em>dbd</em></span> for a
    given volume, since they use the same database format. You just have to
    shut down all processes accessing the database cleanly, make the necessary
    configuration changes and restart. Please note, that you can easily
    specify a default CNID backend for all shares by applying the
    <tt class="option">cnidscheme</tt><a class="indexterm" name="id2883900"></a> option to the "<tt class="option">:DEFAULT:</tt>" share (compare
    with the <a href="AppleVolumes.default.5.html"><span class="citerefentry"><span class="refentrytitle">AppleVolumes.default</span>(5)</span></a> manual page for details).</p><p>Note that the <span class="emphasis"><em>dbd</em></span> backend needs an
    auxiliary daemon, called <span><b class="command">cnid_metad</b></span><a class="indexterm" name="id2883951"></a>, to work. It should be started together with afpd. If the
    <span class="emphasis"><em>dbd</em></span> backend is compiled into afpd (the
    default), this should happen automatically. If you cannot find it in the
    process list even though the <span class="emphasis"><em>dbd</em></span> backend is
    used please check for errors in the startup scripts.</p><p>If you compile Netatalk 2.0 yourself and invoke configure --help,
    you'll notice that there are in fact more CNID backends to chose from.
    Don't use any of them. They are either broken or incomplete. Some of them
    might turn into something useful in the future.</p><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="id2883994"></a>How to upgrade if no persistent CNID storage was used</h3></div></div><div></div></div><p>That is easy. Just pick a CNID backend from above, configure it
      properly in afpd.conf and the AppleVolumes file and start up the
      necessary Netatalk processes. The databases will be automatically
      created in a subdirectory <tt class="filename">.AppleDB</tt><a class="indexterm" name="id2884016"></a> of the volume in question.</p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="id2884034"></a>How to upgrade if a persistent CNID storage scheme was
      used</h3></div></div><div></div></div><p>In that case the CNID databases need to be upgraded. A script
      called cnid2_create that comes with Netatalk 2.0 does most of the work.
      The steps you have to take depend on what version of Berkeley DB is
      installed on your system. If you already use one of the supported
      versions of Berkeley DB (4.1.25 or 4.2.52) for your old Netatalk
      installation and plan to use it for Netatalk 2.0 as well just use the
      <span><b class="command">db_dump</b></span> and <span><b class="command">db_load</b></span> utilities that
      came with it as indicated below. Otherwise it is probably best to have
      the old and the new (to be used with Netatalk 2.0) version of Berkeley
      DB installed side by side until you have finished the upgrade. The
      reason for this is that we will dump out the old databases with the
      currently installed version of Berkeley DB in ASCII format and reload
      them with the new version. This avoids any incompatibility problems
      between Berkeley DB releases with respect to the on-disk format.</p><p>For each volume to be upgraded, follow these steps </p><div class="itemizedlist"><ul type="disc"><li><p>Stop all afpd daemons accessing the volume.</p></li><li><p>Change to the database directory for that volume, most
            likely the <tt class="filename">.AppleDB</tt> subdirectory of the
            volume toplevel directory in question.</p></li><li><p>Dump the contents of <tt class="filename">cnid.db</tt> and
            <tt class="filename">didname.db</tt> using the old (installed) version
            of Berkeley DB like this:</p><pre class="programlisting"> db_dump -f cnid.dump cnid.db 
 db_dump -f didname.dump didname.db</pre><p>Make sure the db_dump utility you are using is the correct
            (currently used) one. Use the full path to the db_dump executable
            if in doubt. So if this database was created with Berkeley DB 3.xx
            installed in <tt class="filename">/usr/local/db3</tt> use
            <tt class="filename">/usr/local/db3/bin/db_dump</tt> instead. This will
            create two files, <tt class="filename">cnid.dump</tt> and
            <tt class="filename">didname.dump</tt> in the current directory.</p></li><li><p>Run the cnid2_create script:</p><pre class="programlisting"> /path/to/netatalk/bin/cnid2_create </pre><p>The script assumes that <tt class="filename">.AppleDB</tt> is a
            subdirectory of the volume directory to be upgraded. If that is
            not the case give the full path name of the volume as the first
            argument to <span><b class="command">cnid2_create</b></span>. The script will
            create a file <tt class="filename">cnid2.dump</tt> in ASCII
            format.</p></li><li><p>Remove the old Berkeley DB environment and logfiles (if
            present):</p><pre class="programlisting"> rm __db.* log.*</pre></li><li><p>Load <tt class="filename">cnid2.dump</tt> into the new database.
            You should use the <span><b class="command">db_load</b></span> utility of Berkeley
            DB that will be used with version 2.0 of Netatalk. So if Berkeley
            DB 4.xx lives in <tt class="filename">/usr/local/db4</tt> use</p><pre class="programlisting"> /usr/local/db4/bin/db_load -f cnid2.dump cnid2.db </pre><p>This will create the new database file,
            <tt class="filename">cnid2.db</tt>. Remove the old database files
            <tt class="filename">cnid.db</tt>, <tt class="filename">didname.db</tt> and
            <tt class="filename">devino.db</tt>. The intermediate files
            <tt class="filename">cnid.dump</tt>, <tt class="filename">didname.dump</tt>
            and <tt class="filename">cnid2.dump</tt> can be removed now or at some
            later time.</p></li></ul></div><p>If you do not want to have two versions of Berkeley DB installed
      side by side during the upgrade, you should first dump out the old
      databases as indicated above for all volumes, upgrade Berkeley DB and
      then load them with db_load. The <span><b class="command">cnid2_create</b></span> script
      can be run before or after the upgrade. Berkeley DB environment and
      logfiles should still be removed before running
      <span><b class="command">db_load</b></span>.</p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="bruteforceupgrade"></a>How to upgrade if a persistent CNID storage scheme was used, the
      brute force approach</h3></div></div><div></div></div><p>If you are absolutely sure what you are doing, you can also just
      clear out all database files from the <tt class="filename">.AppleDB</tt>
      directories. They will be recreated, but will <span class="emphasis"><em>not</em></span> contain the same CNIDs as before!! That might
      lead to all sorts of problems, like aliases not working any more on
      clients. As I said, make sure you know the consequences and don't mind
      them.</p></div></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="testserver"></a>Setting up a test server on the same machine</h2></div></div><div></div></div><p>Providing a test environment in parallel with the existing
    production installation is not difficult and, if done properly, it should
    not in any way disrupt the normal operation. However, as always, it is
    recommended to make a backup of the existing installation before
    proceeding. When compiling a newer netatalk version you should also take
    care that you do not overwrite the binaries of an older version (make use
    of the <tt class="option">--prefix=</tt> configure option).</p><p>There could be more than two afpd servers running on one UNIX box.
    You just have to be careful to keep them from running into each
    other:</p><div class="itemizedlist"><ul type="disc"><li><p>the shares/volumes
        (<tt class="filename">AppleVolumes.default</tt>)</p></li><li><p>the PID file (<span><b class="command">afpd</b></span> <tt class="option">-P</tt>
        command line option)</p></li><li><p>the port number (<tt class="option">-port</tt> option in
        <tt class="filename">afpd.conf</tt>)</p></li><li><p>no use of AppleTalk (<tt class="option">-noddp</tt> option in
        <tt class="filename">afpd.conf</tt>)</p></li></ul></div><p>You should test the new Netatalk version with both a freshly created
    new share and another one that has been duplicated/converted from an
    already existing volume. This helps finding mistakes you probably made in
    the upgrade process when the first share behaves well and the latter
    not.</p><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="id2884534"></a>Setting up an empty test share</h3></div></div><div></div></div><p>First, you have to provide some space for the test share. Just
      create a directory on one of your data filesystems. However, this
      directory must not be accessible from the production afpd server. Don't
      forget to set appropriate permissions for the share. For example:</p><pre class="programlisting"> mkdir /macdata/testshare
 chown root.macusers /macdata/testshare
 chmod g+wrx,g+s /macdata/testshare</pre></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="id2884563"></a>Duplicating an already existing share</h3></div></div><div></div></div><p>Ensure that users cannot access the share in question and copy the
      whole contents (including all the metadata directories like
      <tt class="filename">.AppleDB</tt>) to another location.</p><pre class="programlisting"> cp -pr /production/testshare /macdata/</pre><p>Then do the somewhat extensive upgrade of CNID databases and
      filename encodings outlined earlier in this chapter.</p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="id2884598"></a>Configuring and running the test afpd</h3></div></div><div></div></div><p>Normally the test afpd cannot listen on the standard afpovertcp
      port, because that one is already bound by the production afpd. So the
      <tt class="filename">afpd.conf</tt> should look like</p><pre class="programlisting"> - -noddp -nouservol -port 5480 -loginmsg "WARNING: test server"</pre><p>You also have to present the share to the Mac users by editing the
      <tt class="filename">AppleVolumes.default</tt> file. Remove the line
      containing a single "~" at the end of the file and append something
      like:</p><pre class="programlisting"> /macdata/testshare "Test Volume (not production)"</pre><p>That should be the only uncommented line in the file. Do not
      forget to adjust encoding and AppleDouble setting when you're not using
      the recommended defaults UTF8 and ADv2.</p><p>In case you have many users and want to restrict access to the
      test server, there is a provision for that in the
      <tt class="filename">AppleVolumes.default</tt> file. First, create a group
      named, say, <tt class="option">afpdtest</tt>, and put in it all users you would
      want to enable access to the test volumes. Then, instead of the line
      above, append a line like this one:</p><pre class="programlisting"> /macdata/testshare "Test Volume (not production)" allow:@afpdtest</pre><p>The test afpd server can be started now:</p><pre class="programlisting"> $TESTDIR/sbin/afpd -P /var/run/afpd-test.pid</pre><p>You can also put this line in the production netatalk start
      script, in the "start" case. In the "stop" case, you should
      insert</p><pre class="programlisting"> [ -f /var/run/afpd-test.pid ] &amp;&amp; kill `cat /var/run/afpd-test.pid`</pre><p>The production server has to know about the test server. Otherwise
      the Mac users would not be able to see the test server in their
      choosers. Append the following line to the production
      <tt class="filename">afpd.conf</tt> (usually in
      <tt class="filename">/etc/netatalk/afpd.conf</tt>):</p><pre class="programlisting"> "Test server (not production)" -proxy -uamlist "" -port 5480</pre><p>and restart the production netatalk. Note that the port directive
      here should match the one which appears above in the test
      <tt class="filename">afpd.conf</tt>.</p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>Note that there is a limit of 31 characters for the server's
        name. Should the name be longer, then afpd will just refuse to register
        the server.</p></div><p>The test server should appear in the chooser on Macs. You can also
      test that from the UNIX command line:</p><pre class="programlisting"> nbplkup =:AFPServer</pre><p>or</p><pre class="programlisting"> netstat -an | grep 5480</pre><p>If everything went fine spread the word about the test server
      among your more experienced Mac users and see whether things work as
      expected.</p></div></div></div><div class="chapter" lang="en"><div class="titlepage"><div><div><h2 class="title"><a name="man-pages"></a>Chapter 5. Manual Pages</h2></div></div><div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><a href="#achfile.1">achfile</a> - change type and/or creator of Apple Macintosh files (netatalk
    format)</dt><dt><a href="#acleandir.1">acleandir</a> - clean up a directory containing netatalk Apple Macintosh files</dt><dt><a href="#aecho.1">aecho</a> - send AppleTalk Echo Protocol packets to network hosts</dt><dt><a href="#afile.1">afile</a> - display type and creator of Apple Macintosh files (netatalk
    format)</dt><dt><a href="#afpd.8">afpd</a> - AppleTalk Filing Protocol daemon</dt><dt><a href="#afpd.conf.5">afpd.conf</a> - Configuration file used by afpd(8) to determine the setup of
    its file sharing services<a class="indexterm" name="id2887241"></a></dt><dt><a href="#afppasswd.1">afppasswd</a> - netatalk password maintenance utility</dt><dt><a href="#AppleVolumes.default.5">AppleVolumes.default</a> - Configuration file used by <span><b class="command">afpd</b></span>(8) to
    determine the shares made available through Appletalk<a class="indexterm" name="id2889481"></a><a class="indexterm" name="id2889491"></a></dt><dt><a href="#apple_cp.1">apple_cp</a> - Do an apple copy, copying file metadata and the resource fork as well</dt><dt><a href="#apple_mv.1">apple_mv</a> - Do an apple move, moving metadata and the resource fork as well</dt><dt><a href="#apple_rm.1">apple_rm</a> - Do an apple remove, remove metadata and resource fork as
    well</dt><dt><a href="#asip-status.pl.1">asip-status.pl</a> - Queries AFP servers for their capabilities</dt><dt><a href="#atalk.4">atalk</a> - AppleTalk protocol family<a class="indexterm" name="id2892164"></a></dt><dt><a href="#atalkd.8">atalkd</a> - AppleTalk RTMP, NBP, ZIP, and AEP manager</dt><dt><a href="#atalkd.conf.5">atalkd.conf</a> - Configuration file used by atalkd(8) to determine the
    interfaces used by the master Netatalk daemon<a class="indexterm" name="id2892955"></a><a class="indexterm" name="id2892962"></a><a class="indexterm" name="id2892976"></a></dt><dt><a href="#atalk_aton.3">atalk_aton</a> - AppleTalk address parsing<a class="indexterm" name="id2893363"></a></dt><dt><a href="#cnid_dbd.8">cnid_dbd</a> - implement access to CNID databases through a dedicated daemon
    process</dt><dt><a href="#cnid_index.1">cnid_index</a> - check and repair Netatalk CNID database indexes</dt><dt><a href="#cnid_metad.8">cnid_metad</a> - start cnid_dbd daemons on request</dt><dt><a href="#getzones.1">getzones</a> - list AppleTalk zone names</dt><dt><a href="#megatron.1">megatron</a> - Macintosh file format transformer</dt><dt><a href="#nbp.1">nbp</a> - access NBP database</dt><dt><a href="#nbp_name.3">nbp_name</a> - NBP name parsing<a class="indexterm" name="id2896634"></a></dt><dt><a href="#netatalk.conf.5">netatalk.conf</a> - Configuration file used by netatalk(8) to determine its
    general configuration<a class="indexterm" name="id2897067"></a><a class="indexterm" name="id2897074"></a>
<a class="indexterm" name="id2897082"></a>
<a class="indexterm" name="id2897091"></a>
<a class="indexterm" name="id2897099"></a>
<a class="indexterm" name="id2897107"></a>
<a class="indexterm" name="id2897116"></a>
<a class="indexterm" name="id2897124"></a>
<a class="indexterm" name="id2897133"></a>
<a class="indexterm" name="id2897141"></a>
<a class="indexterm" name="id2897149"></a>
<a class="indexterm" name="id2897158"></a>
<a class="indexterm" name="id2897166"></a><a class="indexterm" name="id2897173"></a></dt><dt><a href="#netatalkconfig.1">netatalk-config</a> - script to get information about the installed version of
    netatalk</dt><dt><a href="#pap.1">pap</a> - client interface to remote printers using Printer Access
    Protocol</dt><dt><a href="#papd.8">papd</a> - AppleTalk print server daemon</dt><dt><a href="#papd.conf.5">papd.conf</a> - Configuration file used by papd(8) to determine the
    configuration of printers used by the Netatalk printing daemon<a class="indexterm" name="id2899970"></a></dt><dt><a href="#papstatus.8">papstatus</a> - get the status of an AppleTalk-connected printer</dt><dt><a href="#psf.8">psf</a> - PostScript filter</dt><dt><a href="#psorder.1">psorder</a> - PostScript pageorder filter</dt><dt><a href="#timelord.8">timelord</a> - Macintosh time server daemon</dt><dt><a href="#timeout.1">timeout</a> - Send a signal to a program after a certain time<a class="indexterm" name="id2902235"></a></dt><dt><a href="#uniconv.1">uniconv</a> - convert Netatalk volume encoding</dt></dl></div><p>This is a collection of the man pages delivered with Netatalk.</p><div class="refentry" lang="en"><a name="achfile.1"></a><div class="titlepage"><div></div><div></div></div><div class="refnamediv"><h2>Name</h2><p>achfile &#8212; change type and/or creator of Apple Macintosh files (netatalk
    format)</p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><div class="cmdsynopsis"><p><tt class="command">achfile<a class="indexterm" name="id2884889"></a></tt>  [ -t    <i class="replaceable"><tt>type</tt></i> ] [ -c    <i class="replaceable"><tt>creator</tt></i> ]  <i class="replaceable"><tt>file</tt></i>... </p></div></div><div class="refsect1" lang="en"><a name="id2884960"></a><h2>DESCRIPTION</h2><p><span><b class="command">achfile</b></span> changes the Macintosh type and/or creator
    of the <span class="emphasis"><em>file</em></span> arguments which have a
    corresponding .AppleDouble file.</p></div><div class="refsect1" lang="en"><a name="id2884987"></a><h2>OPTIONS</h2><p><tt class="option">-t</tt> <i class="replaceable"><tt>type</tt></i> change the type.</p><p><tt class="option">-c</tt> <i class="replaceable"><tt>creator</tt></i> change the
    creator.</p></div><div class="refsect1" lang="en"><a name="id2885016"></a><h2>DIAGNOSTICS</h2><p>returns exit status 0 if all files changed successfully</p></div><div class="refsect1" lang="en"><a name="id2885030"></a><h2>SEE ALSO</h2><p><a href="afile.1.html"><span class="citerefentry"><span class="refentrytitle">afile</span>(1)</span></a>,
    <a href="afpd.8.html"><span class="citerefentry"><span class="refentrytitle">afpd</span>(8)</span></a></p></div></div><div class="refentry" lang="en"><div class="refentry.separator"><hr></div><a name="acleandir.1"></a><div class="titlepage"><div></div><div></div></div><div class="refnamediv"><h2>Name</h2><p>acleandir &#8212; clean up a directory containing netatalk Apple Macintosh files</p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><div class="cmdsynopsis"><p><tt class="command">acleandir<a class="indexterm" name="id2885121"></a></tt>  [-rnvi]  <i class="replaceable"><tt>dirname</tt></i> <br></p></div></div><div class="refsect1" lang="en"><a name="id2885154"></a><h2>DESCRIPTION</h2><p><span><b class="command">acleandir</b></span> cleans up the directory <span class="emphasis"><em>dirname.</em></span> By default it simply removes
    "orphan" AppleDouble files, i.e. those which do not have a
    corresponding data file.</p></div><div class="refsect1" lang="en"><a name="id2885181"></a><h2>OPTIONS</h2><div class="variablelist"><dl><dt><span class="term"><tt class="option">-d</tt></span></dt><dd><p>Also remove the .AppleDouble directory if it contains no
          AppleDouble files after "orphan" removal. This will result
          in the finder location of <span class="emphasis"><em>dirname</em></span>
          within its parent being lost.</p></dd><dt><span class="term"><tt class="option">-r</tt>, </span><span class="term"><tt class="option">-R</tt></span></dt><dd><p>Recursive. Clean up directories recursively.</p></dd><dt><span class="term"><tt class="option">-n</tt></span></dt><dd><p>Display the filenames of "orphans" but don't
          remove any. Display size if "orphan" appears to contain a
          resource fork.</p></dd><dt><span class="term"><tt class="option">-i</tt></span></dt><dd><p>Interactive. Prompt for confirmation before a removal. A y in
          answer confirms that the removal should proceed.</p></dd><dt><span class="term"><tt class="option">-v</tt></span></dt><dd><p>Verbose. Display the names of all "orphans" and
          .AppleDouble directories removed. Reports the size if the
          "orphan" appears to contain a resource fork.</p></dd><dt><span class="term"><tt class="option">-a</tt></span></dt><dd><p>Aggressive. Remove all AppleDouble files, not just
          "orphans". Also remove the .AppleDesktop directory if
          present. Impies <tt class="option">-d</tt> option. Use with caution as the
          Macintosh type/creator and finder location of all files will be lost
          and the content of some documents, such as Symantec Projects, will
          be destroyed.</p></dd></dl></div></div><div class="refsect1" lang="en"><a name="id2885340"></a><h2>DIAGNOSTICS</h2><p>returns exit status 0 unless bad options are provided or a directory
    is not given on the command line.</p></div><div class="refsect1" lang="en"><a name="id2885354"></a><h2>SEE ALSO</h2><p><a href="afile.1.html"><span class="citerefentry"><span class="refentrytitle">afile</span>(1)</span></a>,
    <a href="afpd.8.html"><span class="citerefentry"><span class="refentrytitle">afpd</span>(8)</span></a></p></div></div><div class="refentry" lang="en"><div class="refentry.separator"><hr></div><a name="aecho.1"></a><div class="titlepage"><div></div><div></div></div><div class="refnamediv"><h2>Name</h2><p>aecho &#8212; send AppleTalk Echo Protocol packets to network hosts</p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><p><span><b class="command">aecho<a class="indexterm" name="id2885440"></a><a class="indexterm" name="id2885447"></a></b></span> [ <tt class="option">-c</tt><i class="replaceable"><tt> count</tt></i>
    ] ( <span><b class="command">address</b></span> | <span><b class="command">nbpname</b></span> )</p></div><div class="refsect1" lang="en"><a name="id2885484"></a><h2>DESCRIPTION</h2><p><span><b class="command">aecho</b></span> repeatedly sends an Apple Echo Protocol
    (AEP) packet to the host specified by the given AppleTalk
    <span><b class="command">address</b></span> or <span><b class="command">nbpname</b></span> and reports
    whether a reply was received. Requests are sent at the rate of one per
    second.</p><p><span><b class="command">address</b></span> is parsed by
    <a href="atalk_aton.3.html"><span class="citerefentry"><span class="refentrytitle">atalk_aton</span>(3)</span></a>.
    <span><b class="command">nbpname</b></span> is parsed by <a href="nbp_name.3.html"><span class="citerefentry"><span class="refentrytitle">nbp_name</span>(3)</span></a>.
    The nbp type defaults to `<span class="emphasis"><em>Workstation</em></span>'.</p><p>When <span><b class="command">aecho</b></span> is terminated, it reports the number
    of packets sent, the number of responses received, and the percentage of
    packets lost. If any responses were received, the minimum, average, and
    maximum round trip times are reported.</p></div><div class="refsect1" lang="en"><a name="id2885576"></a><h2>EXAMPLE</h2><p>Check to see if a particular host is up and responding to AEP
    packets:</p><pre class="screen"><tt class="prompt">example%</tt> <b class="userinput"><tt>aecho bloodsport
<tt class="computeroutput">11 bytes from 8195.13: aep_seq=0. time=10. ms
11 bytes from 8195.13: aep_seq=1. time=10. ms
11 bytes from 8195.13: aep_seq=2. time=10. ms
11 bytes from 8195.13: aep_seq=3. time=10. ms
11 bytes from 8195.13: aep_seq=4. time=10. ms
11 bytes from 8195.13: aep_seq=5. time=9. ms</tt>
<b class="userinput"><tt>^C</tt></b>
<tt class="computeroutput">----8195.13 AEP Statistics----
6 packets sent, 6 packets received, 0% packet loss
round-trip (ms)  min/avg/max = 9/9/10
</tt></tt></b></pre></div><div class="refsect1" lang="en"><a name="id2885634"></a><h2>OPTIONS</h2><div class="variablelist"><dl><dt><span class="term"><tt class="option">-c</tt><i class="replaceable"><tt> count</tt></i></span></dt><dd><p>Stop after <span class="emphasis"><em>count</em></span> packets.</p></dd></dl></div></div><div class="refsect1" lang="en"><a name="id2885677"></a><h2>SEE ALSO</h2><p><a href="ping.1.html"><span class="citerefentry"><span class="refentrytitle">ping</span>(1)</span></a>,
    <a href="atalk_aton.3.html"><span class="citerefentry"><span class="refentrytitle">atalk_aton</span>(3)</span></a>,
    <a href="nbp_name.3.html"><span class="citerefentry"><span class="refentrytitle">nbp_name</span>(3)</span></a>,
    <a href="aep.4.html"><span class="citerefentry"><span class="refentrytitle">aep</span>(4)</span></a>,
    <a href="atalkd.8.html"><span class="citerefentry"><span class="refentrytitle">atalkd</span>(8)</span></a>.</p></div></div><div class="refentry" lang="en"><div class="refentry.separator"><hr></div><a name="afile.1"></a><div class="titlepage"><div></div><div></div></div><div class="refnamediv"><h2>Name</h2><p>afile &#8212; display type and creator of Apple Macintosh files (netatalk
    format)</p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><div class="cmdsynopsis"><p><tt class="command">afile<a class="indexterm" name="id2885794"></a></tt>  [-a]  <i class="replaceable"><tt>file</tt></i>... <br></p></div></div><div class="refsect1" lang="en"><a name="id2885827"></a><h2>DESCRIPTION</h2><p><span><b class="command">afile</b></span> displays the name and Macintosh type and
    creator of the <span class="emphasis"><em>file</em></span> arguments. Tests
    whether the file is an AppleDouble header, in which case it checks the
    corresponding data fork exists, or assumes it is a data fork in which case
    it looks for the corresponding AppleDouble to find the type/creator
    information.</p><p><span><b class="command">afile</b></span> does not look at any of the extension
    mapping files such as AppleVolumes.system.</p></div><div class="refsect1" lang="en"><a name="id2885869"></a><h2>OPTIONS</h2><div class="variablelist"><dl><dt><span class="term"><tt class="option">-a</tt></span></dt><dd><p>Include directories and data files of unknown type (i.e.
          without corresponding AppleDouble) in output.</p></dd></dl></div></div><div class="refsect1" lang="en"><a name="id2885905"></a><h2>DIAGNOSTICS</h2><p>returns exit status 0 if all files have a corresponding valid
    .AppleDouble header or data fork, or 99 for bad command line options.
    Otherwise it returns the following error code relating to the last invalid
    file.</p><p>1 file doesn't exist</p><p>2 file is unreadable</p><p>3 file is directory</p><p>4 file is AppleDouble without data fork</p><p>5 file is AppleDouble with unreadable data fork</p><p>6 file is data fork without AppleDouble</p><p>7 file is data fork with unreadable AppleDouble</p><p>8 file is data fork with short AppleDouble</p><p>9 bad magic in AppleDouble</p></div><div class="refsect1" lang="en"><a name="id2885961"></a><h2>SEE ALSO</h2><p><a href="achfile.1.html"><span class="citerefentry"><span class="refentrytitle">achfile</span>(1)</span></a>,
    <a href="afpd.8.html"><span class="citerefentry"><span class="refentrytitle">afpd</span>(8)</span></a></p></div></div><div class="refentry" lang="en"><div class="refentry.separator"><hr></div><a name="afpd.8"></a><div class="titlepage"><div></div><div></div></div><div class="refnamediv"><h2>Name</h2><p>afpd &#8212; AppleTalk Filing Protocol daemon</p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><div class="cmdsynopsis"><p><tt class="command">afpd<a class="indexterm" name="id2886052"></a></tt>  [-duptDTvI] [-f <i class="replaceable"><tt>defaultvolumes</tt></i>] [-s <i class="replaceable"><tt>systemvolumes</tt></i>] [-n <i class="replaceable"><tt>nbpname</tt></i>] [-c <i class="replaceable"><tt>maxconnections</tt></i>] [-g <i class="replaceable"><tt>guest</tt></i>] [-P <i class="replaceable"><tt>pidfile</tt></i>] [-S <i class="replaceable"><tt>port</tt></i>] [-L <i class="replaceable"><tt>message</tt></i>] [-F <i class="replaceable"><tt>config</tt></i>] [-U <i class="replaceable"><tt>uamsv</tt></i>] [-m <i class="replaceable"><tt>umask</tt></i>]</p></div></div><div class="refsect1" lang="en"><a name="id2886205"></a><h2>Description</h2><p><span><b class="command">afpd</b></span> provides an AppleTalk Filing Protocol (AFP)
    interface to the Unix file system. It is normally started at boot time
    from /etc/rc. </p><p>The list of volumes offered to the user is generated from
    <tt class="filename">/etc/netatalk/AppleVolumes.system</tt> and one of
    <tt class="filename">/etc/netatalk/AppleVolumes.default</tt>, <tt class="filename">~/AppleVolumes</tt>,
    or <tt class="filename">~/.AppleVolumes</tt>. The <tt class="filename">AppleVolumes</tt>
    files is used to specify volumes to mount and file name extension
    mappings. It is formatted as follows, one specification per line: pathname
    [ volumename ] .extension [ type [ creator ] ] If volumename is
    unspecified, the last component of pathname is used. No two volumes may
    have the same name. If type is unspecified '????' is used. If
    creator is unspecified 'UNIX' is used. The extension '.'
    sets the default creator and type for otherwise untyped Unix files. Blank
    lines and lines beginning with `#' are ignored.</p><p></p></div><div class="refsect1" lang="en"><a name="id2886289"></a><h2>Options</h2><div class="variablelist"><dl><dt><span class="term">-d</span></dt><dd><p>Specifies that the daemon should not fork. If netatalk has been
          configured with <span class="emphasis"><em>--enable-debug1</em></span>, a trace of
          all AFP commands will be written to stdout.</p></dd><dt><span class="term">-p</span></dt><dd><p>Prevents clients from saving their passwords. (Equivalent to -<tt class="option">nosavepasswd</tt>
          in <tt class="filename">afpd.conf</tt>.)</p></dd><dt><span class="term">-t</span></dt><dd><p>Allows clients to change their passwords. (Equivalent to
          <tt class="option">-setpasswd</tt> in <tt class="filename">afpd.conf</tt>.)</p></dd><dt><span class="term">-D</span></dt><dd><p>Use DDP (AppleTalk) as transport protocol. (Equivalent to
          <tt class="option">-ddp</tt> in <tt class="filename">afpd.cond</tt>.)</p></dd><dt><span class="term">-T</span></dt><dd><p>Use TCP/IP as transport protocol. (Equivalent to
          <tt class="option">-tcp</tt> in <tt class="filename">afpd.conf</tt>.)</p></dd><dt><span class="term">-v</span></dt><dd><p>Print version information and exit.</p></dd><dt><span class="term">-I</span></dt><dd><p>Use a platform specific icon. (Equivalent to <tt class="option">-icon</tt>
          in <tt class="filename">afpd.conf</tt>.)</p></dd><dt><span class="term">-f <i class="replaceable"><tt>defaultvolumes</tt></i></span></dt><dd><p>Specifies that <i class="replaceable"><tt>defaultvolumes</tt></i>
          should be read for a list of default volumes to offer, instead of
          <tt class="filename">/etc/netatalk/AppleVolumes.default</tt>.</p></dd><dt><span class="term">-s <i class="replaceable"><tt>systemvolumes</tt></i></span></dt><dd><p>Specifies that <i class="replaceable"><tt>systemvolumes</tt></i> should
          be read for a list of volume that all users will be offered, instead
          of <tt class="filename">/etc/netatalk/AppleVolumes.system</tt>.</p></dd><dt><span class="term">-u</span></dt><dd><p>Read the user's <tt class="filename">AppleVolumes</tt> file
          first. This option causes volume names in the user's
          <tt class="filename">AppleVolumes</tt> file to override volume names in
          the system's <tt class="filename">AppleVolumes</tt> file. The default
          is to read the system <tt class="filename">AppleVolumes</tt> file first.
          Note that this option doesn't effect the precendence of filename
          extension mappings: the user's <tt class="filename">AppleVolumes</tt>
          file always has precedence.</p></dd><dt><span class="term">-n <i class="replaceable"><tt>nbpname</tt></i></span></dt><dd><p>Specifies that <i class="replaceable"><tt>nbpname</tt></i> should be
          used for NBP registration, instead of the first component of the
          hostname in the local zone.</p></dd><dt><span class="term">-c <i class="replaceable"><tt>maxconnections</tt></i></span></dt><dd><p>Specifies the maximum number of connections to allow for this
          <span><b class="command">afpd</b></span>. The default is 20.</p></dd><dt><span class="term">-g <i class="replaceable"><tt>guest</tt></i></span></dt><dd><p>Specifies the name of the guest account. The default is
          '<span class="emphasis"><em>nobody</em></span>'.</p></dd><dt><span class="term">-P <i class="replaceable"><tt>pidfile</tt></i></span></dt><dd><p>Specifies the file in which <span><b class="command">afpd</b></span> stores its
          process id.</p></dd><dt><span class="term">-S <i class="replaceable"><tt>port</tt></i></span></dt><dd><p>Specifies the port to register with when doing AFPoverTCP.
          Defaults to 548. (Equivalent to <tt class="option">-port </tt>in
          <tt class="filename">afpd.conf</tt>.)</p></dd><dt><span class="term">-L <i class="replaceable"><tt>message</tt></i></span></dt><dd><p>Specifies the login message that will be sent to clients.
          (Equivalent to <tt class="option">-loginmsg</tt> in <tt class="filename">afpd.conf</tt>.)</p></dd><dt><span class="term">-F <i class="replaceable"><tt>configfile</tt></i></span></dt><dd><p>Specifies the configuration file to use. (Defaults to
          <tt class="filename">/etc/netatalk/netatalk/afpd.conf</tt>.)</p></dd><dt><span class="term">-U <i class="replaceable"><tt>uams</tt></i></span></dt><dd><p>Comma-separated list of UAMs to use for the authentication
          process. (Equivalent to <tt class="option">-uamlist</tt> in
          <tt class="filename">afpd.conf</tt>.)</p></dd><dt><span class="term">-m <i class="replaceable"><tt>umask</tt></i></span></dt><dd><p>Use this <i class="parameter"><tt>umask</tt></i> for the creation of
          folders in Netatalk.</p></dd></dl></div></div><div class="refsect1" lang="en"><a name="id2886869"></a><h2>SIGNALS</h2><p>Signals that are sent to the main <span><b class="command">afpd</b></span> process
    are propagated to the children, so all will be affected.</p><div class="variablelist"><dl><dt><span class="term">SIGHUP</span></dt><dd><p>Sending a <span><b class="command">SIGHUP</b></span> to afpd will cause it to
          reload its configuration files.</p></dd><dt><span class="term">SIGUSR1</span></dt><dd><p>The <span><b class="command">afpd</b></span> process will send the message
          "The server is going down for maintenance." to the client
          and shut itself down in 5 minutes. New connections are not allowed.
          If this is sent to a child afpd, the other children are not
          affected. However, the main process will still exit, disabling all
          new connections.</p></dd><dt><span class="term">SIGUSR2</span></dt><dd><p>The <span><b class="command">afpd</b></span> process will look in the message
          directory configured at build time for a file named message.pid. For
          each one found, a the contents will be sent as a message to the
          associated AFP client. The file is removed after the message is
          sent. This should only be sent to a child <span><b class="command">afpd</b></span>.
          Warning: If the --with-message-dir option was not used, this will
          kill the <span><b class="command">afpd</b></span> process</p><p>To shut down a user's <span><b class="command">afpd</b></span> process it
          is recommended that <span><b class="command">SIGKILL (-9)</b></span>
          <span class="emphasis"><em>NOT</em></span> be used, except as a last resort, as this
          may leave the CNID database in an inconsistent state. The safe way
          to terminate an <span><b class="command">afpd</b></span> is to send it a
          <span><b class="command">SIGTERM (-15)</b></span> signal and wait for it to die on
          its own.</p></dd></dl></div></div><div class="refsect1" lang="en"><a name="id2887035"></a><h2>FILES</h2><div class="variablelist"><dl><dt><span class="term"><tt class="filename">/etc/netatalk/AppleVolumes.default</tt></span></dt><dd><p>list of default volumes to mount</p></dd><dt><span class="term"><tt class="filename">/etc/netatalk/AppleVolumes.system</tt></span></dt><dd><p>list of volumes to offer all users</p></dd><dt><span class="term"><tt class="filename">~/AppleVolumes</tt></span></dt><dd><p>user's list of volumes to mount</p></dd><dt><span class="term"><tt class="filename">/etc/netatalk/netatalk/msg/message.pid</tt></span></dt><dd><p>contains messages to be sent to users.</p></dd></dl></div></div><div class="refsect1" lang="en"><a name="id2887133"></a><h2>BUGS</h2><p></p></div><div class="refsect1" lang="en"><a name="id2887144"></a><h2>SEE ALSO</h2><p><a href="hosts_access.5.html"><span class="citerefentry"><span class="refentrytitle">hosts_access</span>(5)</span></a>,
    <a href="afpd.conf.5.html"><span class="citerefentry"><span class="refentrytitle">afpd.conf</span>(5)</span></a>,
    <a href="AppleVolumes.default.5.html"><span class="citerefentry"><span class="refentrytitle">AppleVolumes.default</span>(5)</span></a>,
    <a href="AppleVolumes.system.5.html"><span class="citerefentry"><span class="refentrytitle">AppleVolumes.system</span>(5)</span></a>.</p></div></div><div class="refentry" lang="en"><div class="refentry.separator"><hr></div><a name="afpd.conf.5"></a><div class="titlepage"><div></div><div></div></div><div class="refnamediv"><h2>Name</h2><p>afpd.conf &#8212; Configuration file used by afpd(8) to determine the setup of
    its file sharing services<a class="indexterm" name="id2887241"></a></p></div><div class="refsect1" lang="en"><a name="id2887253"></a><h2>Description</h2><p><tt class="filename">/etc/netatalk/afpd.conf</tt> is the configuration file
    used by <span><b class="command">afpd</b></span> to determine the behavior and
    configuration of the different virtual file servers that it
    provides.</p><p>Any line not prefixed with # is interpreted. The configuration lines
    are composed like: server name [ options ] If a <tt class="option">-</tt> is used
    instead of a server name, the default server is specified. Server names
    must be quoted if they contain spaces. They must not contain ":" or "@".
    The path name must be a fully qualified path name, or a path name using
    either the ~ shell shorthand or any of the substitution variables, which
    are listed below.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>Each server has to be configured on a <span class="bold"><b>single</b></span> line.</p></div><p>The possible options and their meanings are:</p></div><div class="refsect1" lang="en"><a name="id2887316"></a><h2>AppleVolumes Files</h2><div class="variablelist"><dl><dt><span class="term">-defaultvol <i class="replaceable"><tt>[path]</tt></i></span></dt><dd><p>Specifies path to AppleVolumes.default file (default is
          <tt class="filename">/etc/netatalk/AppleVolumes.default</tt>).</p></dd><dt><span class="term">-systemvol <i class="replaceable"><tt>[path]</tt></i></span></dt><dd><p>Specifies path to AppleVolumes.system file (default is
          <tt class="filename">/etc/netatalk/AppleVolumes.system</tt>).</p></dd><dt><span class="term">-[no]uservol</span></dt><dd><p>Enables or disables reading of the users' individual volumes
          file entirely.</p></dd><dt><span class="term">-[no]uservolfirst</span></dt><dd><p>Enables or disables reading of the users' individual volumes
          file before processing the global
          <tt class="filename">AppleVolumes.default</tt> file.</p></dd></dl></div></div><div class="refsect1" lang="en"><a name="id2887430"></a><h2>Authentication Methods</h2><div class="variablelist"><dl><dt><span class="term">-uamlist <i class="replaceable"><tt>[uams list]</tt></i></span></dt><dd><p>Comma separated list of UAMs. (The default is
          uams_clrtxt.so,uams_dhx.so).</p><p>The most commonly used UAMs are:</p><div class="variablelist"><dl><dt><span class="term">uams_guest.so</span></dt><dd><p>allows guest logins</p></dd><dt><span class="term">uams_clrtxt.so</span></dt><dd><p>(uams_pam.so or uams_passwd.so) Allow logins with
                passwords transmitted in the clear.</p></dd><dt><span class="term">uams_randum.so</span></dt><dd><p>allows Random Number and Two-Way Random Number Exchange
                for authentication (requires a separate file containing the
                passwords, either /etc/netatalk/afppasswd file or the one specified
                via <tt class="option">-passwdfile</tt>. See <a href="afppasswd.1.html"><span class="citerefentry"><span class="refentrytitle">afppasswd</span>(1)</span></a> for details</p></dd><dt><span class="term">uams_dhx.so</span></dt><dd><p>(uams_dhx_pam.so or uams_dhx_passwd.so) Allow
                Diffie-Hellman eXchange (DHX) for authentication.</p></dd><dt><span class="term">uam_gss.so</span></dt><dd><p>Allow Kerberos V for authentication (optional)</p></dd></dl></div></dd><dt><span class="term">-uampath <i class="replaceable"><tt>[path]</tt></i></span></dt><dd><p>Sets the default path for UAMs for this server (default is
          /etc/netatalk/uams).</p></dd><dt><span class="term">-k5keytab <i class="replaceable"><tt>[path]</tt></i>, </span><span class="term">-k5service <i class="replaceable"><tt>[service]</tt></i>, </span><span class="term">-k5realm <i class="replaceable"><tt>[realm]</tt></i></span></dt><dd><p>These are required if the server supports the Kerberos 5
          authentication UAM.</p></dd></dl></div></div><div class="refsect1" lang="en"><a name="id2887644"></a><h2>Codepage Options</h2><p>With OS X Apple introduced the AFP3 protocol. One of the big changes
    was, that AFP3 uses Unicode names encoded as UTF-8 decomposed. Previous
    AFP/OS versions used codepages like MacRoman, MacCentralEurope,
    etc.</p><p>To be able to serve AFP3 and older clients at the same time,
    <span><b class="command">afpd</b></span> needs to be able to convert between UTF-8 and Mac
    codepages. Even OS X clients partly still rely on codepages. As there's no
    way, <span><b class="command">afpd</b></span> can detect the codepage a pre AFP3 client
    uses, you have to specify it using the <tt class="option">-maccodepage</tt>
    option. The default is MacRoman, which should be fine for most western
    users.</p><p>As <span><b class="command">afpd</b></span> needs to interact with unix operating
    system as well, it need's to be able to convert from UTF-8/MacCodepage to
    the unix codepage. By default <span><b class="command">afpd</b></span> uses the systems
    LOCALE, or ASCII if your system doesn't support locales. You can set the
    unix codepage using the <tt class="option">-unixcodepage</tt> option. If you're
    using extended characters in the configuration files for
    <span><b class="command">afpd</b></span>, make sure your terminal matches the
    <tt class="option">-unixcodepage</tt>.</p><div class="variablelist"><dl><dt><span class="term">-unixcodepage [<i class="parameter"><tt>CODEPAGE</tt></i>]</span></dt><dd><p>Specifies the servers unix codepage, e.g. "ISO-8859-15" or
          "UTF8". This is used to convert strings to/from the systems locale,
          e.g. for authenthication, server messages and volume names. Defaults
          to LOCALE if your system supports it, otherwise ASCII will be
          used.</p></dd><dt><span class="term">-maccodepage [<i class="parameter"><tt>CODEPAGE</tt></i>]</span></dt><dd><p>Specifies the mac clients codepage, e.g. "MAC_ROMAN". This is
          used to convert strings and filenames to the clients codepage for
          OS9 and Classic, i.e. for authentication and AFP messages (SIGUSR2
          messaging). This will also be the default for the volumes
          maccharset. Defaults to MAC_ROMAN.</p></dd></dl></div></div><div class="refsect1" lang="en"><a name="id2887795"></a><h2>Password Options</h2><div class="variablelist"><dl><dt><span class="term">-loginmaxfail [<i class="parameter"><tt>number</tt></i>]</span></dt><dd><p>Sets the maximum number of failed logins, if supported by the
          UAM (currently none)</p></dd><dt><span class="term">-passwdfile [<i class="parameter"><tt>path</tt></i>]</span></dt><dd><p>Sets the path to the Randnum UAM passwd file for this server
          (default is /etc/netatalk/afppasswd).</p></dd><dt><span class="term">-passwdminlen [<i class="parameter"><tt>number</tt></i>]</span></dt><dd><p>Sets the minimum password length, if supported by the
          UAM</p></dd><dt><span class="term">-[no]savepassword</span></dt><dd><p>Enables or disables the ability of clients to save passwords
          locally</p></dd><dt><span class="term">-[no]setpassword</span></dt><dd><p>Enables or disables the ability of clients to change their
          passwords via chooser or the "connect to server" dialog</p></dd></dl></div></div><div class="refsect1" lang="en"><a name="id2887920"></a><h2>Transport Protocols</h2><div class="variablelist"><dl><dt><span class="term">-[no]ddp</span></dt><dd><p>Enables or disables AFP-over-Appletalk. If
          <tt class="option">-proxy</tt> is specified, you must instead use
          <tt class="option">-uamlist ""</tt> to prevent DDP connections from
          working.</p></dd><dt><span class="term">-[no]tcp</span></dt><dd><p>Enables or disables AFP-over-TCP</p></dd><dt><span class="term">-transall</span></dt><dd><p>Make both available (default)</p></dd></dl></div></div><div class="refsect1" lang="en"><a name="id2887994"></a><h2>Transport Options</h2><div class="variablelist"><dl><dt><span class="term">-advertise_ssh</span></dt><dd><p>Allows Mac OS X clients (10.3.3 or above) to automagically
          establish a tunneled AFP connection through SSH. If this option is
          set, the server's answers to client's FPGetSrvrInfo requests contain
          an additional entry. It depends on both client's settings and a
          correctly configured and running <a href="sshd.8.html"><span class="citerefentry"><span class="refentrytitle">sshd</span>(8)</span></a> on the server to let things work.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>Setting this option is not recommended since globally
            encrypting AFP connections via SSH will increase the server's load
            significantly. On the other hand, Apple's client side
            implementation of this feature in MacOS X versions prior to 10.3.4
            contained a security flaw.</p></div></dd><dt><span class="term">-ddpaddr <i class="replaceable"><tt>[ddp address]</tt></i></span></dt><dd><p>Specifies the DDP address of the server. The default is to
          auto-assign an address (0.0). This is only useful if you are running
          AppleTalk on more than one interface.</p></dd><dt><span class="term">-fqdn <i class="replaceable"><tt>[name:port]</tt></i></span></dt><dd><p>Specifies a fully-qualified domain name, with an optional
          port. This is discarded if the server cannot resolve it. This option
          is not honored by AppleShare clients &lt;= 3.8.3. This option is
          disabled by default. Use with caution as this will involve a second
          name resolution step on the client side. Also note that afpd will
          advertise this name:port combination but not automatically listen to
          it.</p></dd><dt><span class="term">-ipaddr <i class="replaceable"><tt>[ip address]</tt></i></span></dt><dd><p>Specifies the IP address that the server should advertise
          <span class="bold"><b>and</b></span> listens to (the default is the
          first IP address of the system). This option also allows to use one
          machine to advertise the AFP-over-TCP/IP settings of another machine
          via NBP<a class="indexterm" name="id2888154"></a> when used together with the <tt class="option">-proxy</tt>
          option.</p></dd><dt><span class="term">-port <i class="replaceable"><tt>[port number]</tt></i></span></dt><dd><p>Allows a different TCP port to be used for AFP-over-TCP. The
          default is 548.</p></dd><dt><span class="term">-proxy</span></dt><dd><p>Runs an AppleTalk proxy server for the specified AFP-over-TCP
          server. If the address and port aren't given, then the first IP
          address of the system and port 548 will be used. If you don't want
          the proxy server to act as a DDP<a class="indexterm" name="id2888217"></a> server as well, set <tt class="option">-uamlist
          ""</tt>.</p></dd><dt><span class="term">-server_quantum <i class="replaceable"><tt>[number]</tt></i></span></dt><dd><p>This specifies the DSI server quantum. The minimum value is
          303840 (0x4A2E0). The maximum value is 0xFFFFFFFFF. If you specify a
          value that is out of range, the default value will be set (which is
          the minimum). Do not change this value unless you're absolutely
          sure, what you're doing</p></dd><dt><span class="term">-noslp</span></dt><dd><p>Do not register this server using the Service Location
          Protocol (if SLP<a class="indexterm" name="id2888282"></a> support was compiled in). This is useful if you are
          running multiple servers and want one to be hidden, perhaps because
          it is advertised elsewhere, ie. by a SLP Directory Agent.</p></dd></dl></div></div><div class="refsect1" lang="en"><a name="id2888307"></a><h2>Miscellaneous Options</h2><div class="variablelist"><dl><dt><span class="term">-admingroup <i class="replaceable"><tt>[group]</tt></i></span></dt><dd><p>Allows users of a certain group to be seen as the superuser
          when they log in. This option is disabled by default.</p></dd><dt><span class="term">-authprintdir <i class="replaceable"><tt>[path]</tt></i></span></dt><dd><p>Specifies the path to be used (per server) to store the files
          required to do CAP-style print authentication which papd will
          examine to determine if a print job should be allowed. These files
          are created at login and if they are to be properly removed, this
          directory probably needs to be umode 1777.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p><tt class="option">-authprintdir</tt> will only work for clients
            connecting via DDP. Almost all modern Clients will use TCP.</p></div></dd><dt><span class="term">-client_polling</span></dt><dd><p>With this switch enabled, afpd won't advertise that it is
          capable of server notifications, so that connected clients poll the
          server every 10 seconds to detect changes in opened server windows.
          <span class="emphasis"><em>Note</em></span>: Depending on the number of simultaneously
          connected clients and the network's speed, this can lead to a
          significant higher load on your network!</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>Do not use this option any longer as Netatalk 2.0 correctly
            supports server notifications, allowing connected clients to
            update folder listings in case another client changed the
            contents.</p></div></dd><dt><span class="term">-cnidserver <i class="replaceable"><tt>[ipaddress:port]</tt></i></span></dt><dd><p>Specifies the IP address and port of a cnid_metad server,
          required for CNID dbd backend. Defaults to localhost:4700.</p></dd><dt><span class="term">-guestname <i class="replaceable"><tt>[name]</tt></i></span></dt><dd><p>Specifies the user that guests should use (default is
          "nobody"). The name should be quoted.</p></dd><dt><span class="term">-icon</span></dt><dd><p>Use the platform-specific icon</p></dd><dt><span class="term">-loginmesg <i class="replaceable"><tt>[message]</tt></i></span></dt><dd><p>Sets a message to be displayed when clients logon to the
          server. The message should be in <tt class="option">unixcodepage</tt> and
          should be quoted. Extended characters are allowed.</p></dd><dt><span class="term">-nodebug</span></dt><dd><p>Disables debugging.</p></dd><dt><span class="term">-sleep <i class="replaceable"><tt>[number]</tt></i></span></dt><dd><p>AFP 3.x waits <i class="parameter"><tt>number</tt></i> hours before
          disconnecting clients in sleep mode. Default is 10 hours.</p></dd><dt><span class="term">-signature { user:&lt;text&gt; | host }</span></dt><dd><p>Specify a server signature. This option is useful while
          running multiple independent instances of afpd on one machine (eg.
          in clustered environments, to provide fault isolation etc.). "host"
          signature type allows afpd generating signature automatically (based
          on machine primary IP address). "user" signature type allows
          administrator to set up a signature string manually. The maximum
          length is 16 characters</p><div class="example"><a name="id2888575"></a><p class="title"><b>Example 5.1. Three server definitions using 2 different server
            signatures</b></p><pre class="programlisting">first -signature user:USERS 
second -signature user:USERS 
third -signature user:ADMINS</pre></div><p>First two servers will appear as one logical AFP service to
          the clients - if user logs in to first one and then connects to
          second one, session will be automatically redirected to the first
          one. But if client connects to first and then to third, will be
          asked for password twice and will see resources of both servers.
          Traditional method of signature generation causes two independent
          afpd instances to have the same signature and thus cause clients to
          be redirected automatically to server (s)he logged in first.</p></dd></dl></div></div><div class="refsect1" lang="en"><a name="id2888616"></a><h2>Logging Options</h2><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>Extended logging capabilities are only available if Netatalk was
      built using <span><b class="command">--with-logfile</b></span>. As of Netatalk 2.0, the
      default is <span><b class="command">--without-logfile</b></span> since the logger code is
      partially broken and needs a complete rewrite (the
      <tt class="option">-setuplog</tt> option might not work as expected). If
      Netatalk was built without logger support then the daemons log to
      syslog.</p></div><div class="variablelist"><dl><dt><span class="term">-[un]setuplog "<i class="parameter"><tt>&lt;logtype&gt; &lt;loglevel&gt;
        [&lt;filename&gt;]</tt></i>"</span></dt><dd><p>Specify that the given loglevel should be applied to log
          messages of the given logtype and that these messages should be
          logged to the given file. If the filename is ommited the loglevel
          applies to messages passed to syslog. Each logtype may have a
          loglevel applied to syslog and a loglevel applied to a single file.
          Latter <tt class="option">-setuplog</tt> settings will override earlier
          ones of the same logtype (file or syslog).</p><p>logtypes: Default, Core, Logger, CNID, AFP</p><p>Daemon loglevels: LOG_SEVERE, LOG_ERROR, LOG_WARN, LOG_NOTE,
          LOG_INFO, LOG_DEBUG, LOG_DEBUG6, LOG_DEBUG7, LOG_DEBUG8, LOG_DEBUG9,
          LOG_MAXDEBUG</p><div class="example"><a name="id2888705"></a><p class="title"><b>Example 5.2. Some ways to change afpd's logging behaviour via
            -[un]setuplog</b></p><p>Example: </p><pre class="programlisting">-setuplog "logger log_maxdebug /var/log/netatalk-logger.log" 
-setuplog "afpdaemon log_maxdebug /var/log/netatalk-afp.log" 
-unsetuplog "default level file" 
-setuplog "default log_maxdebug"</pre></div></dd></dl></div></div><div class="refsect1" lang="en"><a name="id2888736"></a><h2>Debug Options</h2><p>These options are useful for debugging only.</p><div class="variablelist"><dl><dt><span class="term">-tickleval <i class="replaceable"><tt>[number]</tt></i></span></dt><dd><p>Sets the tickle timeout interval (in seconds). Defaults to
          30.</p></dd><dt><span class="term">-timeout <i class="replaceable"><tt>[number]</tt></i></span></dt><dd><p>Specify the number of tickles to send before timing out a
          connection. The default is 4, therefore a connection will timeout
          after 2 minutes.</p></dd></dl></div></div><div class="refsect1" lang="en"><a name="id2888794"></a><h2>Examples</h2><div class="example"><a name="id2888802"></a><p class="title"><b>Example 5.3. afpd.conf default configuration</b></p><pre class="programlisting">- -transall -uamlist uams_clrtxt.so,uams_dhx.so</pre></div><div class="example"><a name="id2888820"></a><p class="title"><b>Example 5.4. afpd.conf MacCyrillic setup / UTF8 unix locale</b></p><pre class="programlisting">- -transall -maccodepage mac_cyrillic -unixcodepage utf8</pre></div><div class="example"><a name="id2888837"></a><p class="title"><b>Example 5.5. afpd.conf setup for Kerberos V auth</b></p><pre class="programlisting">- -transall -uamlist uams_clrtxt.so,uams_dhx.so,uams_guest.so,uams_gss.so \ 
-k5service afpserver -k5keytab /path/to/afpserver.keytab \ 
-k5realm YOUR.REALM -fqdn your.fqdn.namel:548</pre></div><div class="example"><a name="id2888856"></a><p class="title"><b>Example 5.6. afpd.conf letting afpd appear as three servers on the net</b></p><pre class="programlisting">"Guest Server" -uamlist uams_guest.so -loginmesg "Welcome guest!"
"User Server" -uamlist uams_dhx.so -port 12000
"special" -notcp -defaultvol &lt;path&gt; -systemvol &lt;path&gt;</pre></div></div><div class="refsect1" lang="en"><a name="id2888879"></a><h2>See also</h2><p><a href="afpd.8.html"><span class="citerefentry"><span class="refentrytitle">afpd</span>(8)</span></a>, <a href="afppasswd.1.html"><span class="citerefentry"><span class="refentrytitle">afppasswd</span>(1)</span></a>, <a href="AppleVolumes.default.5.html"><span class="citerefentry"><span class="refentrytitle">AppleVolumes.default</span>(5)</span></a></p></div></div><div class="refentry" lang="en"><div class="refentry.separator"><hr></div><a name="afppasswd.1"></a><div class="titlepage"><div></div><div></div></div><div class="refnamediv"><h2>Name</h2><p>afppasswd &#8212; netatalk password maintenance utility</p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><div class="cmdsynopsis"><p><tt class="command">afppasswd<a class="indexterm" name="id2888989"></a><a class="indexterm" name="id2888998"></a></tt>  [-acfn] [ -p
      <i class="replaceable"><tt>passwd</tt></i>   <i class="replaceable"><tt>file</tt></i> ] [ -u
      <i class="replaceable"><tt>minimum</tt></i>   <i class="replaceable"><tt>uid</tt></i> ]</p></div></div><div class="refsect1" lang="en"><a name="id2889081"></a><h2>DESCRIPTION</h2><p><span><b class="command">afppasswd</b></span> allows the maintenance of afppasswd
    files created by netatalk for use by the uams_randnum.so UAM (providing
    the "Randnum exchange" and "2-Way Randnum exchange" User Authentication
    Modules).</p><p><span><b class="command">afppasswd</b></span> can either be called by root with
    parameters, or can be called by local system users with no parameters to
    change their AFP passwords.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>With this utility you can only change the passwords used by two
      specific UAMs. As they provide only weak password encryption, the use of
      the "Randnum exchange" and "2-Way Randnum exchange" UAMs is deprecated
      unless one has to support very old AFP clients, that can not deal with
      the more secure "DHCAST128" UAM instead. Please compare with the <a href="#authentication" title="Authentication">Authentication chapter</a> inside Netatalk's
      documentation.</p></div></div><div class="refsect1" lang="en"><a name="id2889140"></a><h2>EXAMPLE</h2><p>Local user changing their own password:</p><pre class="screen"><tt class="prompt">example%</tt> <b class="userinput"><tt>afppasswd</tt></b>
<tt class="computeroutput">Enter NEW AFP password:</tt> <b class="userinput"><tt>(hidden)</tt></b>
<tt class="computeroutput">Enter NEW AFP password again:</tt> <b class="userinput"><tt>(hidden)</tt></b>
<tt class="computeroutput">afppasswd: updated password.</tt>
</pre></div><div class="refsect1" lang="en"><a name="id2889208"></a><h2>OPTIONS</h2><div class="variablelist"><dl><dt><span class="term"><tt class="option">-a</tt></span></dt><dd><p>Add a new user to the <span><b class="command">afppasswd</b></span>
          file.</p></dd><dt><span class="term"><tt class="option">-c</tt></span></dt><dd><p>Create and/or initialize <span><b class="command">afppasswd</b></span> file or
          specific user.</p></dd><dt><span class="term"><tt class="option">-f</tt></span></dt><dd><p>Force the current action.</p></dd><dt><span class="term"><tt class="option">-p</tt><i class="replaceable"><tt> path</tt></i></span></dt><dd><p>Path to <span><b class="command">afppasswd</b></span> file.</p></dd><dt><span class="term"><tt class="option">-n</tt></span></dt><dd><p>If cracklib support is built into <span class="emphasis"><em>netatalk</em></span> this option will cause cracklib
          checking to be disabled, if the superuser does not want to have the
          password run against the cracklib dictionary.</p></dd><dt><span class="term"><tt class="option">-u</tt><i class="replaceable"><tt> minimum
        uid</tt></i></span></dt><dd><p>This is the minimum <span class="emphasis"><em>user id</em></span>
          (uid) that <span><b class="command">afppasswd</b></span> will use when creating
          users.</p></dd></dl></div></div><div class="refsect1" lang="en"><a name="id2889385"></a><h2>SEE ALSO</h2><p><a href="afpd.8.html"><span class="citerefentry"><span class="refentrytitle">afpd</span>(8)</span></a>, <a href="atalkd.8.html"><span class="citerefentry"><span class="refentrytitle">atalkd</span>(8)</span></a>.</p></div></div><div class="refentry" lang="en"><div class="refentry.separator"><hr></div><a name="AppleVolumes.default.5"></a><div class="titlepage"><div></div><div></div></div><div class="refnamediv"><h2>Name</h2><p>AppleVolumes.default &#8212; Configuration file used by <span><b class="command">afpd</b></span>(8) to
    determine the shares made available through Appletalk<a class="indexterm" name="id2889481"></a><a class="indexterm" name="id2889491"></a></p></div><div class="refsect1" lang="en"><a name="id2889507"></a><h2>Description</h2><p><tt class="filename">/etc/netatalk/AppleVolumes.default</tt> is the
    configuration file used by <span><b class="command">afpd</b></span> to determine what
    portions of the file system will be shared via Apple Filing Protocol, as
    well as their behaviour. Any line not prefixed with # is interpreted. The
    configuration lines are composed like:</p><p><tt class="filename">path</tt> <i class="replaceable"><tt>[ volume name ] [ options
    ]</tt></i></p><p>The path name must be a fully qualified path name, or a path name
    using either the ~ shell shorthand or any of the substitution variables,
    which are listed below.</p><p>The volume name is the name that appears in the Chooser ot the
    "connect to server" dialog on Macintoshes to represent the appropriate
    share. If there are spaces in the name, it should be in quotes (i.e. "File
    Share"). The volume name may not exceed 27 characters in length, and
    cannot contain the <span class="keycode">':'</span> character.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>Each volume has to be configured on a <span class="bold"><b>single</b></span> line.</p></div><p>The possible options and their meanings are:</p><div class="variablelist"><dl><dt><span class="term">adouble:<i class="replaceable"><tt>[v1|v2|osx]</tt></i></span></dt><dd><p>specify the format of the metadata files, which are used for
          saving Mac resource fork as well. Earlier versions used AppleDouble
          V1, the new default format is V2. Starting with Netatalk 2.0, the
          scheme MacOS X uses currently (10.3.x), is also supported</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>Using <tt class="option">adouble:osx</tt> is <span class="bold"><b>not</b></span> recommended for production use. Its
            only aim is to temporarely share eg. FAT32 formatted FireWire
            harddrives written on a Macintosh with afpd. Apple's metadata
            scheme lacks several essential features, so using it on the
            server's side will break both CNIDs and MacOS 9
            compatibility</p></div></dd><dt><span class="term">allow:<i class="replaceable"><tt>[users/groups]</tt></i></span></dt><dd><p>The allow option allows the users and groups that access a
          share to be specified. Users and groups are specified, delimited by
          commas. Groups are designated by a @ prefix. Example:
          allow:user1,user2,@group</p></dd><dt><span class="term">deny:<i class="replaceable"><tt>[users/groups]</tt></i></span></dt><dd><p>The deny option specifies users and groups who are not allowed
          access to the share. It follows the same format as the allow
          option.</p></dd><dt><span class="term">cnidscheme:<i class="replaceable"><tt>[backend]</tt></i></span></dt><dd><p>set the CNID backend to be used for the volume, default is
          [cdb] available schemes:
          [cdb,dbd,last]</p></dd><dt><span class="term">dbpath:<i class="replaceable"><tt>[path]</tt></i></span></dt><dd><p>Sets the database information to be stored in path. You have
          to specifiy a writable location, even if the volume is read
          only.</p></dd><dt><span class="term">maccharset:<i class="replaceable"><tt>[charset]</tt></i></span></dt><dd><p>specifies the mac client codepage for this Volume, e.g.
          "MAC_ROMAN", "MAC_CYRILLIC". If not specified the setting from
          <tt class="filename">afpd.conf</tt> is inherited. This setting is only
          required if you need volumes, where the mac codepage differs from
          the one globally set in <tt class="filename">afpd.conf</tt>.</p></dd><dt><span class="term">options:<i class="replaceable"><tt>[option]</tt></i></span></dt><dd><p>This allows multiple options to be specified in a comma
          delimited format. The available options are:</p><div class="variablelist"><dl><dt><span class="term">limitsize</span></dt><dd><p>Limit disk size reporting to 2GB. This can be used for
                older Macintoshes using newer Appleshare clients.</p></dd><dt><span class="term">ro</span></dt><dd><p>Specifies the share as being read only for all users.
                The .AppleDB directory has to be writeable, you can use the
                <tt class="option">-dbpath</tt> option to relocate it.</p></dd><dt><span class="term">usedots</span></dt><dd><p>Don't do :hex translation for dot files. note: when this
                option gets set, certain file names become illegal. These are
                .Parent and anything that starts with .Apple. Also, dot files
                created on the unix side are marked invisible.</p></dd><dt><span class="term">root_preexec_close</span></dt><dd><p>a non-zero return code from root_preexec closes the
                volume immediately, preventing clients to mount/see the volume
                in question.</p></dd><dt><span class="term">preexec_close</span></dt><dd><p>a non-zero return code from preexec close the volume
                being immediately, preventing clients to mount/see the volume
                in question.</p></dd></dl></div></dd><dt><span class="term">password:<i class="replaceable"><tt>[password]</tt></i></span></dt><dd><p>This option allows you to set a volume password, which can be
          a maximum of 8 characters long (using ASCII strongly recommended at
          the time of this writing).</p></dd><dt><span class="term">preexec:<i class="replaceable"><tt>[command]</tt></i></span></dt><dd><p>command to be run when the volume is mounted, ignored for user
          defined volumes</p></dd><dt><span class="term">postexec:<i class="replaceable"><tt>[command]</tt></i></span></dt><dd><p>command to be run when the volume is closed, ignored for user
          defined volumes</p></dd><dt><span class="term">root_preexec:<i class="replaceable"><tt>[command]</tt></i></span></dt><dd><p>command to be run as root when the volume is mounted, ignored
          for user defined volumes</p></dd><dt><span class="term">root_postexec:<i class="replaceable"><tt>[command]</tt></i></span></dt><dd><p>command to be run as root when the volume is closed, ignored
          for user defined volumes</p></dd><dt><span class="term">rolist:[<tt class="option">users/groups</tt>]</span></dt><dd><p>Allows certain users and groups to have read-only access to a
          share. This follows the allow option format.</p></dd><dt><span class="term">rwlist:<i class="replaceable"><tt>[users/groups]</tt></i></span></dt><dd><p>Allows certain users and groups to have read/write access to a
          share. This follows the allow option format.</p></dd><dt><span class="term">veto:<i class="replaceable"><tt>[vetoed name]</tt></i></span></dt><dd><p>hide files and directories,where the path matches one of the
          '/' delimited vetoed names. Matches are partial, e.g. path is
          <tt class="filename">/abc/def/file</tt> and veto:/abc/ will hide the
          file.</p></dd><dt><span class="term">volcharset:<i class="replaceable"><tt>[charset]</tt></i></span></dt><dd><p>specifies the volume codepage, e.g. "UTF8", "UTF8-MAC",
          "ISO-8859-15". Defaults to "UTF8".</p></dd></dl></div></div><div class="refsect1" lang="en"><a name="id2890114"></a><h2>Variable substitutions</h2><p>You can use variables in both volume path and volume name.</p><div class="orderedlist"><ol type="1"><li><p>if you specify an unknown variable, it will not get
        converted.</p></li><li><p>if you specify a known variable, but that variable doesn't have
        a value, it will get ignored.</p></li></ol></div><p>The variables which can be used for substitutions are:</p><div class="variablelist"><dl><dt><span class="term">$b</span></dt><dd><p>basename</p></dd><dt><span class="term">$c</span></dt><dd><p>client's ip or appletalk address</p></dd><dt><span class="term">$d</span></dt><dd><p>volume pathname on server</p></dd><dt><span class="term">$f</span></dt><dd><p>full name (contents of the gecos field in the passwd
          file)</p></dd><dt><span class="term">$g</span></dt><dd><p>group name</p></dd><dt><span class="term">$h</span></dt><dd><p>hostname</p></dd><dt><span class="term">$i</span></dt><dd><p>client's ip, without port</p></dd><dt><span class="term">$s</span></dt><dd><p>server name (this can be the hostname)</p></dd><dt><span class="term">$u</span></dt><dd><p>user name (if guest, it is the user that guest is running
          as)</p></dd><dt><span class="term">$v</span></dt><dd><p>volume name (either ADEID_NAME or basename of path)</p></dd><dt><span class="term">$z</span></dt><dd><p>appletalk zone (may not exist)</p></dd><dt><span class="term">$$</span></dt><dd><p>prints dollar sign ($)</p></dd></dl></div><p>When using variable substitution in the volume name, always keep in
    mind, not to exceed the 27 characters limit</p><div class="example"><a name="id2890378"></a><p class="title"><b>Example 5.7. Using variable substitution when defining volumes</b></p><pre class="programlisting">/home/groups/$g "Groupdir for $g"
~ "$f is the best one"</pre><p> We define "groupdirs" for each primary
      group and use a personalized server name for homedir shares.</p></div></div><div class="refsect1" lang="en"><a name="id2890402"></a><h2>CNID backends</h2><p>The AFP protocol mostly refers to files and directories by ID and
    not by name. Netatalk needs a way to store these ID's in a persistent way,
    to achieve this several different CNID backends are available. The CNID
    Databases are by default located in the <tt class="filename">.AppleDB</tt>
    folder in the volume root.</p><div class="variablelist"><dl><dt><span class="term">cdb</span></dt><dd><p>"Concurrent database", backend is based on Sleepycat's Berkely
          DB. With this backend several <span><b class="command">afpd</b></span> deamons access
          the CNID database directly. Berkeley DB locking is used to
          synchronize access, if more than one <span><b class="command">afpd</b></span> process
          is active for a volume. The drawback is, that the crash of a single
          <span><b class="command">afpd</b></span> process might corrupt the database.</p></dd><dt><span class="term">dbd</span></dt><dd><p>Access to the CNID database is restricted to the
          <span><b class="command">cnid_metad</b></span> daemon process.
          <span><b class="command">afpd</b></span> processes communicate with the daemon for
          database reads and updates. If built with Berkeley DB transactions
          the probability for database corruption is practically zero, but
          performance can be slower than with <tt class="option">cdb</tt></p></dd><dt><span class="term">last</span></dt><dd><p>This backend is an exception, in terms of ID persistency. ID's
          are only valid for the current session. This is basically what
          <span><b class="command">afpd</b></span> did in the 1.5 (and 1.6) versions. This
          backend is still available, as it is useful for e.g. sharing
          cdroms.</p><p><span class="bold"><b>Warning</b></span>: It is
          <span class="emphasis"><em>NOT</em></span> recommended to use this backend for volumes
          anymore, as <span><b class="command">afpd</b></span> now relies heavily on a
          persistent ID database. Aliases will likely not work and filename
          mangling is not supported.</p></dd></dl></div><p>Even though <span><b class="command">./configure --help</b></span> might show that
    there are other CNID backends available, be warned those are likely broken
    or mainly used for testing. Don't use them unless you know what you're
    doing, they may be removed without further notice from future
    versions.</p></div><div class="refsect1" lang="en"><a name="id2890581"></a><h2>Charset options</h2><p>With OS X Apple introduced the AFP3 protocol. One of the most
    important changes was that AFP3 uses unicode names encoded as UTF-8
    decomposed. Previous AFP/OS versions used codepages, like MacRoman,
    MacCentralEurope, etc.</p><p><span><b class="command">afpd</b></span> needs a way to preserve extended macintosh
    characters, or characters illegal in unix filenames, when saving files on
    a unix filesystem. Earlier versions used the the so called CAP encoding.
    An extended character (&gt;0x7F) would be converted to a :xx sequence,
    e.g. the Apple Logo (MacRoman: 0XF0) was saved as <tt class="literal">:f0</tt>.
    Some special characters will be converted as to :xx notation as well.
    '<span class="keycode">/</span>' will be encoded to <tt class="literal">:2f</tt>, if
    <tt class="option">-usedots</tt> is not specified, a leading dot
    '<span class="keycode">.</span>' will be encoded as <tt class="literal">:2e</tt>.</p><p>This version now uses UTF-8 as the default encoding for names.
    Special characters, like '<span class="keycode">/</span>' and a leading
    '<span class="keycode">.</span>' will still be CAP style encoded .</p><p>The <tt class="option">-volcharset</tt> option will allow you to select
    another volume encoding. E.g. for western users another useful setting
    could be -volcharset ISO-8859-15. <span><b class="command">apfd</b></span> will accept any
    <a href="iconv.1.html"><span class="citerefentry"><span class="refentrytitle"><span><b class="command">iconv</b></span></span>(1)</span></a> provided charset. If a character cannot be converted
    from the mac codepage to the selected volcharset, afpd will save it as a
    CAP encoded character. For AFP3 clients, <span><b class="command">afpd</b></span> will
    convert the UTF-8<a class="indexterm" name="id2890710"></a><a class="indexterm" name="id2890724"></a><a class="indexterm" name="id2890738"></a><a class="indexterm" name="id2890753"></a> character to <tt class="option">-maccharset</tt> first. If this
    conversion fails, you'll receive a -50 error on the mac.</p><p><span class="emphasis"><em>Note</em></span>: Whenever you can, please stick with the
    default UTF-8 volume format.</p></div><div class="refsect1" lang="en"><a name="id2890783"></a><h2>Compatibility with earlier versions</h2><p>To use a volume created with an earlier <span><b class="command">afpd</b></span>
    version, you'll have to specify the following options:</p><div class="example"><a name="id2890804"></a><p class="title"><b>Example 5.8. use a 1.x style volume</b></p><pre class="programlisting">/path/to/volume "Volname" adouble:v1 volcharset:ASCII<a class="indexterm" name="id2890819"></a></pre></div><p>In case you used an NLS you could try using a compatible iconv
    charset for <tt class="option">-volcharset</tt>.</p><div class="example"><a name="id2890844"></a><p class="title"><b>Example 5.9. use a 1.x style volume, created with maccode.iso8859-1</b></p><pre class="programlisting">/path/to/volume "Volname" adouble:v1 volcharset:ISO-8859-1</pre></div><p>You should consider converting old style volumes to the new
    UTF-8/AD2 format. The safest way to do this, is to create a new volume
    with the default options and copy the files between this volumes with a
    mac.</p><p><span class="emphasis"><em>Note</em></span>: Using above example options will allow
    you to downgrade to 1.x netatalk again.</p><p><span class="emphasis"><em>Note</em></span>: Some 1.x NLS files used non standard
    mappings, e.g. <tt class="filename">maccode.iso8859-1.adapted</tt>. This is not
    supported anymore. You'll have to copy the contents of those volumes files
    to a Mac and then back to the netatalk server, preferably to an UTF-8
    volume.</p></div><div class="refsect1" lang="en"><a name="id2890899"></a><h2>Advanced Options</h2><p>The following options should only be used after serious
    consideration. Be sure you fully understood the, sometimes complex,
    consequences, before using them.</p><div class="variablelist"><dl><dt><span class="term">casefold:<tt class="option">[option]</tt></span></dt><dd><p>The casefold option handles, if the case of filenames should
          be changed. The available options are:</p><p><tt class="option">tolower</tt> - Lowercases names in both
          directions.</p><p><tt class="option">toupper</tt> - Uppercases names in both
          directions.</p><p><tt class="option">xlatelower</tt> - Client sees lowercase, server
          sees uppercase.</p><p><tt class="option">xlateupper</tt> - Client sees uppercase, server
          sees lowercase.</p></dd><dt><span class="term">options:[<tt class="option">option</tt>]</span></dt><dd><p>This allows multiple options to be specified in a comma
          delimited format. The available options are:</p><div class="variablelist"><dl><dt><span class="term">cachecnid</span></dt><dd><p>If set <span><b class="command">afpd</b></span> uses the ID information
                stored in AppleDouble V2 header files to reduce database 
                load. Don't set this option if the volume is modified by non
                AFP clients (NFS/SMB/local). Defaults to off.</p></dd><dt><span class="term">crlf</span></dt><dd><p>Enables crlf translation for TEXT files, automatically
                converting macintosh line breaks into Unix ones. Use of this
                option might be dangerous since some older programs store
                binary data files as type "TEXT" when saving and switch the
                filetype in a second step. <span><b class="command">Afpd</b></span> will
                potentially destroy such files when "erroneously" changing
                bytes in order to do line break translation.</p></dd><dt><span class="term">dropbox</span></dt><dd><p>Allows a volume to be declared as being a "dropbox."
                Note that netatalk must be compiled with dropkludge support
                for this to function. <span class="emphasis"><em>Warning</em></span>: This
                option is deprecated and might not work as expected.</p></dd><dt><span class="term">mswindows</span></dt><dd><p>Forces filename restrictions imposed by MS WinXX.
                <span class="emphasis"><em>Warning</em></span>: This is <span class="emphasis"><em>NOT</em></span>
                recommened for volumes mainly used by Macs. Please make sure
                you fully understand this option before using it.</p><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Warning</h3><p>This option breaks direct saving to netatalk volumes from
                 some applications, i.e. OfficeX.</p></div></dd><dt><span class="term">noadouble</span></dt><dd><p>Forces <span><b class="command">afpd</b></span> to not create
                .AppleDouble directories unless macintosh metadata needs to be
                written. This option is only useful if you want to share files
                mostly used NOT by macs, causing <span><b class="command">afpd</b></span> to
                not automatically create .AppleDouble subdirs containing AD
                header files in every directory it enters (which will it do by
                default).</p><p>In case, you save or change files from mac clients, AD
                metadata files have to be written even in case you set this
                option. So you can't avoid the creation of .AppleDouble
                directories and its contents when you give macs write access
                to a share and they make use of it.</p><p>Try to avoid <tt class="option">noadouble</tt> whenever
                possible.</p></dd><dt><span class="term">nodev</span></dt><dd><p>always use 0 for device number, helps when the device
                number is not constant across a reboot, cluster, ...</p></dd><dt><span class="term">nofileid</span></dt><dd><p>don't advertise createfileid, resolveid, deleteid
                calls.</p></dd><dt><span class="term">nohex</span></dt><dd><p>Disables :hex translations for anything except dot
                files. This option makes the <span class="keycode">'/</span>' character
                illegal.</p></dd><dt><span class="term">prodos</span></dt><dd><p>Provides compatibility with Apple II clients.</p></dd><dt><span class="term">nostat</span></dt><dd><p>don't stat volume path when enumerating volumes list,
                useful for automounting or volumes created by a preexec
                script.</p></dd><dt><span class="term">upriv</span></dt><dd><p>use AFP3 unix privileges. Become familiar with the new
                "unix privileges" AFP permissions concepts in MacOS X before
                using this option.</p></dd></dl></div></dd></dl></div></div><div class="refsect1" lang="en"><a name="id2891308"></a><h2>See Also</h2><p><a href="afpd.conf.5.html"><span class="citerefentry"><span class="refentrytitle">afpd.conf</span>(5)</span></a>, <a href="afpd.8.html"><span class="citerefentry"><span class="refentrytitle">afpd</span>(8)</span></a></p></div></div><div class="refentry" lang="en"><div class="refentry.separator"><hr></div><a name="apple_cp.1"></a><div class="titlepage"><div></div><div></div></div><div class="refnamediv"><h2>Name</h2><p>apple_cp &#8212; Do an apple copy, copying file metadata and the resource fork as well</p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><p><span class="emphasis"><em>/usr/bin/apple_cp<a class="indexterm" name="id2891406"></a></em></span> <span class="emphasis"><em>SOURCE
    DEST</em></span> <span class="emphasis"><em>/usr/bin/apple_cp</em></span> <span class="emphasis"><em>SOURCE</em></span>... <span class="emphasis"><em>DIRECTORY</em></span></p></div><div class="refsect1" lang="en"><a name="id2891441"></a><h2>DESCRIPTION</h2><p><span class="emphasis"><em>apple_cp</em></span> is a perl script to copy
    SOURCE to DEST or multiple SOURCE(s) to DIRECTORY. It also copies the file 
    specific metadata (including resource forks) to the .AppleDouble directory
    for DEST or DIRECTORY. If the .AppleDouble directory doesn't exist for 
    DEST or DIRECTORY it will create it.</p></div><div class="refsect1" lang="en"><a name="id2891465"></a><h2>EXAMPLES</h2><p><span class="emphasis"><em>/usr/bin/apple_cp</em></span> test.text
    /target/directory/</p><p><span class="emphasis"><em>/usr/bin/apple_cp</em></span> test.text
    /target/directory/test2.text</p><p><span class="emphasis"><em>/usr/bin/apple_cp</em></span> test.text
    testing.text /target/directory/</p></div><div class="refsect1" lang="en"><a name="id2891504"></a><h2>REPORTING BUGS</h2><p>Report bugs to the Netatalk-devel list
    &lt;netatalk-devel@lists.sourceforge.net&gt;.</p></div><div class="refsect1" lang="en"><a name="id2891518"></a><h2>SEE ALSO</h2><p><a href="apple_mv.1.html"><span class="citerefentry"><span class="refentrytitle">apple_mv</span>(1)</span></a>,
    <a href="apple_rm.1.html"><span class="citerefentry"><span class="refentrytitle">apple_rm</span>(1)</span></a>.</p></div></div><div class="refentry" lang="en"><div class="refentry.separator"><hr></div><a name="apple_mv.1"></a><div class="titlepage"><div></div><div></div></div><div class="refnamediv"><h2>Name</h2><p>apple_mv &#8212; Do an apple move, moving metadata and the resource fork as well</p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><p><span class="emphasis"><em>/usr/bin/apple_mv<a class="indexterm" name="id2891605"></a></em></span> <span class="emphasis"><em>SOURCE
    DEST</em></span> <span class="emphasis"><em>/usr/bin/apple_mv</em></span> <span class="emphasis"><em>SOURCE</em></span>... <span class="emphasis"><em>DIRECTORY</em></span></p></div><div class="refsect1" lang="en"><a name="id2891641"></a><h2>DESCRIPTION</h2><p><span class="emphasis"><em>apple_mv</em></span> is a perl script to move
    SOURCE to DEST or multiple SOURCE(s) to DIRECTORY. It also moves the file 
    specific metadata (including resource forks) to the .AppleDouble directory
    for DEST or DIRECTORY. If the .AppleDouble directory doesn't exist for 
    DEST or DIRECTORY it will create it.</p></div><div class="refsect1" lang="en"><a name="id2891665"></a><h2>EXAMPLES</h2><p><span class="emphasis"><em>/usr/bin/apple_mv</em></span> test.text
    /target/directory/</p><p><span class="emphasis"><em>/usr/bin/apple_mv</em></span> test.text
    /target/directory/test2.text</p><p><span class="emphasis"><em>/usr/bin/apple_mv</em></span> test.text
    testing.text /target/directory/</p></div><div class="refsect1" lang="en"><a name="id2891704"></a><h2>REPORTING BUGS</h2><p>Report bugs to the Netatalk-devel list
    &lt;netatalk-devel@lists.sourceforge.net&gt;.</p></div><div class="refsect1" lang="en"><a name="id2891718"></a><h2>SEE ALSO</h2><p><a href="apple_cp.1.html"><span class="citerefentry"><span class="refentrytitle">apple_cp</span>(1)</span></a>,
    <a href="apple_rm.1.html"><span class="citerefentry"><span class="refentrytitle">apple_rm</span>(1)</span></a>.</p></div></div><div class="refentry" lang="en"><div class="refentry.separator"><hr></div><a name="apple_rm.1"></a><div class="titlepage"><div></div><div></div></div><div class="refnamediv"><h2>Name</h2><p>apple_rm &#8212; Do an apple remove, remove metadata and resource fork as
    well</p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><p><span class="emphasis"><em>/usr/bin/apple_rm<a class="indexterm" name="id2891806"></a></em></span> <span class="emphasis"><em>FILE</em></span>...</p></div><div class="refsect1" lang="en"><a name="id2891826"></a><h2>DESCRIPTION</h2><p><span class="emphasis"><em>apple_rm</em></span> is a perl script that
    removes FILE(s) as well as the .AppleDouble metadata file(s) that
    corresponds to FILE(s). These AppleDouble header files eventually also
    contain the resource fork if the files had one. <span class="emphasis"><em>apple_rm</em></span> does not delete directories.</p></div><div class="refsect1" lang="en"><a name="id2891855"></a><h2>EXAMPLES</h2><p><span class="emphasis"><em>/usr/bin/apple_rm</em></span> test.text</p><p><span class="emphasis"><em>/usr/bin/apple_rm</em></span> test.text
    testing.text</p></div><div class="refsect1" lang="en"><a name="id2891883"></a><h2>REPORTING BUGS</h2><p>Report bugs to the Netatalk-devel list
    &lt;netatalk-devel@lists.sourceforge.net&gt;.</p></div><div class="refsect1" lang="en"><a name="id2891896"></a><h2>SEE ALSO</h2><p><a href="apple_cp.1.html"><span class="citerefentry"><span class="refentrytitle">apple_cp</span>(1)</span></a>, <a href="apple_mv.1.html"><span class="citerefentry"><span class="refentrytitle">apple_mv</span>(1)</span></a>.</p></div></div><div class="refentry" lang="en"><div class="refentry.separator"><hr></div><a name="asip-status.pl.1"></a><div class="titlepage"><div></div><div></div></div><div class="refnamediv"><h2>Name</h2><p>asip-status.pl &#8212; Queries AFP servers for their capabilities</p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><p><span class="emphasis"><em>/usr/bin/asip-status.pl<a class="indexterm" name="id2891993"></a></em></span> ADDRESS<span class="emphasis"><em>:PORT</em></span>...</p></div><div class="refsect1" lang="en"><a name="id2892012"></a><h2>DESCRIPTION</h2><p><span class="emphasis"><em>asip-status.pl</em></span> is a perl script that
    sends a FPGetSrvrInfo request to an AFP server at ADDRESS:PORT and
    displays the results, namely "Machine type", the server's name, supported
    AFP versions, UAMs and AFP flags, the "server signature" and the network
    addresses, the server provides AFP services on.</p><p>When you don't supply :PORT, then the default AFP port, 548, will be
    used.</p></div><div class="refsect1" lang="en"><a name="id2892042"></a><h2>EXAMPLES</h2><pre class="programlisting"><span class="emphasis"><em>/usr/bin/asip-status.pl</em></span> 192.168.21.2
AFP reply from 192.168.21.2:548
Flags: 1  Cmd: 3  ID: 57005
Reply: DSIGetStatus
Request ID: 57005
Machine type: Macintosh
AFP versions: AFPVersion 1.1,AFPVersion 2.0,AFPVersion 2.1,AFP2.2
UAMs: Cleartxt passwrd,Randnum exchange,2-Way Randnum exchange
Flags: SupportsCopyFile,SupportsChgPwd,SupportsServerMessages,
SupportsServerSignature,SupportsTCP/IP,SupportsSuperClient
Server name: PowerMac 9600/200
Signature:
04 c1 6e 59 04 c1 6e 59 04 c1 6e 59 04 c1 6e 59  ..nY..nY..nY..nY
                                                  
Network address: 192.168.21.2:548 (tcp/ip address and port)
Network address: 10.20 (ddp address)
</pre><pre class="programlisting"><span class="emphasis"><em>/usr/bin/asip-status.pl</em></span> 192.168.21.1:10548
AFP reply from 192.168.21.1:10548
Flags: 1  Cmd: 3  ID: 57005
Reply: DSIGetStatus
Request ID: 57005
Machine type: Netatalk
AFP versions: AFPVersion 1.1,AFPVersion 2.0,AFPVersion 2.1,AFP2.2,AFPX03,
AFP3.1
UAMs: Cleartxt passwrd,Randnum exchange,2-Way Randnum exchange,DHCAST128
Flags: SupportsCopyFile,SupportsServerMessages,SupportsServerSignature,
SupportsTCP/IP,SupportsSrvrNotifications,SupportsOpenDirectory,
SupportsUTF8Servername,SupportsSuperClient
Server name: Fire V480
Signature:
83 29 cc 60 83 29 cc 60 83 29 cc 60 83 29 cc 60  .).`.).`.).`.).`
                                                  
Network address: 192.168.21.1:10548 (TCP/IP address and port)
Network address: 65282.142 (ddp address)
UTF8 Servername: Fire V480
</pre></div><div class="refsect1" lang="en"><a name="id2892106"></a><h2>REPORTING BUGS</h2><p>Report bugs to the Netatalk-devel list
    &lt;netatalk-devel@lists.sourceforge.net&gt;.</p></div></div><div class="refentry" lang="en"><div class="refentry.separator"><hr></div><a name="atalk.4"></a><div class="titlepage"><div></div><div></div></div><div class="refnamediv"><h2>Name</h2><p>atalk &#8212; AppleTalk protocol family<a class="indexterm" name="id2892164"></a></p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><div class="funcsynopsis"><pre class="funcsynopsisinfo">#include &lt;sys/types.h&gt;
#include &lt;netatalk/at.h&gt;</pre></div></div><div class="refsect1" lang="en"><a name="id2892193"></a><h2>DESCRIPTION</h2><p>The AppleTalk protocol family is a collection of protocols layered
    above the Datagram Delivery Protocol (DDP), and using AppleTalk address
    format. The AppleTalk family may provide SOCK_STREAM (ADSP), SOCK_DGRAM
    (DDP), SOCK_RDM (ATP), and SOCK_SEQPACKET (ASP). Currently, only DDP is
    implemented in the kernel; ATP and ASP are implemented in user level
    libraries; and ADSP is planned.</p></div><div class="refsect1" lang="en"><a name="id2892213"></a><h2>ADDRESSING</h2><p>AppleTalk addresses are three byte quantities, stored in network
    byte order. The include file &lt;<span class="emphasis"><em>netatalk/at.h</em></span>&gt;
    defines the AppleTalk address format.</p><p>Sockets in the AppleTalk protocol family use the following address
    structure:</p><pre class="programlisting">struct sockaddr_at {
    short sat_family;
    u_char sat_port;
    struct at_addr sat_addr;
    char sat_zero[ 8 ];
};
</pre><p>The port of a socket may be set with <a href="bind.2.html"><span class="citerefentry"><span class="refentrytitle">bind</span>(2)</span></a>.
    The node for <span class="emphasis"><em>bind</em></span> must always be <span class="emphasis"><em>ATADDR_ANYNODE</em></span>: ``this node.'' The net may be
    <span class="emphasis"><em>ATADDR_ANYNET</em></span> or <span class="emphasis"><em>ATADDR_LATENET</em></span>.
    <span class="emphasis"><em>ATADDR_ANYNET</em></span> coresponds to the
    machine's ``primary'' address (the first configured).
    <span class="emphasis"><em>ATADDR_LATENET</em></span> causes the address in
    outgoing packets to be determined when a packet is sent, i.e. determined
    late. <span class="emphasis"><em>ATADDR_LATENET</em></span> is equivalent to
    opening one socket for each network interface. The port of a socket and
    either the primary address or <span class="emphasis"><em>ATADDR_LATENET</em></span>
    are returned with <a href="getsockname.2.html"><span class="citerefentry"><span class="refentrytitle">getsockname</span>(2)</span></a>.</p></div><div class="refsect1" lang="en"><a name="id2892337"></a><h2>SEE ALSO</h2><p><a href="bind.2.html"><span class="citerefentry"><span class="refentrytitle">bind</span>(2)</span></a>,
    <a href="getsockname.2.html"><span class="citerefentry"><span class="refentrytitle">getsockname</span>(2)</span></a>,
    <a href="atalkd.8.html"><span class="citerefentry"><span class="refentrytitle">atalkd</span>(8)</span></a>.</p></div></div><div class="refentry" lang="en"><div class="refentry.separator"><hr></div><a name="atalkd.8"></a><div class="titlepage"><div></div><div></div></div><div class="refnamediv"><h2>Name</h2><p>atalkd &#8212; AppleTalk RTMP, NBP, ZIP, and AEP manager</p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><div class="cmdsynopsis"><p><tt class="command">atalkd<a class="indexterm" name="id2892446"></a><a class="indexterm" name="id2892455"></a><a class="indexterm" name="id2892470"></a><a class="indexterm" name="id2892484"></a><a class="indexterm" name="id2892498"></a><a class="indexterm" name="id2892512"></a></tt>  [-f <i class="replaceable"><tt>configfile</tt></i>] [-1] [-2]</p></div></div><div class="refsect1" lang="en"><a name="id2892561"></a><h2>Description</h2><p><span><b class="command">atalkd</b></span> is responsible for all user level
    AppleTalk network management. This includes routing, name registration and
    lookup, zone lookup, and the AppleTalk Echo Protocol (similar to
    <a href="ping.8.html"><span class="citerefentry"><span class="refentrytitle">ping</span>(8)</span></a>). <span><b class="command">atalkd</b></span> is typically started at boot
    time, out of <tt class="filename">/etc/rc</tt>. It first reads from its
    configuration file, <tt class="filename">/etc/netatalk/atalkd.conf</tt>. If there is
    no configuration file, <span><b class="command">atalkd</b></span> will attempt to configure
    all available interfaces and will create a configuration file. The file
    consists of a series of interfaces, one per line. Lines with `#' in the
    first column are ignored, as are blank lines. The syntax is</p><p><span class="emphasis"><em>interface</em></span> [ <tt class="option">-seed</tt> ]
    [ <tt class="option">-phase</tt> <i class="replaceable"><tt>number</tt></i> ] [
    <tt class="option">-net</tt> <i class="replaceable"><tt>net-range</tt></i> ] [
    <tt class="option">-addr</tt> <i class="replaceable"><tt>address</tt></i> ] [
    <tt class="option">-zone</tt> <i class="replaceable"><tt>zonename</tt></i> ] ...</p><p>Note that all fields except the interface are optional. The loopback
    interface is configured automatically. If <tt class="option">-seed</tt> is
    specified, all other fields must be present. Also,
    <span><b class="command">atalkd</b></span> will exit during bootstrap­ping, if a router
    disagrees with its seed information. If <tt class="option">-seed</tt> is not
    given, all other information may be overriden during auto-configuration.
    If no <tt class="option">-phase</tt> option is given, the default phase as given
    on the command line is used (the default is 2). If <tt class="option">-addr</tt>
    is given and <tt class="option">-net</tt> is not, a net-range of one is
    assumed.</p><p>The first -zone directive for each interface is the ``default''
    zone. Under Phase 1, there is only one zone. Under Phase 2, all routers on
    the network are configured with the default zone and must agree.
    <span><b class="command">atalkd</b></span> maps ``*'' to the default zone of the first
    interface. Note: The default zone for a machine is determined by the
    configuration of the local routers; to appear in a non-default zone, each
    service, e.g. <span><b class="command">afpd</b></span>, must individually specify the
    desired zone. See also <a href="nbp_name.3.html"><span class="citerefentry"><span class="refentrytitle">nbp_name</span>(3)</span></a>.</p></div><div class="refsect1" lang="en"><a name="id2892759"></a><h2>Routing</h2><p>If you are connecting a netatalk router to an existing AppleTalk
    internet, you should first contact your local network administrators to
    obtain appropriate network addresses.</p><p><span><b class="command">atalkd</b></span> can provide routing between interfaces by
    configuring multiple interfaces. Each interface must be assigned a unique
    net-range<a class="indexterm" name="id2892785"></a> between 1 and 65279 (0 and 65535 are illegal, and addresses
    between 65280 and 65534 are reserved for startup). It is best to choose
    the smallest useful net-range, i.e. if you have three machines on an
    Ethernet, don't chose a net-range of 1000-2000. Each net-range may have an
    arbitrary list of zones associated with it.</p></div><div class="refsect1" lang="en"><a name="id2892807"></a><h2>Examples</h2><p>Below is an example configuration file for a sun4/40. The machine
    has two interfaces, ``le0'' and ``le1''. The ``le0'' interface is
    configured automatically from other routers on the network. The machine is
    the only router for the ``le1'' interface.</p><pre class="programlisting">   le0
   le1 -seed -net 9461-9471 -zone netatalk -zone Argus</pre><p><span><b class="command">atalkd</b></span>
    automatically acts as a router if there is more than one interface.</p></div><div class="refsect1" lang="en"><a name="id2892844"></a><h2>Files</h2><p><tt class="filename">/etc/netatalk/atalkd.conf</tt> configuration file</p></div><div class="refsect1" lang="en"><a name="id2892862"></a><h2>Bugs</h2><p>On some systems, <span><b class="command">atalkd</b></span> can not be
    restarted.</p></div><div class="refsect1" lang="en"><a name="id2892881"></a><h2>SEE ALSO</h2><p><a href="atalkd.conf.5.html"><span class="citerefentry"><span class="refentrytitle">atalkd.conf</span>(5)</span></a></p></div></div><div class="refentry" lang="en"><div class="refentry.separator"><hr></div><a name="atalkd.conf.5"></a><div class="titlepage"><div></div><div></div></div><div class="refnamediv"><h2>Name</h2><p>atalkd.conf &#8212; Configuration file used by atalkd(8) to determine the
    interfaces used by the master Netatalk daemon<a class="indexterm" name="id2892955"></a><a class="indexterm" name="id2892962"></a><a class="indexterm" name="id2892976"></a></p></div><div class="refsect1" lang="en"><a name="id2892992"></a><h2>DESCRIPTION</h2><p><span class="emphasis"><em>/etc/netatalk/atalkd.conf</em></span> is the
    configuration file used by atalkd to configure the Appletalk interfaces
    and their behavior</p><p>Any line not prefixed with <span class="emphasis"><em>#</em></span> is
    interpreted. The configuration lines are composed like:</p><p><span class="emphasis"><em>Interface</em></span> <span class="emphasis"><em>[</em></span> <span class="emphasis"><em>options</em></span> <span class="emphasis"><em>]</em></span></p><p>The simplest case is to have either no atalkd.conf, or to have one
    that has no active lines. In this case, atalkd should auto-discover the
    local interfaces on the machine. Please note that you cannot split
    lines.</p><p>The interface is the network interface that this to work over, such
    as <span class="emphasis"><em>eth0</em></span> for Linux, or <span class="emphasis"><em>le0</em></span> for Sun.</p><p>The possible options and their meanings are:</p><div class="variablelist"><dl><dt><span class="term"><tt class="option">-addr
        <i class="replaceable"><tt>net.node</tt></i></tt></span></dt><dd><p>Allows specification of the net and node numbers for this
          interface, specified in Appletalk numbering format (example:
          <tt class="option">-addr 66.6</tt>).</p></dd><dt><span class="term"><tt class="option">-dontroute</tt></span></dt><dd><p>Disables Appletalk routing. It is the opposite of
          <tt class="option">-router</tt>.</p></dd><dt><span class="term"><tt class="option">-net first[-last]</tt></span></dt><dd><p>Allows the available net to be set, optionally as a
          range.</p></dd><dt><span class="term"><tt class="option">-noallmulti</tt> (linux only)</span></dt><dd><p>On linux the interfaces, atalkd uses, are set to
          ALLMULTI by default caused by countless NICs having problems
          without being forced into this mode (some even don't work with
          allmulti set). In case, you've a NIC known to support multicasts
          properly, you might want to set this option causing less packets to
          be processed</p></dd><dt><span class="term"><tt class="option">-phase ( 1 | 2 )</tt></span></dt><dd><p>Specifies the Appletalk phase that this interface is to use
          (either Phase 1 or Phase 2).</p></dd><dt><span class="term"><tt class="option">-router</tt></span></dt><dd><p>Like <tt class="option">-seed</tt>, but allows single interface
          routing. It is the opposite of <tt class="option">-dontroute</tt>.</p></dd><dt><span class="term"><tt class="option">-seed</tt></span></dt><dd><p>The seed option only works if you have multiple interfaces. It
          also causes all missing arguments to be automagically configured
          from the network.</p></dd><dt><span class="term"><tt class="option">-zone
        <i class="replaceable"><tt>zonename</tt></i></tt></span></dt><dd><p>Specifies a specific zone that this interface should appear on (example:
          <tt class="option">-zone "Parking Lot"</tt>). Please note that zones with
          spaces and other special characters should be enclosed in
          parentheses.</p></dd></dl></div></div><div class="refsect1" lang="en"><a name="id2893295"></a><h2>SEE ALSO</h2><p><a href="atalkd.8.html"><span class="citerefentry"><span class="refentrytitle">atalkd</span>(8)</span></a></p></div></div><div class="refentry" lang="en"><div class="refentry.separator"><hr></div><a name="atalk_aton.3"></a><div class="titlepage"><div></div><div></div></div><div class="refnamediv"><h2>Name</h2><p>atalk_aton &#8212; AppleTalk address parsing<a class="indexterm" name="id2893363"></a></p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><div class="funcsynopsis"><pre class="funcsynopsisinfo">#include &lt;sys/types.h&gt;
#include &lt;netatalk/at.h&gt;</pre><p><code class="funcdef"><b class="fsfunc">atalk_aton</b>(</code><var class="pdparam">cp</var>, <var class="pdparam">ata</var><code>)</code>;<br>char * <code>cp</code>;<br>struct at_addr * <code>ata</code>;</p></div></div><div class="refsect1" lang="en"><a name="id2893422"></a><h2>DESCRIPTION</h2><p>The <tt class="function">atalk_aton()</tt> routine converts an ASCII
    representation of an AppleTalk address to a format appropriate for system
    calls. Acceptable ASCII representations include both hex and base 10, in
    triples or doubles. For instance, the address `0x1f6b.77' has a
    network part of `8043' and a node part of `119'. This same address
    could be written `8043.119', `31.107.119', or `0x1f.6b.77'. If
    the address is in hex and the first digit is one of `A-F', a leading
    `0x' is redundant.</p></div><div class="refsect1" lang="en"><a name="id2893450"></a><h2>SEE ALSO</h2><p><a href="atalk.4.html"><span class="citerefentry"><span class="refentrytitle">atalk</span>(4)</span></a>.</p></div></div><div class="refentry" lang="en"><div class="refentry.separator"><hr></div><a name="cnid_dbd.8"></a><div class="titlepage"><div></div><div></div></div><div class="refnamediv"><h2>Name</h2><p>cnid_dbd &#8212; implement access to CNID databases through a dedicated daemon
    process</p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><div class="cmdsynopsis"><p><tt class="command">cnid_dbd<a class="indexterm" name="id2893533"></a><a class="indexterm" name="id2893540"></a><a class="indexterm" name="id2893550"></a></tt>   <i class="replaceable"><tt>dbdir</tt></i>   <i class="replaceable"><tt>ctrlfd</tt></i>   <i class="replaceable"><tt>clntfd</tt></i> </p></div></div><div class="refsect1" lang="en"><a name="id2893600"></a><h2>DESCRIPTION</h2><p><span><b class="command">cnid_dbd</b></span> provides an interface for storage and
    retrieval of catalog node IDs (CNIDs) and related information to the
    <span class="emphasis"><em>afpd</em></span> daemon. CNIDs are a component of
    Macintosh based file systems with semantics that map not easily onto Unix
    file systems. This makes separate storage in a database necessary.
    <span><b class="command">cnid_dbd</b></span> is part of the <span class="emphasis"><em>CNID
    backend</em></span> framework of <span class="emphasis"><em>afpd</em></span> and
    implements the <span class="emphasis"><em>dbd</em></span> backend.</p><p><span><b class="command">cnid_dbd</b></span> is never started via the command line or
    system startup scripts but only by the <span class="emphasis"><em>cnid_metad</em></span> daemon. There is at most one instance of
    <span><b class="command">cnid_dbd</b></span> per netatalk volume.</p><p><span><b class="command">cnid_dbd</b></span> uses the <span class="emphasis"><em>Berkleley
    DB</em></span> database library and optionally supports transactionally
    protected updates if the netatalk package is compiled with the appropriate
    options. Using the <span class="emphasis"><em>dbd</em></span> backend without
    transactions will protect the CNID database against unexpected crashes of
    the <span class="emphasis"><em>afpd</em></span> daemon. Using the <span class="emphasis"><em>dbd</em></span> backend with transactions will avoid corruption
    of the CNID database even if the system crashes unexpectedly.</p><p><span><b class="command">cnid_dbd</b></span> uses the same on-disk database format as
    the <span class="emphasis"><em>cdb</em></span> backend. It is therefore possible
    to switch between the two backends as necessary.</p><p><span><b class="command">cnid_dbd</b></span> inherits the effective userid and
    groupid from <span class="emphasis"><em>cnid_metad</em></span> on startup, which
    is normally caused by <span class="emphasis"><em>afpd</em></span> serving a
    netatalk volume to a client. It changes to the <span class="emphasis"><em>Berkleley DB</em></span> database home directory <span class="emphasis"><em>dbdir</em></span> that is associated with the volume. If the
    userid inherited from <span class="emphasis"><em>cnid_metad</em></span> is 0
    (root), <span><b class="command">cnid_dbd</b></span> will change userid and groupid to the
    owner and group of the database home directory. Otherwise, it will
    continue to use the inherited values. <span><b class="command">cnid_dbd</b></span> will
    then attempt to open the database and start serving requests using
    filedescriptor <span class="emphasis"><em>clntfd</em></span>. Subsequent instances
    of <span class="emphasis"><em>afpd</em></span> that want to access the same volume
    are redirected to the running <span><b class="command">cnid_dbd</b></span> process by
    <span class="emphasis"><em>cnid_metad</em></span> via the filedescriptor <span class="emphasis"><em>ctrlfd</em></span>.</p><p><span><b class="command">cnid_dbd</b></span> can be configured to run forever or to
    exit after a period of inactivity. If <span><b class="command">cnid_dbd</b></span> receives
    a TERM or an INT signal it will exit cleanly after flushing dirty database
    buffers to disk and closing <span class="emphasis"><em>Berkleley DB</em></span>
    database environments. It is safe to terminate <span><b class="command">cnid_dbd</b></span>
    this way, it will be restarted when necessary. Other signals are not
    handled and will cause an immediate exit, possibly leaving the CNID
    database in an inconsistent state (no transactions) or losing recent
    updates during recovery (transactions).</p><p>If transactions are used the <span class="emphasis"><em>Berkleley
    DB</em></span> database subsystem will create files named log.xxxxxxxxxx in
    the database home directory <span class="emphasis"><em>dbdir</em></span>, where
    xxxxxxxxxx is a monotonically increasing integer. These files contain
    information to replay database changes and are not automatically removed,
    unless the <span class="emphasis"><em>logfile_autoremove</em></span> option is
    specified in the <span class="emphasis"><em>db_param</em></span> configuration
    file (see below). Please see the sections <span class="emphasis"><em>Database and
    log file archival</em></span>, <span class="emphasis"><em> Log file
    removal</em></span> and the documentation of the <span class="emphasis"><em>
    db_archive</em></span> command line utility in the Berkeley DB Tutorial and
    Reference for information when and how it is safe to remove these files
    manually.</p><p>Do not use <span><b class="command">cnid_dbd</b></span> for databases on
    NFS mounted file systems. It makes the whole point of securing
    database changes properly moot. Use the dbdir: Option in the appropriate
    <span class="emphasis"><em>AppleVolumes</em></span> configuration file to put the
    database onto a local disk.</p></div><div class="refsect1" lang="en"><a name="id2893972"></a><h2>CONFIGURATION</h2><p><span><b class="command">cnid_dbd</b></span> reads configuration information from the
    file <span class="emphasis"><em>db_param</em></span> in the database directory
    <span class="emphasis"><em>dbdir</em></span> on startup. If the file does not
    exist or a parameter is not listed, suitable default values are used. The
    format for a single parameter is the parameter name, followed by one or
    more spaces, followed by the parameter value, followed by a newline. The
    following parameters are currently recognized:</p><div class="variablelist"><dl><dt><span class="term"><span class="emphasis"><em>logfile_autoremove</em></span></span></dt><dd><p>This flag is ignored unless transactional support is enabled.
          If set to 1, unused Berkeley DB transactional logfiles
          (log.xxxxxxxxxx in the database home directory) are removed on
          startup of <span><b class="command">cnid_dbd</b></span>. This is usually safe if the
          content of the database directory is backed up on a regular basis.
          Default: 0.</p></dd><dt><span class="term"><span class="emphasis"><em>cachesize</em></span></span></dt><dd><p>Determines the size of the Berkeley DB cache in kilobytes.
          Default: 1024. Each <span><b class="command">cnid_dbd</b></span> process grabs that
          much memory on top of its normal memory footprint. It can be used to
          tune database performance. The <span class="emphasis"><em>db_stat</em></span> utility with the <tt class="option">-m</tt>
          option that comes with Berkely DB can help you determine wether you
          need to change this value. The default is pretty conservative so
          that a large percentage of requests should be satisfied from the
          cache directly. If memory is not a bottleneck on your system you
          might want to leave it at that value. The <span class="emphasis"><em>Berkeley DB Tutorial and Reference Guide</em></span> has a
          section <span class="emphasis"><em>Selecting a cache size</em></span> that
          gives more detailed information.</p></dd><dt><span class="term"><span class="emphasis"><em>nosync</em></span></span></dt><dd><p>This flag is ignored unless transactional support is enabled.
          If it is set to 1, transactional changes to the database are not
          synchronously written to disk when the transaction completes. This
          will increase performance considerably at the risk of recent changes
          getting lost in case of a crash. The database will still be
          consistent, though. See <span class="emphasis"><em>Transaction
          Throughput</em></span> in the Berkeley DB Tutorial for more
          information. Default: 0.</p></dd><dt><span class="term"><span class="emphasis"><em>flush_frequency</em></span>, </span><span class="term"><span class="emphasis"><em>flush_interval</em></span></span></dt><dd><p><span class="emphasis"><em>flush_frequency</em></span> (Default: 100)
          and <span class="emphasis"><em>flush_interval</em></span> (Default: 30)
          control how often changes to the database are written to the
          underlying database files if no transactions are used or how often
          the transaction system is checkpointed for transactions. Both of
          these operations are performed if either i) more than <span class="emphasis"><em>flush_frequency</em></span> requests have been received or
          ii) more than <span class="emphasis"><em>flush_interval</em></span> seconds
          have elapsed since the last save/checkpoint. If you use transactions
          with <span class="emphasis"><em>nosync</em></span> set to zero these
          parameters only influence how long recovery takes after a crash,
          there should never be any lost data. If <span class="emphasis"><em>nosync</em></span> is 1, changes might be lost, but only
          since the last checkpoint. Be careful to check your harddisk
          configuration for on disk cache settings. Many IDE disks just cache
          writes as the default behaviour, so even flushing database files to
          disk will not have the desired effect.</p></dd><dt><span class="term"><span class="emphasis"><em>fd_table_size</em></span></span></dt><dd><p>is the maximum number of connections (filedescriptors) that
          can be open for <span class="emphasis"><em>afpd</em></span> client processes
          in <span class="emphasis"><em>cnid_dbd.</em></span> Default: 16. If this
          number is exceeded, one of the existing connections is closed and
          reused. The affected <span class="emphasis"><em>afpd</em></span> process
          will transparently reconnect later, which causes slight overhead. On
          the other hand, setting this parameter too high could affect
          performance in <span><b class="command">cnid_dbd</b></span> since all descriptors
          have to be checked in a <tt class="function">select()</tt> system call,
          or worse, you might exceed the per process limit of open file
          descriptors on your system. It is safe to set the value to 1 on
          volumes where only one <span class="emphasis"><em>afpd</em></span> client
          process is expected to run, e.g. home directories.</p></dd><dt><span class="term"><span class="emphasis"><em>idle_timeout</em></span></span></dt><dd><p>is the number of seconds of inactivity before an idle
          <span><b class="command">cnid_dbd</b></span> exits. Default: 600. Set this to 0 to
          disable the timeout.</p></dd><dt><span class="term"><span class="emphasis"><em>check</em></span></span></dt><dd><p>is a flag value. If set <span><b class="command">cnid_dbd</b></span> will 
          automatically check the database indexes. Default: 0. Set this 
          to 1 to enable checking. </p></dd></dl></div></div><div class="refsect1" lang="en"><a name="id2894375"></a><h2>SEE ALSO</h2><p><a href="cnid_metad.8.html"><span class="citerefentry"><span class="refentrytitle">cnid_metad</span>(8)</span></a>, <a href="afpd.8.html"><span class="citerefentry"><span class="refentrytitle">afpd</span>(8)</span></a></p></div></div><div class="refentry" lang="en"><div class="refentry.separator"><hr></div><a name="cnid_index.1"></a><div class="titlepage"><div></div><div></div></div><div class="refnamediv"><h2>Name</h2><p>cnid_index &#8212; check and repair Netatalk CNID database indexes</p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><div class="cmdsynopsis"><p><tt class="command">cnid_index<a class="indexterm" name="id2894473"></a><a class="indexterm" name="id2894480"></a></tt>   <i class="replaceable"><tt>dbdir</tt></i> </p></div></div><div class="refsect1" lang="en"><a name="id2894504"></a><h2>DESCRIPTION</h2><p><span><b class="command">cnid_index</b></span> is a utility to check CNID databases
    for consistency. If needed, the indexes are repaired. It works for 
    databases created by the cdb and dbd backends.</p><p>Volumes usind the dbd CNID scheme can also be checked automatically, 
    for further information please see the <a href="cnid_dbd.8.html"><span class="citerefentry"><span class="refentrytitle">cnid_dbd</span>(8)</span></a> man page.</p><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Warning</h3><p>When using <span><b class="command">cnid_index</b></span> on cdb handled databases, 
    <span><b class="command">cnid_index</b></span> cannot check if another process (afpd) accesses
    the CNID databases. In this case, you have to manually ensure no other process 
    accesses the database when running <span><b class="command">cnid_index</b></span>.</p></div></div><div class="refsect1" lang="en"><a name="id2894571"></a><h2>SEE ALSO</h2><p><a href="cnid_dbd.8.html"><span class="citerefentry"><span class="refentrytitle">cnid_dbd</span>(8)</span></a>, <a href="afpd.8.html"><span class="citerefentry"><span class="refentrytitle">afpd</span>(8)</span></a></p></div></div><div class="refentry" lang="en"><div class="refentry.separator"><hr></div><a name="cnid_metad.8"></a><div class="titlepage"><div></div><div></div></div><div class="refnamediv"><h2>Name</h2><p>cnid_metad &#8212; start cnid_dbd daemons on request</p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><div class="cmdsynopsis"><p><tt class="command">cnid_metad<a class="indexterm" name="id2894668"></a></tt>  [-d] [ -h    <i class="replaceable"><tt>hostname</tt></i> ] [ -p    <i class="replaceable"><tt>port</tt></i> ] [ -u    <i class="replaceable"><tt>user</tt></i> ] [ -g    <i class="replaceable"><tt>group</tt></i> ] [ -s    <i class="replaceable"><tt>cnid_dbdpathname</tt></i> ]</p></div></div><div class="refsect1" lang="en"><a name="id2894815"></a><h2>DESCRIPTION</h2><p><span><b class="command">cnid_metad</b></span> waits for requests from <span class="emphasis"><em>afpd</em></span> to start up instances of the <span class="emphasis"><em>cnid_dbd</em></span>
    daemon. It keeps track of the status of a <span class="emphasis"><em>cnid_dbd</em></span>
    instance once started and will restart it if necessary.
    <span><b class="command">cnid_metad</b></span> is normally started at boot time from
    <tt class="filename">/etc/rc</tt> or equivalent and runs until shutdown.
    <span class="emphasis"><em>afpd</em></span> needs to be configured with the
    <tt class="option">-cnidserver</tt> option in <span class="emphasis"><em>afpd.conf</em></span>
    in order to access <span class="emphasis"><em>cnid_metad.</em></span> It is
    possible to run more than one instance of <span><b class="command">cnid_metad</b></span> on
    the same machine if different values for the interface and/or port are
    specified with the <tt class="option">-h</tt> and <tt class="option">-p</tt> options.</p></div><div class="refsect1" lang="en"><a name="id2894913"></a><h2>OPTIONS</h2><div class="variablelist"><dl><dt><span class="term"><tt class="option">-d</tt></span></dt><dd><p><span class="emphasis"><em>cnid_metad will remain in the foreground
          and</em></span> will also leave the standard input, standard output
          and standard error file descriptors open. Useful for debugging.</p></dd><dt><span class="term"><tt class="option">-h</tt><i class="replaceable"><tt> hostname</tt></i></span></dt><dd><p>Use <span class="emphasis"><em>hostname</em></span> as the network
          interface for requests as opposed to the default <span class="emphasis"><em>localhost
          </em></span>.</p></dd><dt><span class="term"><tt class="option">-p</tt><i class="replaceable"><tt> port</tt></i></span></dt><dd><p>Use <span class="emphasis"><em>port</em></span> as the port number for
          reqests. Default is 4700.</p></dd><dt><span class="term"><tt class="option">-u</tt><i class="replaceable"><tt> user</tt></i></span></dt><dd><p>Switch to the userid of <span class="emphasis"><em>user</em></span>
          before serving requests. This userid will be inherited by all
          <span class="emphasis"><em>cnid_dbd</em></span> daemon processes started.</p></dd><dt><span class="term"><tt class="option">-u</tt><i class="replaceable"><tt> group</tt></i></span></dt><dd><p>Switch to the groupid of <span class="emphasis"><em>group</em></span>
          before serving requests. This groupid will be inherited by all
          <span class="emphasis"><em>cnid_dbd</em></span> daemon processes started.
          Both <span class="emphasis"><em>user</em></span> and <span class="emphasis"><em>group</em></span>
          must be specified as strings.</p></dd><dt><span class="term"><tt class="option">-s</tt><i class="replaceable"><tt> cnid_dbd pathname</tt></i></span></dt><dd><p>Use <span class="emphasis"><em>cnid_dbd pathname</em></span> as the
          pathname of the executeable of the <span class="emphasis"><em>cnid_dbd</em></span>
          daemon. The default is <span class="emphasis"><em>/usr/sbin/cnid_dbd.</em></span></p></dd></dl></div></div><div class="refsect1" lang="en"><a name="id2895150"></a><h2>CAVEATS</h2><p>The number of <span class="emphasis"><em>cnid_dbd</em></span> subprocecesses
    is currently limited to 128. This restriction will be lifted in the
    future.</p><p><span><b class="command">cnid_metad</b></span> does not block or catch any signals
    apart from SIGPIPE. It will therefore exit on most signals received. This
    will also cause all instances of <span class="emphasis"><em>cnid_dbd's</em></span>
    started by that <span><b class="command">cnid_metad</b></span> to exit gracefully. Since
    state about and IPC access to the subprocesses is only maintained in
    memory by <span><b class="command">cnid_metad</b></span> this is desired behaviour. As soon
    as <span><b class="command">cnid_metad</b></span> is restarted <span class="emphasis"><em>afpd</em></span>
    processes will transparently reconnect.</p></div><div class="refsect1" lang="en"><a name="id2895220"></a><h2>SEE ALSO</h2><p><a href="cnid_dbd.8.html"><span class="citerefentry"><span class="refentrytitle">cnid_dbd</span>(8)</span></a>,
    <a href="afpd.8.html"><span class="citerefentry"><span class="refentrytitle">afpd</span>(8)</span></a></p></div></div><div class="refentry" lang="en"><div class="refentry.separator"><hr></div><a name="getzones.1"></a><div class="titlepage"><div></div><div></div></div><div class="refnamediv"><h2>Name</h2><p>getzones &#8212; list AppleTalk zone names</p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><div class="cmdsynopsis"><p><tt class="command">getzones<a class="indexterm" name="id2895310"></a></tt>  [ -m  |   -l ] [<i class="replaceable"><tt>address</tt></i>]</p></div></div><div class="refsect1" lang="en"><a name="id2895359"></a><h2>DESCRIPTION</h2><p><span class="emphasis"><em>Getzones</em></span> is used to obtain a list of
    AppleTalk zone names using the Zone Information Protocol (ZIP). It sends a
    GetZoneList request to an AppleTalk router. By default, it sends the
    request to the locally running <a href="atalkd.8.html"><span class="citerefentry"><span class="refentrytitle">atalkd</span>(8)</span></a>.</p></div><div class="refsect1" lang="en"><a name="id2895390"></a><h2>OPTIONS</h2><div class="variablelist"><dl><dt><span class="term"><tt class="option">-m</tt></span></dt><dd><p>List the name of the local zone only; this is accomplished by
          sending a ZIP GetMyZone request.</p></dd><dt><span class="term"><tt class="option">-l</tt></span></dt><dd><p>List the local zones; this is accomplished by sending a
          GetLocalZones request.</p></dd><dt><span class="term"><span class="emphasis"><em>address</em></span></span></dt><dd><p>Contact the AppleTalk router at <span class="emphasis"><em>address.</em></span>
          <span class="emphasis"><em>address</em></span> is parsed by
          <a href="atalk_aton.3.html"><span class="citerefentry"><span class="refentrytitle">atalk_aton</span>(3)</span></a>.</p></dd></dl></div></div><div class="refsect1" lang="en"><a name="id2895488"></a><h2>SEE ALSO</h2><p><a href="atalk_aton.3.html"><span class="citerefentry"><span class="refentrytitle">atalk_aton</span>(3)</span></a>,
    <a href="atalkd.8.html"><span class="citerefentry"><span class="refentrytitle">atalkd</span>(8)</span></a>.</p></div></div><div class="refentry" lang="en"><div class="refentry.separator"><hr></div><a name="megatron.1"></a><div class="titlepage"><div></div><div></div></div><div class="refnamediv"><a name="name"></a><h2>Name</h2><p>megatron, unhex, unbin, unsingle, hqx2bin, single2bin, macbinary &#8212; Macintosh file format transformer</p></div><div class="refsynopsisdiv"><a name="synopsis"></a><h2>Synopsis</h2><div class="cmdsynopsis"><p><tt class="command">megatron<a class="indexterm" name="id2895610"></a></tt>  [<i class="replaceable"><tt>sourcefile</tt></i>...]<br><br><tt class="command">unbin<a class="indexterm" name="id2895638"></a></tt>  [<i class="replaceable"><tt>sourcefile</tt></i>...]<br><br><tt class="command">unhex<a class="indexterm" name="id2895665"></a></tt>  [<i class="replaceable"><tt>sourcefile</tt></i>...]<br><br><tt class="command">unsingle<a class="indexterm" name="id2895692"></a></tt>  [<i class="replaceable"><tt>sourcefile</tt></i>...]<br><br><tt class="command">hqx2bin<a class="indexterm" name="id2895720"></a></tt>  [<i class="replaceable"><tt>sourcefile</tt></i>...]<br><br><tt class="command">single2bin<a class="indexterm" name="id2895747"></a></tt>  [<i class="replaceable"><tt>sourcefile</tt></i>...]<br><br><tt class="command">macbinary<a class="indexterm" name="id2895774"></a></tt>  [<i class="replaceable"><tt>sourcefile</tt></i>...]</p></div></div><div class="refsect1" lang="en"><a name="description"></a><h2>DESCRIPTION</h2><p><span><b class="command">megatron</b></span> is used to transform files from BinHex,
    MacBinary, AppleSingle, or <span class="bold"><b>netatalk</b></span> style
    AppleDouble formats into MacBinary or <span class="emphasis"><em>netatalk</em></span>
    style AppleDouble formats. The <span class="emphasis"><em>netatalk</em></span>
    style AppleDouble format is the file format used by <span class="emphasis"><em>afpd,</em></span>
    the <span class="emphasis"><em>netatalk</em></span> Apple Filing Protocol
    (AppleShare) server. BinHex, MacBinary, and AppleSingle are commonly used
    formats for transferring Macintosh files between machines via email or
    file transfer protocols. <span><b class="command">megatron</b></span> uses its name to
    determine what type of tranformation is being asked of it.</p><p>If <span><b class="command">megatron</b></span> is called as <span><b class="command">unhex</b></span>
    , <span><b class="command">unbin</b></span> or <span><b class="command">unsingle</b></span>, it tries to
    convert file(s) from BinHex, MacBinary, or AppleSingle into AppleDouble
    format. BinHex is the format most often used to send Macintosh files by
    e-mail. Usually these files have an extension of ".hqx". MacBinary
    is the format most often used by terminal emulators "on the fly"
    when transferring Macintosh files in binary mode. MacBinary files often
    have an extension of ".bin". Some Macintosh LAN-based email
    packages use uuencoded AppleSingle format to "attach" or
    "enclose" files in email. AppleSingle files don't have a
    standard filename extension.</p><p>If <span><b class="command">megatron</b></span> is called as <span><b class="command">hqx2bin</b></span>,
    <span><b class="command">single2bin</b></span>, or <span><b class="command">macbinary</b></span>, it will
    try to convert the file(s) from BinHex, AppleSingle, or AppleDouble into
    MacBinary. This last translation may be useful in moving Macintosh files
    from your <span><b class="command">afpd</b></span> server to some other machine when you
    can't copy them from the server using a Macintosh for some reason.</p><p>If <span><b class="command">megatron</b></span> is called with any other name, it
    uses the default translation, namely <span><b class="command">unhex</b></span>.</p><p>If no source file is given, or if <span class="emphasis"><em>sourcefile</em></span>
    is `<span class="bold"><b>-</b></span>', and if the
    conversion is from a BinHex or MacBinary file, <span><b class="command">megatron</b></span>
    will read from standard input.</p><p>The filename used to store any output file is the filename that is
    encoded in the source file. MacBinary files are created with a
    ".bin" extension. In the case of conflicts, the old file is
    overwritten!</p></div><div class="refsect1" lang="en"><a name="see_also"></a><h2>SEE ALSO</h2><p><a href="afpd.8.html"><span class="citerefentry"><span class="refentrytitle">afpd</span>(8)</span></a></p></div></div><div class="refentry" lang="en"><div class="refentry.separator"><hr></div><a name="nbp.1"></a><div class="titlepage"><div></div><div></div></div><div class="refnamediv"><h2>Name</h2><p>nbplkup, nbprgstr, nbpunrgstr &#8212; access NBP database</p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><div class="cmdsynopsis"><p><tt class="command">nbplkup<a class="indexterm" name="id2896103"></a><a class="indexterm" name="id2896110"></a> </tt>  [-r <i class="replaceable"><tt>maxresponses</tt></i>] [-A <i class="replaceable"><tt>address</tt></i>] [-m <i class="replaceable"><tt>maccodepage</tt></i>]  <i class="replaceable"><tt>nbpname</tt></i> </p></div><div class="cmdsynopsis"><p><tt class="command">nbprgstr<a class="indexterm" name="id2896180"></a> </tt>  [-A <i class="replaceable"><tt>address</tt></i>] [-p <i class="replaceable"><tt>port</tt></i>] [-m <i class="replaceable"><tt>maccodepage</tt></i>]  <i class="replaceable"><tt>nbpname</tt></i> </p></div><div class="cmdsynopsis"><p><tt class="command">nbpunrgstr<a class="indexterm" name="id2896249"></a> </tt>  [-A <i class="replaceable"><tt>address</tt></i>] [-m <i class="replaceable"><tt>maccodepage</tt></i>]  <i class="replaceable"><tt>nbpname</tt></i> </p></div></div><div class="refsect1" lang="en"><a name="id2896295"></a><h2>Description</h2><p><span><b class="command">nbprgstr</b></span> registers <i class="replaceable"><tt>nbpname</tt></i>
    with <a href="atalkd.8.html"><span class="citerefentry"><span class="refentrytitle">atalkd</span>(8)</span></a>,
    at the given <i class="replaceable"><tt>port</tt></i>. <span><b class="command">nbpunrgstr</b></span>
    informs <span class="emphasis"><em>atalkd</em></span> that
    <i class="replaceable"><tt>nbpname</tt></i> is no longer to be advertised.</p><p><span><b class="command">nbplkup</b></span> displays up to
    <i class="replaceable"><tt>maxresponses</tt></i> (default 1000) entities registered
    on the AppleTalk internet. <span class="emphasis"><em><i class="replaceable"><tt>nbpname</tt></i></em></span>
    is parsed by <a href="nbp_name.3.html"><span class="citerefentry"><span class="refentrytitle">nbp_name</span>(3)</span></a>.
    An `<span class="emphasis"><em>=</em></span>' for the <span class="emphasis"><em>object</em></span>
    or <span class="emphasis"><em>type</em></span> matches anything, and an `<span class="emphasis"><em>*</em></span>' for <span class="emphasis"><em>zone</em></span> means
    the local zone. The default values are taken from the <span class="emphasis"><em>NBPLKUP</em></span>
    environment variable, parsed as an <i class="replaceable"><tt>nbpname</tt></i>.</p></div><div class="refsect1" lang="en"><a name="id2896426"></a><h2>Environment Variables</h2><div class="variablelist"><dl><dt><span class="term">NBPLKUP</span></dt><dd><p>default nbpname for nbplkup</p></dd><dt><span class="term">ATALK_MAC_CHARSET</span></dt><dd><p>the codepage used by the clients on the Appletalk network</p></dd><dt><span class="term">ATALK_UNIX_CHARSET</span></dt><dd><p>the codepage used to display extended characters on this
          shell.</p></dd></dl></div></div><div class="refsect1" lang="en"><a name="id2896494"></a><h2>Example</h2><p>Find all devices of type <span class="emphasis"><em>LaserWriter</em></span>
    in the local zone.</p><pre class="screen"><tt class="prompt">example%</tt> <b class="userinput"><tt>nbplkup :LaserWriter</tt></b>
<tt class="computeroutput"> <tt class="computeroutput">              Petoskey:LaserWriter        7942.129:218
             Gloucester:LaserWriter        8200.188:186
                 Rahway:LaserWriter        7942.2:138
             517 Center:LaserWriter        7942.2:132
                  ionia:LaserWriter        7942.2:136
     Evil DEC from Hell:LaserWriter        7942.2:130
              Hamtramck:LaserWriter        7942.2:134
         Iron Mountain :LaserWriter        7942.128:250</tt></tt>
<tt class="prompt">example%</tt>
</pre></div><div class="refsect1" lang="en"><a name="id2896561"></a><h2>See also</h2><p><a href="nbp_name.3.html"><span class="citerefentry"><span class="refentrytitle">nbp_name</span>(3)</span></a>,
    <a href="atalkd.8.html"><span class="citerefentry"><span class="refentrytitle">atalkd</span>(8)</span></a>.</p></div></div><div class="refentry" lang="en"><div class="refentry.separator"><hr></div><a name="nbp_name.3"></a><div class="titlepage"><div></div><div></div></div><div class="refnamediv"><h2>Name</h2><p>nbp_name &#8212; NBP name parsing<a class="indexterm" name="id2896634"></a></p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><div class="funcsynopsis"><table border="0" summary="Function synopsis" cellspacing="0" cellpadding="0" style="padding-bottom: 1em"><tr><td><code class="funcdef">int <b class="fsfunc">nbp_name</b>(</code></td><td><var class="pdparam">name</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">obj</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">type</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">zone</var><code>)</code>;</td><td> </td></tr></table><table border="0" summary="Function argument synopsis" cellspacing="0" cellpadding="0"><tr><td>char * </td><td><var class="pdparam">name</var>;</td></tr><tr><td>char ** </td><td><var class="pdparam">obj</var>;</td></tr><tr><td>char ** </td><td><var class="pdparam">type</var>;</td></tr><tr><td>char ** </td><td><var class="pdparam">zone</var>;</td></tr></table></div></div><div class="refsect1" lang="en"><a name="id2896704"></a><h2>DESCRIPTION</h2><p><tt class="function">nbp_name()</tt> parses user supplied names into
    their component object, type, and zone. <span class="emphasis"><em>obj</em></span>,
    <span class="emphasis"><em>type</em></span>, and <tt class="varname">zone</tt>
    should be passed by reference, and should point to the caller's
    default values. <tt class="function">nbp_name()</tt> will change the pointers
    to the parsed-out values. <span class="emphasis"><em>name</em></span> is of the
    form <span class="emphasis"><em>object</em></span><span class="emphasis"><em>:</em></span><span class="emphasis"><em></em></span><span class="emphasis"><em>type</em></span><span class="emphasis"><em>@</em></span><span class="emphasis"><em></em></span><tt class="varname">zone</tt>, where each of <span class="emphasis"><em>object</em></span>,
    <span class="emphasis"><em>:</em></span><span class="emphasis"><em>type</em></span><span class="emphasis"><em>,</em></span> and <span class="emphasis"><em>@</em></span><tt class="varname">zone</tt> replace <span class="emphasis"><em>obj</em></span>,
    <span class="emphasis"><em>type</em></span>, and <span class="emphasis"><em>zone,</em></span>
    respectively. <span class="emphasis"><em>type</em></span> must be proceeded by `<span class="emphasis"><em>:</em></span>', and <tt class="varname">zone</tt>
    must be preceded by `<span class="emphasis"><em>@</em></span>'.</p></div><div class="refsect1" lang="en"><a name="id2896880"></a><h2>EXAMPLE</h2><p>The argument of <a href="afpd.8.html"><span class="citerefentry"><span class="refentrytitle">afpd</span>(8)</span></a>'s
    <tt class="option">-n</tt> option is parsed with <tt class="function">nbp_name()</tt>.
    The default value of <span class="emphasis"><em>obj</em></span> is the first
    component of the machine's hostname (as returned by
    <a href="gethostbyname.3.html"><span class="citerefentry"><span class="refentrytitle">gethostbyname</span>(3)</span></a>).
    The default value of <span class="emphasis"><em>type</em></span> is
    ``AFPServer'', and of <tt class="varname">zone</tt> is
    ``*'', the default zone. To cause <span class="emphasis"><em>afpd</em></span>
    to register itself in some zone other than the default, one would invoke
    it as</p><div class="literallayout"><p>afpd -n @some-other-zone<br>
</p></div><p><span class="emphasis"><em>obj</em></span> and <span class="emphasis"><em>type</em></span>
    would retain their default values.</p></div><div class="refsect1" lang="en"><a name="id2896982"></a><h2>BUGS</h2><p><span class="emphasis"><em>obj</em></span>, <span class="emphasis"><em>type</em></span>,
    and <tt class="varname">zone</tt> return pointers into static
    area which may be over-written on each call.</p></div></div><div class="refentry" lang="en"><div class="refentry.separator"><hr></div><a name="netatalk.conf.5"></a><div class="titlepage"><div></div><div></div></div><div class="refnamediv"><h2>Name</h2><p>netatalk.conf &#8212; Configuration file used by netatalk(8) to determine its
    general configuration<a class="indexterm" name="id2897067"></a><a class="indexterm" name="id2897074"></a>
<a class="indexterm" name="id2897082"></a>
<a class="indexterm" name="id2897091"></a>
<a class="indexterm" name="id2897099"></a>
<a class="indexterm" name="id2897107"></a>
<a class="indexterm" name="id2897116"></a>
<a class="indexterm" name="id2897124"></a>
<a class="indexterm" name="id2897133"></a>
<a class="indexterm" name="id2897141"></a>
<a class="indexterm" name="id2897149"></a>
<a class="indexterm" name="id2897158"></a>
<a class="indexterm" name="id2897166"></a><a class="indexterm" name="id2897173"></a></p></div><div class="refsect1" lang="en"><a name="id2897188"></a><h2>DESCRIPTION</h2><p><span class="emphasis"><em>/etc/netatalk/netatalk.conf</em></span> is the
    configuration file used by afpd to determine what portions of the file
    system will be shared via Appletalk, as well as their behaviors.</p><p>Any line not prefixed with <span class="emphasis"><em>#</em></span> is
    interpreted. The configuration lines are composed like:</p><p><span class="emphasis"><em>option</em></span> <span class="emphasis"><em>=</em></span>
    <span class="emphasis"><em>value</em></span></p><p>The possible options and their meanings are:</p><div class="variablelist"><dl><dt><span class="term"><span class="emphasis"><em>AFPD_GUEST</em></span></span></dt><dd><p>Sets the id of the guest user to a local user on the system.</p></dd><dt><span class="term"><span class="emphasis"><em>AFPD_MAX_CLIENTS</em></span></span></dt><dd><p>Sets the maximum number of clients that can simultaneously
          connect to the server.</p></dd><dt><span class="term"><span class="emphasis"><em>AFPD_RUN</em></span></span></dt><dd><p>Enables the afpd daemon if set to "yes". This should
          be enabled if you are planning on using netatalk as a file server.</p></dd><dt><span class="term"><span class="emphasis"><em>AFPD_UAM_LIST</em></span></span></dt><dd><p>Sets the default UAMs for afpd (and papd, if printer
          authentication is compiled in) to use.</p><p><span class="emphasis"><em>Example:</em></span> <span class="emphasis"><em>AFPD_UAMLIST</em></span>=<span class="emphasis"><em>"-U uams_guest.so,uams_randnum.so"</em></span></p></dd><dt><span class="term"><span class="emphasis"><em>CNID_METAD_RUN</em></span></span></dt><dd><p>Enables the cnid_metad daemon if set to "yes". This
          should be enabled if you are going to use the dbd CNID backend.</p></dd><dt><span class="term"><span class="emphasis"><em>ATALK_BGROUND</em></span></span></dt><dd><p>"yes" will set netatalk to initialize in the
          background, and "no" will cause normal initialization.</p></dd><dt><span class="term"><span class="emphasis"><em>ATALK_NAME</em></span></span></dt><dd><p>Sets the machines' Appletalk name.</p></dd><dt><span class="term"><span class="emphasis"><em>ATALK_ZONE</em></span></span></dt><dd><p>Sets the machines' Appletalk zone.</p></dd><dt><span class="term"><span class="emphasis"><em>ATALKD_RUN</em></span></span></dt><dd><p>Enables the atalkd daemon if set to "yes". This should
          be enabled if you are planning on providing Appletalk services.</p></dd><dt><span class="term"><span class="emphasis"><em>PAPD_RUN</em></span></span></dt><dd><p>Enables the papd daemon if set to "yes". This should
          be enabled if you are planning on using netatalk as a print server.</p></dd><dt><span class="term"><span class="emphasis"><em>ATALK_MAC_CHARSET</em></span></span></dt><dd><p>Set the Mac client codepage, used by atalkd and papd to
          convert extended characters from the Unix to the Mac codepage.</p></dd><dt><span class="term"><span class="emphasis"><em>ATALK_UNIX_CHARSET</em></span></span></dt><dd><p>Set the Unix codepage, used by atalkd and papd to convert
          extended characters from the Unix to the Mac codepage. Has to match
          the codepage of the configuration files.</p></dd></dl></div></div><div class="refsect1" lang="en"><a name="id2897551"></a><h2>SEE ALSO</h2><p><a href="atalkd.8.html"><span class="citerefentry"><span class="refentrytitle">atalkd</span>(8)</span></a>,
    <a href="atalkd.conf.5.html"><span class="citerefentry"><span class="refentrytitle">atalkd.conf</span>(5)</span></a></p></div></div><div class="refentry" lang="en"><div class="refentry.separator"><hr></div><a name="netatalkconfig.1"></a><div class="titlepage"><div></div><div></div></div><div class="refnamediv"><h2>Name</h2><p>netatalk-config &#8212; script to get information about the installed version of
    netatalk</p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><div class="cmdsynopsis"><p><tt class="command">netatalk-config<a class="indexterm" name="id2897649"></a></tt>  [ --prefix   [<i class="replaceable"><tt>=DIR</tt></i>]] [ --exec_prefix   [<i class="replaceable"><tt>=DIR</tt></i>]] [--help] [--version] [--libs] [--libs-dirs] [--libs-names] [--cflags] [--macros]</p></div></div><div class="refsect1" lang="en"><a name="id2897776"></a><h2>DESCRIPTION</h2><p><span><b class="command">netatalk-config</b></span> is a tool that is used to
    determine the compiler and linker flags that should be used
    to compile and link programs that use the <span class="emphasis"><em>netatalk</em></span>
    run-time libraries.</p></div><div class="refsect1" lang="en"><a name="id2897803"></a><h2>OPTIONS</h2><p><span><b class="command">netatalk-config</b></span> accepts the following options:</p><div class="variablelist"><dl><dt><span class="term"><tt class="option">--help</tt></span></dt><dd><p>Print a short help for this command and exit.</p></dd><dt><span class="term"><tt class="option">--version</tt></span></dt><dd><p>Print the currently installed version of <span class="emphasis"><em>netatalk</em></span>
          on the standard output.</p></dd><dt><span class="term"><tt class="option">--libs</tt></span></dt><dd><p>Print the linker flags that are necessary to link against the
          <span class="emphasis"><em>netatalk</em></span> run-time libraries.</p></dd><dt><span class="term"><tt class="option">--libs-dirs</tt></span></dt><dd><p>Print only the -l/-R part of --libs.</p></dd><dt><span class="term"><tt class="option">--libs-names</tt></span></dt><dd><p>Print only the -l part of --libs.</p></dd><dt><span class="term"><tt class="option">--cflags</tt></span></dt><dd><p>Print the compiler flags that are necessary to compile a
          program linked against the <span class="emphasis"><em>netatalk</em></span>
          run-time libraries.</p></dd><dt><span class="term"><tt class="option">--macros</tt></span></dt><dd><p>Print the <span class="emphasis"><em>netatalk</em></span> m4
          directory.</p></dd><dt><span class="term"><tt class="option">--prefix=PREFIX</tt></span></dt><dd><p>If specified, use PREFIX instead of the installation prefix
          that <span class="emphasis"><em>netatalk</em></span> was built with when
          computing the output for the --cflags and --libs options. This
          option is also used for the exec prefix if --exec-prefix was not
          specified. This option must be specified before any --libs or
          --cflags options.</p></dd><dt><span class="term"><tt class="option">--exec\_prefix=PREFIX</tt></span></dt><dd><p>If specified, use PREFIX instead of the installation exec
          prefix that <span class="emphasis"><em>netatalk</em></span> was built with
          when computing the output for the --cflags and --libs options. This
          option must be specified before any --libs or --cflags options.</p></dd></dl></div></div><div class="refsect1" lang="en"><a name="id2898052"></a><h2>COPYRIGHT</h2><p>Copyright © 1998 Owen Taylor</p><p>Permission to use, copy, modify, and distribute this software and
    its documentation for any purpose and without fee is hereby granted,
    provided that the above copyright notice appear in all copies and that
    both that copyright notice and this permission notice appear in supporting
    documentation.</p><p>Man page adapted for <span><b class="command">netatalk-config</b></span> by Sebastian
    Rittau in 2001.</p></div></div><div class="refentry" lang="en"><div class="refentry.separator"><hr></div><a name="pap.1"></a><div class="titlepage"><div></div><div></div></div><div class="refnamediv"><h2>Name</h2><p>pap &#8212; client interface to remote printers using Printer Access
    Protocol</p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><div class="cmdsynopsis"><p><tt class="command">pap<a class="indexterm" name="id2898150"></a></tt>  [ -A    <i class="replaceable"><tt>address</tt></i> ] [-c] [-d] [-e] [-E] [ -p    <i class="replaceable"><tt>nbpname</tt></i> ] [ -s    <i class="replaceable"><tt>statusfile</tt></i> ] [-w] [-W] [<i class="replaceable"><tt>FILES</tt></i>]</p></div></div><div class="refsect1" lang="en"><a name="id2898303"></a><h2>DESCRIPTION</h2><p><span><b class="command">pap</b></span> is used to connect and send files to an
    AppleTalk connected printer using the Apple Printer Access Protocol (PAP).
    When <span><b class="command">pap</b></span> starts execution, it tries to open a session
    with the printer using PAP, and then downloads the <span class="emphasis"><em>files</em></span>
    to the printer.</p><p>If no <span class="emphasis"><em>files</em></span> are given on the command
    line, <span><b class="command">pap</b></span> begins reading from standard input.</p><p>If no printer is specified on the command line, <span><b class="command">pap</b></span>
    looks for a file called <span class="markup">.paprc</span> in the current working
    directory and reads it to obtain the <span class="emphasis"><em>nbpname</em></span>
    of a printer. Blank lines and lines that begin with a `<span class="emphasis"><em>#</em></span>'
    are ignored. <span class="emphasis"><em>type</em></span> and <span class="emphasis"><em>zone</em></span>
    default to <span class="emphasis"><em>LaserWriter</em></span> and the zone of the
    local host, respectively.</p><p>Note that <span><b class="command">pap</b></span> is designed to be useful as a
    communication filter for sending <a href="lpd.8.html"><span class="citerefentry"><span class="refentrytitle">lpd</span>(8)</span></a>
    spooled print jobs to AppleTalk connected printers. See
    <a href="psf.8.html"><span class="citerefentry"><span class="refentrytitle">psf</span>(8)</span></a>
    for hints on how to use it this way.</p></div><div class="refsect1" lang="en"><a name="id2898442"></a><h2>OPTIONS</h2><div class="variablelist"><dl><dt><span class="term"><tt class="option">-A </tt><i class="replaceable"><tt>address</tt></i></span></dt><dd><p>Connect to the printer with Appletalk address <span class="emphasis"><em>address</em></span> and do not consult the
          <span class="markup">.paprc</span> file to find a printer name. See
          <a href="atalk_aton.3.html"><span class="citerefentry"><span class="refentrytitle">atalk_aton</span>(3)</span></a>
          for the syntax of <span class="emphasis"><em>address</em></span>.</p></dd><dt><span class="term"><tt class="option">-c</tt></span></dt><dd><p>Take cuts. The PAP protocol specified a simple queuing
          procedure, such that the clients tell the printer how long they have
          been waiting to print. This option causes <span><b class="command">pap</b></span> to
          lie about how long it has been waiting.</p></dd><dt><span class="term"><tt class="option">-d</tt></span></dt><dd><p>Enable debug output.</p></dd><dt><span class="term"><tt class="option">-e</tt></span></dt><dd><p>Send any message from the printer to stderr instead of stdout.
          <a href="psf.8.html"><span class="citerefentry"><span class="refentrytitle">psf</span>(8)</span></a>
          invokes <span><b class="command">pap</b></span> with this option.</p></dd><dt><span class="term"><tt class="option">-E</tt></span></dt><dd><p>Don't wait for EOF from the printer. This option is useful
          for printers which don't implement PAP correctly. In a correct
          implementation, the client side should wait for the printer to
          return EOF before closing the connection. Some clients don't
          wait, and hence some printers have related bugs in their
          implementation.</p></dd><dt><span class="term"><tt class="option">-p</tt> <i class="replaceable"><tt>nbpname</tt></i></span></dt><dd><p>Connect to the printer named <span class="emphasis"><em>nbpname</em></span>
          and do not consult the <span class="markup">.paprc</span> file to find a
          printer name. See <a href="nbp_name.3.html"><span class="citerefentry"><span class="refentrytitle">nbp_name</span>(3)</span></a>
          for the syntax of <span class="emphasis"><em>nbpname</em></span>.</p></dd><dt><span class="term"><tt class="option">-s</tt> <i class="replaceable"><tt>statusfile</tt></i></span></dt><dd><p>Update the file called <span class="emphasis"><em>statusfile</em></span>
          to contain the most recent status message from the printer.
          <span><b class="command">pap</b></span> gets the status from the printer when it is
          waiting for the printer to process input. The <span class="emphasis"><em>statusfile</em></span>
          will contain a single line terminated with a newline. This is useful
          when <span><b class="command">pap</b></span> is invoked by
          <a href="psf.8.html"><span class="citerefentry"><span class="refentrytitle">psf</span>(8)</span></a>
          within <span class="emphasis"><em>lpd</em></span>'s spool directory.</p></dd><dt><span class="term"><tt class="option">-w</tt></span></dt><dd><p>Wait for the printer status to contain the word
          "waiting" before sending the job. This is to defeat
          printer-side spool available on HP IV and V printers.</p></dd><dt><span class="term"><tt class="option">-W</tt></span></dt><dd><p>Wait for the printer status to contain the word "idle"
          before sending the job. This is to defeat printer-side spool
          available on HP IV and V printers.</p></dd></dl></div></div><div class="refsect1" lang="en"><a name="id2898780"></a><h2>FILES</h2><div class="variablelist"><dl><dt><span class="term"><span class="markup">.paprc</span></span></dt><dd><p>file read to obtain printer name if not specified on command
          line</p></dd></dl></div></div><div class="refsect1" lang="en"><a name="id2898815"></a><h2>SEE ALSO</h2><p><a href="nbp_name.3.html"><span class="citerefentry"><span class="refentrytitle">nbp_name</span>(3)</span></a>,
    <a href="atalk_aton.3.html"><span class="citerefentry"><span class="refentrytitle">atalk_aton</span>(3)</span></a>,
    <a href="lpd.8.html"><span class="citerefentry"><span class="refentrytitle">lpd</span>(8)</span></a>,
    <a href="psf.8.html"><span class="citerefentry"><span class="refentrytitle">psf</span>(8)</span></a>.</p></div></div><div class="refentry" lang="en"><div class="refentry.separator"><hr></div><a name="papd.8"></a><div class="titlepage"><div></div><div></div></div><div class="refnamediv"><h2>Name</h2><p>papd &#8212; AppleTalk print server daemon</p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><div class="cmdsynopsis"><p><tt class="command">papd<a class="indexterm" name="id2898922"></a><a class="indexterm" name="id2898929"></a></tt>  [-d] [-f configfile] [-p printcap]</p></div></div><div class="refsect1" lang="en"><a name="id2898975"></a><h2>Description</h2><p><span><b class="command">papd</b></span> is the AppleTalk printer daemon. This daemon
    accepts print jobs from AppleTalk clients (typically Macintosh computers)
    using the Printer Access Protocol (PAP). When used with System V printing
    systems, <span><b class="command">papd</b></span> spools jobs directly into an
    <a href="lpd.8.html"><span class="citerefentry"><span class="refentrytitle">lpd</span>(8)</span></a> spool directory and wakes up <span><b class="command">lpd</b></span>
    after accepting a job from the network to have it re-examine the
    appropriate spool directory. The actual printing and spooling is handled
    entirely by <span><b class="command">lpd</b></span>.</p><p><span><b class="command">papd</b></span> can also pipe the print job to an external
    program for processing, and this is the preferred method on systems not
    using CUPS to avoid compatibility problems with all the flavours of
    <span><b class="command">lpd</b></span> in use.</p><p>As of version 2.0, CUPS is also supported. Simply using <span class="emphasis"><em>cupsautoadd</em></span> as first papd.conf entry will share all
    CUPS printers automagically using the PPD files configured in CUPS. It ist
    still possible to overwrite these defaults by individually define printer
    shares. See <a href="papd.conf.5.html"><span class="citerefentry"><span class="refentrytitle">papd.conf</span>(5)</span></a> for details.</p><p><span><b class="command">papd</b></span> is typically started at boot time, out of
    system init scripts. It first reads from its configuration file,
    <tt class="filename">/etc/netatalk/papd.conf</tt>. The file is in the same format as
    <tt class="filename">/etc/printcap</tt>. See <a href="printcap.5.html"><span class="citerefentry"><span class="refentrytitle">printcap</span>(5)</span></a> for details. The name of the entry is registered with
    NBP.</p><p>The following options are supported: </p><div class="informaltable"><table border="0"><colgroup><col align="center"><col><col><col></colgroup><thead><tr><th align="center">Name</th><th align="center">Type</th><th align="center">Default</th><th align="char">Description</th></tr></thead><tbody><tr><td align="center">pd</td><td>str</td><td>'.ppd'</td><td>Pathname to PPD file</td></tr><tr><td align="center">pr</td><td>str</td><td>'lp'</td><td>LPD or CUPS printer name (or pipe to a print
              command)</td></tr><tr><td align="center">op</td><td>str</td><td>'operator'</td><td>Operator name for LPD spooling</td></tr><tr><td align="center">au</td><td>bool</td><td>false</td><td>Whether to do authenticated printing or not</td></tr><tr><td align="center">ca</td><td>str</td><td>NULL</td><td>Pathname used for CAP-style authentification</td></tr><tr><td align="center">sp</td><td>bool</td><td>false</td><td>PSSP-style authetication</td></tr><tr><td align="center">am</td><td>str</td><td>NULL</td><td>UAMS to use for authentication</td></tr><tr><td align="center">pa</td><td>str</td><td>NULL</td><td>Printer's AppleTalk address</td></tr><tr><td align="center">co</td><td>str</td><td>NULL</td><td>CUPS options as supplied to the <a href="lp.1.html"><span class="citerefentry"><span class="refentrytitle">lp</span>(1)</span></a> command with "-o"</td></tr><tr><td align="center">fo</td><td>bool</td><td>false</td><td>adjust lineending for foomatic-rip</td></tr></tbody></table></div><p> If no configuration file is given, the hostname of the
    machine is used as the NBP name and all options take their default
    value.</p></div><div class="refsect1" lang="en"><a name="id2899427"></a><h2>Options</h2><div class="variablelist"><dl><dt><span class="term">-d</span></dt><dd><p>Do not fork or disassociate from the terminal. Write some
          debugging information to stderr.</p></dd><dt><span class="term">-f <i class="replaceable"><tt>configfile</tt></i></span></dt><dd><p>Consult <i class="replaceable"><tt>configfile</tt></i> instead of
          <tt class="filename">/etc/netatalk/papd.conf</tt> for the configuration
          information.</p></dd><dt><span class="term">-p <i class="replaceable"><tt>printcap</tt></i></span></dt><dd><p>Consult <i class="replaceable"><tt>printcap</tt></i> instead of
          <tt class="filename">/etc/printcap</tt> for LPD configuration
          information.</p></dd></dl></div></div><div class="refsect1" lang="en"><a name="id2899523"></a><h2>Notes</h2><p>PSSP<a class="indexterm" name="id2899534"></a> (Print Server Security Protocol) is an authentication
    protocol<a class="indexterm" name="id2899550"></a> carried out through postscript printer queries to the print
    server. Using PSSP requires LaserWriter 8.6.1 or greater on the client
    mac. The user will be prompted to enter their username and password before
    they print. It may be necessary to re-setup the printer on each client the
    first time PSSP is enabled, so that the client can figure out that
    authentication is required to print. You can enable PSSP on a per-printer
    basis. PSSP is the recommended method of authenticating printers as it is
    more robust than CAP-style authentication, described below.</p><p>CAP-style authentication<a class="indexterm" name="id2899588"></a> gets its name from the method the CAP (Columbia APpletalk)
    package used to authenticate its mac clients' printing. This method
    requires that a user login to a file share before they print.
    <span><b class="command">afpd</b></span> records the username in a temporary file named
    after the client's Appletalk address, and it deletes the temporary file
    when the user disconnects. Therefore CAP style authentification will
    <span class="emphasis"><em>not</em></span> work for clients connected to
    <span><b class="command">afpd</b></span> via TCP/IP. <span><b class="command">papd</b></span> gets the
    username from the file with the same Appletalk address as the machine
    connecting to it. CAP-style authentication will work with any mac client.
    If both CAP and PSSP are enabled for a particular printer, CAP will be
    tried first, then <span><b class="command">papd</b></span> will fall back to PSSP.</p><p>The list of UAMs to use for authentication (specified with the 'am' option)
    applies to all printers. It is not possible to define different
    authentication methods on each printer. You can specify the list of UAMS
    multiple times, but only the last setting will be used. Currently only
    uams_guest.so and uams_clrtxt.so are supported as printer authentication
    methods. The guest method requires a valid username, but not a password.
    The Cleartext UAM requires both a valid username and the correct
    password.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>As of this writing, Mac OS X makes no use of PSSP authentication
      any longer. CAP-style authentication normally won't be an option, too
      caused by the use of AFP over TCP these days.</p></div><p></p></div><div class="refsect1" lang="en"><a name="id2899678"></a><h2>Files</h2><div class="variablelist"><dl><dt><span class="term"><tt class="filename">/etc/netatalk/papd.conf</tt></span></dt><dd><p>Default configuration file.</p></dd><dt><span class="term"><tt class="filename">/etc/printcap</tt></span></dt><dd><p>Printer capabilities database.</p></dd><dt><span class="term"><tt class="filename">.ppd</tt></span></dt><dd><p>PostScript Printer Description file. papd answers
          configuration and font queries from printing clients by consulting
          the configured PPD file. Such files are available for download from
          Adobe, Inc. (<a href="http://www.adobe.com/support/downloads/main.html#Printer" target="_top">http://www.adobe.com/support/downloads/main.htm</a>),
          or from the printer's manufacturer. If no PPD file is configured,
          papd will return the default answer, possibly causing the client to
          send excessively large jobs.</p></dd></dl></div></div><div class="refsect1" lang="en"><a name="id2899774"></a><h2>Caveats</h2><p><span><b class="command">papd</b></span> accepts characters with the high bit set (a
    full 8-bits) from the clients, but some PostScript printers (including
    Apple Computer's LaserWriter family) only accept 7-bit characters on their
    serial interface by default. The same applies for some printers when
    they're accessed via TCP/IP methods (remote LPR or socket). You will need
    to configure your printer to accept a full 8 bits or take special
    precautions and convert the printjob's encoding (eg. by using <span class="emphasis"><em>co="protocol=BCP"</em></span> when using CUPS 1.1.19 or
    above).</p><p>When printing clients run MacOS 10.2 or above, take care that PPDs
    do not make use of <span class="emphasis"><em>*cupsFilter:</em></span> comments
    unless the appropriate filters are installed at the client's side, too
    (remember: Starting with 10.2 Apple chose to integrate CUPS into MacOS X).
    For in-depth information on how CUPS uses PPDs see chapter 3.4 in <a href="http://tinyurl.com/zbxn" target="_top"> http://tinyurl.com/zbxn</a>).</p></div><div class="refsect1" lang="en"><a name="id2899830"></a><h2>See also</h2><p><a href="lpr.1.html"><span class="citerefentry"><span class="refentrytitle">lpr</span>(1)</span></a>,<a href="lprm.1.html"><span class="citerefentry"><span class="refentrytitle">lprm</span>(1)</span></a>,<a href="printcap.5.html"><span class="citerefentry"><span class="refentrytitle">printcap</span>(5)</span></a>,<a href="lpc.8.html"><span class="citerefentry"><span class="refentrytitle">lpc</span>(8)</span></a>,<a href="lpd.8.html"><span class="citerefentry"><span class="refentrytitle">lpd</span>(8)</span></a>, <a href="lp.1.html"><span class="citerefentry"><span class="refentrytitle">lp</span>(1)</span></a>.</p></div></div><div class="refentry" lang="en"><div class="refentry.separator"><hr></div><a name="papd.conf.5"></a><div class="titlepage"><div></div><div></div></div><div class="refnamediv"><h2>Name</h2><p>papd.conf &#8212; Configuration file used by papd(8) to determine the
    configuration of printers used by the Netatalk printing daemon<a class="indexterm" name="id2899970"></a></p></div><div class="refsect1" lang="en"><a name="id2899982"></a><h2>DESCRIPTION</h2><p><span class="emphasis"><em>/etc/netatalk/papd.conf</em></span> is the
    configuration file used by papd to configure the printing services offered
    by netatalk. Please note that papd must be enabled in <span class="emphasis"><em>/etc/netatalk/netatalk.conf</em></span> for this to take any effect.
    <span class="emphasis"><em>papd</em></span> shares the same defaults as lpd on
    many systems, but not Solaris.</p><p>Any line not prefixed with <span class="emphasis"><em>#</em></span> is
    interpreted. The configuration lines are composed like:</p><p><span class="emphasis"><em>printername:[options]</em></span></p><p>On systems running a System V printing system the simplest case is
    to have either no papd.conf, or to have one that has no active lines. In
    this case, atalkd should auto-discover the local printers on the machine.
    Please note that you can split lines by using <span class="emphasis"><em>\\fR.</em></span></p><p>printername may be just a name (<span class="emphasis"><em>Printer
    1</em></span>), or it may be a full name in nbp_name format (<span class="emphasis"><em>Printer 1:LaserWriter@My Zone</em></span>).</p><p>Systems using a BSD printing system should make use of a pipe to the
    printing command in question within the <span class="emphasis"><em>pr</em></span>
    option (eg. <span class="emphasis"><em>pr=|/usr/bin/lpr -J%J -u%U</em></span>).
    Note: When printing using a pipe, papd recognizes several wildcards: %F
    will be replaced by the name present in the "%%For:" comment in the
    PostScript stream, same with %J for the "%%Title:" comment. %U will be
    substituted with the login name (the latter applies only when
    authenticated printing is in effect).</p><p>When CUPS support is compiled in, then <span class="emphasis"><em>cupsautoadd </em></span> as the first entry in papd.conf will
    automagically share all CUPS printers by papd utilizing the PPDs assigned
    in CUPS (customizable -- see below). This can be overwritten for individal
    printers by subsequently adding individual entries using the CUPS queue
    name as <span class="emphasis"><em>pr </em></span> entry. Note: CUPS support is
    mutually exclusive with System V support described above.</p><p>The possible options are colon delimited (<span class="emphasis"><em>:</em></span>), and lines must be terminated with colons. The
    possible options and flags are:</p><div class="variablelist"><dl><dt><span class="term"><span class="emphasis"><em>am=(uams list)</em></span></span></dt><dd><p>The <span class="emphasis"><em>am</em></span> option allows specific
          UAMs to be specified for a particular printer. It has no effect if
          the <span class="emphasis"><em>au</em></span> flag is not present or if papd
          authentication was not built into netatalk. Note: possible values
          are <span class="emphasis"><em>uams_guest.so</em></span> and <span class="emphasis"><em> uams_clrtxt.so</em></span> only. The first method requires
          a valid username, but no password. The second requires both a valid
          username and the correct password.</p></dd><dt><span class="term"><span class="emphasis"><em>au</em></span></span></dt><dd><p>If present, this flag enables authentication for the printer.
          Please note that papd authentication must be built into netatalk for
          this to take effect.</p></dd><dt><span class="term"><span class="emphasis"><em>co=(CUPS options)</em></span></span></dt><dd><p>The <span class="emphasis"><em>co</em></span> option allows options to
          be passed through to CUPS (eg. <span class="emphasis"><em>co="protocol=TBCP" </em></span> or <span class="emphasis"><em>co="raw"</em></span>).</p></dd><dt><span class="term"><span class="emphasis"><em>cupsautoadd[:type][@zone]</em></span></span></dt><dd><p>If used as the first entry in papd.conf this will share all
          CUPS printers via papd. type/zone settings as well as other
          parameters assigned to this special printer share will apply to all
          CUPS printers. Unless the <span class="emphasis"><em>pd</em></span> option
          is set, the CUPS PPDs will be used. To overwrite these global
          settings for individual printers simply add them subsequently to
          papd.conf and assign different settings.</p></dd><dt><span class="term"><span class="emphasis"><em>fo</em></span></span></dt><dd><p>If present, this flag enables a hack to translate line endings
          originating from pre Mac OS X LaserWriter drivers to let <span class="emphasis"><em>foomatic-rip</em></span> recognize foomatic PPD options set
          in the printer dialog. Attention: Use with caution since this might
          corrupt binary print jobs!</p></dd><dt><span class="term"><span class="emphasis"><em>op=(operator)</em></span></span></dt><dd><p>This specifies the operator name, for lpd spooling.</p></dd><dt><span class="term"><span class="emphasis"><em>pa=(appletalk address)</em></span></span></dt><dd><p>Allows specification of Appletalk addresses. Usually not
          needed.</p></dd><dt><span class="term"><span class="emphasis"><em>pd=(path to ppd file)</em></span></span></dt><dd><p>Specifies a particular PPD (printer description file) to
          associate with the selected printer.</p></dd><dt><span class="term"><span class="emphasis"><em>pr=(lpd/CUPS printer name or pipe
        command)</em></span></span></dt><dd><p>Sets the <span class="emphasis"><em>lpd</em></span> or <span class="emphasis"><em>CUPS</em></span> printer that this is spooled to.</p></dd></dl></div></div><div class="refsect1" lang="en"><a name="id2900438"></a><h2>Examples</h2><p>Unless CUPS support has been compiled in (which is default from
    Netatalk 2.0 on) one simply defines the lpd queue in question by setting
    the <tt class="option">pr</tt> parameter to the queue name, in the following
    example "ps". If no <tt class="option">pr</tt> parameter is set, the default
    printer will be used.</p><div class="example"><a name="id2900462"></a><p class="title"><b>Example 5.10. papd.conf System V printing system examples</b></p><p>The first spooler is known by the AppleTalk name Mac Printer
      Spooler, and uses a PPD file located in
      <tt class="filename">/usr/share/lib/ppd</tt>. In addition, the user mcs will
      be the owner of all jobs that are spooled. The second spooler is known
      as HP Printer and all options are the default. </p><pre class="programlisting">Mac Printer Spooler:\
   :pr=ps:\
   :pd=/usr/share/lib/ppd/HPLJ_4M.PPD:\
   :op=mcs:

HP Printer:\
   :</pre></div><p>An alternative to the technique outlined above is to direct papd's
    output via a pipe into another program. Using this mechanism almost all
    printing systems can be driven. Netatalk supplies three "wildcards" that
    get substituted with values of the already printed job:
    <tt class="option">%F</tt>, <tt class="option">%U</tt> and <tt class="option">%J</tt>. Using
    these wildcards, one can pass those parameters directly to programs or
    implement small wrapper scripts to call the printing system in
    question.</p><div class="example"><a name="id2900521"></a><p class="title"><b>Example 5.11. papd.conf examples using pipes</b></p><p>The first spooler is known as HP 8100. It pipes the print job to
      <span><b class="command">/usr/bin/lpr</b></span> for printing using the value of the
      <span class="emphasis"><em>%%Title: </em></span> comment as job name. PSSP authenticated
      printing is enabled, as is CAP-style authenticated printing. Both
      methods support guest and cleartext authentication as specified by the
      '<tt class="option">am</tt>' option. The PPD used is
      <tt class="filename">/etc/atalk/ppds/hp8100.ppd</tt>. The second spooler is
      called "Dump PostScript" and uses a pipe to <span><b class="command">cat</b></span> to
      send the raw PostScript code into the user's home directory into a file
      called like the printjob. </p><pre class="programlisting">HP 8100:\
   :pr=|/usr/bin/lpr -Plp -J"%J":\
   :sp:\
   :ca=/tmp/print:\
   :am=uams_guest.so,uams_pam.so:\
   :pd=/etc/atalk/ppds/hp8100.ppd:

Dump PostScript:LaserWriter@Server:\
   :pr=|cat &gt;/home/%U/%J-prn.out:\
   :pd=/usr/share/lib/ppd/mooralana.ppd:\
   :sp:au:op=lp:\
   :am=uams_clrtxt.so:</pre></div><p>Starting with Netatalk 2.0 direct CUPS integration is available. In
    this case, defining only a queue name as <tt class="option">pr</tt> parameter
    won't invoke the SysV lpd daemon but uses CUPS instead. Unless a specific
    PPD has been assigned using the <tt class="option">pd</tt> switch, the PPD
    configured in CUPS will be used by <span><b class="command">papd</b></span>, too.</p><p>There exists one special share named "cupsautoadd". If this is
    present as the first entry then all available CUPS queues will be served
    automagically using the parameters assigned to this global share. But
    subsequent printer definitions can be used to override these global
    settings for individual spoolers.</p><div class="example"><a name="id2900619"></a><p class="title"><b>Example 5.12. papd.conf CUPS examples</b></p><p>The first entry sets up automatic sharing of all CUPS printers.
      All those shares appear in the zone "1st floor" and since no additional
      settings have been made, they use the CUPS printer name as NBP name and
      use the PPD configured in CUPS. The second entry defines different
      settings for one single CUPS printer. It's NBP name is differing from
      the printer's name and the registration happens in another zone.
      </p><pre class="programlisting">cupsautoadd@1st floor:op=root:

Boss' LaserWriter@2nd floor:\
   :pr=laserwriter-chief:</pre></div></div><div class="refsect1" lang="en"><a name="id2900650"></a><h2>SEE ALSO</h2><p><a href="papd.8.html"><span class="citerefentry"><span class="refentrytitle">papd</span>(8)</span></a>, <a href="atalkd.conf.5.html"><span class="citerefentry"><span class="refentrytitle">atalkd.conf</span>(5)</span></a>, <a href="lpd.8.html"><span class="citerefentry"><span class="refentrytitle">lpd</span>(8)</span></a>, <a href="lpoptions.8.html"><span class="citerefentry"><span class="refentrytitle">lpoptions</span>(8)</span></a></p></div></div><div class="refentry" lang="en"><div class="refentry.separator"><hr></div><a name="papstatus.8"></a><div class="titlepage"><div></div><div></div></div><div class="refnamediv"><h2>Name</h2><p>papstatus &#8212; get the status of an AppleTalk-connected printer</p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><div class="cmdsynopsis"><p><tt class="command">/usr/sbin/papstatus<a class="indexterm" name="id2900772"></a></tt>  [-d] [ -p    <i class="replaceable"><tt>printer</tt></i> ] [<i class="replaceable"><tt>retrytime</tt></i>]</p></div></div><div class="refsect1" lang="en"><a name="id2900828"></a><h2>DESCRIPTION</h2><p><span class="emphasis"><em>papstatus</em></span> is used to obtain the
    current status message from an AppleTalk connected printer. It uses the
    Printer Access Protocol (PAP) to obtain the status information.</p><p>If no printer is specified on the command line, <span class="emphasis"><em>papstatus</em></span>
    looks for a file called <span class="markup">.paprc</span> in the current directory
    and reads it to obtain the name of a printer. The <span class="markup">.paprc</span>
    file should contain a single line of the form <span class="emphasis"><em>object</em></span><span class="emphasis"><em>:</em></span><span class="emphasis"><em></em></span><span class="emphasis"><em>type</em></span><span class="emphasis"><em>@</em></span><span class="emphasis"><em></em></span><span class="emphasis"><em>zone</em></span>
    where each of <span class="emphasis"><em>object</em></span>, <span class="emphasis"><em>:</em></span><span class="emphasis"><em>type</em></span><span class="emphasis"><em>,</em></span> and <span class="emphasis"><em>@</em></span><span class="emphasis"><em>zone</em></span> are optional.
    <span class="emphasis"><em>type</em></span> and <span class="emphasis"><em>zone</em></span>
    must be proceeded by `<span class="emphasis"><em>:</em></span>' and `<span class="emphasis"><em>@</em></span>' respectively. Blank lines and lines the begin
    with a `<span class="emphasis"><em>#</em></span>' are ignored. <span class="emphasis"><em>type</em></span> and <span class="emphasis"><em>zone</em></span> default
    to <span class="emphasis"><em>LaserWriter</em></span> and the zone of the local
    host, respectively.</p></div><div class="refsect1" lang="en"><a name="id2901001"></a><h2>OPTIONS</h2><div class="variablelist"><dl><dt><span class="term"><tt class="option">-d</tt></span></dt><dd><p>Turns on a debugging mode that prints some extra information
          to standard error.</p></dd><dt><span class="term"><tt class="option">-p</tt> <i class="replaceable"><tt>printer</tt></i></span></dt><dd><p>Get status from <span class="emphasis"><em>printer</em></span> (do not
          consult any <span class="markup">.paprc</span> files to find a printer name).
          The syntax for <span class="emphasis"><em>printer</em></span> is the same as
          discussed above for the <span class="markup">.paprc</span> file.</p></dd><dt><span class="term"><span class="emphasis"><em>retrytime</em></span></span></dt><dd><p>Normally, <span class="emphasis"><em>papstatus</em></span> only gets
          the status from the printer once. If <span class="emphasis"><em>retrytime</em></span>
          is specified, the status is obtained repeatedly, with a sleep of
          <span class="emphasis"><em>retrytime</em></span> seconds between inquiring
          the printer.</p></dd></dl></div></div><div class="refsect1" lang="en"><a name="id2901127"></a><h2>FILES</h2><div class="variablelist"><dl><dt><span class="term"><span class="markup">.paprc</span></span></dt><dd><p>file that contains printer name</p></dd></dl></div></div><div class="refsect1" lang="en"><a name="id2901160"></a><h2>SEE ALSO</h2><p><a href="nbp.1.html"><span class="citerefentry"><span class="refentrytitle">nbp</span>(1)</span></a>,
    <a href="pap.1.html"><span class="citerefentry"><span class="refentrytitle">pap</span>(1)</span></a></p></div></div><div class="refentry" lang="en"><div class="refentry.separator"><hr></div><a name="psf.8"></a><div class="titlepage"><div></div><div></div></div><div class="refnamediv"><h2>Name</h2><p>psf &#8212; PostScript filter</p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><div class="cmdsynopsis"><p><tt class="command">psf<a class="indexterm" name="id2901249"></a></tt>  [ -n    <i class="replaceable"><tt>name</tt></i> ] [ -h    <i class="replaceable"><tt>host</tt></i> ] [ -w    <i class="replaceable"><tt>width</tt></i> ] [ -l    <i class="replaceable"><tt>length</tt></i> ] [ -i    <i class="replaceable"><tt>indent</tt></i> ] [-c]</p></div></div><div class="refsect1" lang="en"><a name="id2901396"></a><h2>DESCRIPTION</h2><p><span><b class="command">psf</b></span> is an <span class="emphasis"><em>lpd</em></span>
    filter for PostScript printing. <span><b class="command">psf</b></span> interprets the name
    it was called with to determine what filters to invoke. First, if the
    string ``pap'' appears anywhere in the name, <span><b class="command">psf</b></span>
    invokes <span class="emphasis"><em>pap</em></span> to talk to a printer via
    AppleTalk. Next, if the string ``rev'' appears,
    <span><b class="command">psf</b></span> invokes <span class="emphasis"><em>psorder</em></span> to
    reverse the pages of the job. Finally, if <span><b class="command">psf</b></span> was
    called with a filter's name as the leading string, it invokes that
    filter. If there is no filter to run, <span><b class="command">psf</b></span> examines the
    magic number of the input, and if the input is not PostScript, converts it
    to PostScript.</p></div><div class="refsect1" lang="en"><a name="id2901477"></a><h2>KLUDGE</h2><p>In the default configuration, <span><b class="command">psf</b></span> supports two
    kludges. The first causes <span><b class="command">psf</b></span> to check its name for the
    letter `m'. If this letter is found and accounting is turned on,
    <span><b class="command">psf</b></span> calls <span class="emphasis"><em>pap</em></span> twice,
    once to get an initial page count and to print the job, and another time
    to get a final page count. This is a work-around for bugs in a variety of
    PAP implementions that cause printers to never properly close the PAP
    output file. A notable example is any printer by Hewlett-Packard.</p><p>The second kludge causes <span><b class="command">psf</b></span> to examine its name
    for the letter `w'. If this letter is found and accounting is turned
    on, <span><b class="command">psf</b></span> calls <span class="emphasis"><em>pap</em></span> with
    the <tt class="option">-w</tt> flag. This flag causes <span class="emphasis"><em>pap</em></span>
    to wait until the printer's status contains the string `idle'.
    Once this string is found, the job is printed as normal. This kludge is a
    work-around for printers, notably Hewlett-Packard's LaserJet IV, which
    will report a page count while a previous jobs is still printing.</p></div><div class="refsect1" lang="en"><a name="id2901568"></a><h2>EXAMPLE</h2><p>The sample <span class="emphasis"><em>printcap</em></span> entry below
    invokes <span><b class="command">psf</b></span> to print text files, PostScript files,
    <span class="emphasis"><em>troff</em></span>'s C/A/T output, and <span class="emphasis"><em>TeX</em></span>'s DVI output, to an AppleTalk connected
    LaserWriter Plus. Since the LaserWriter Plus stacks pages in descending
    order, we reverse the pages and print the burst page last.</p><div class="literallayout"><p><br>
laser|lp|LaserWriter Plus on AppleTalk:\<br>
    :sd=/usr/spool/lpd/laser:\<br>
    :lp=/usr/spool/lpd/laser/null:\<br>
    :lf=/var/adm/lpd-errs:pw#80:hl:\<br>
    :of=/usr/libexec/ofpap:\<br>
    :if=/usr/libexec/ifpaprev:\<br>
    :tf=/usr/libexec/tfpaprev:\<br>
    :df=/usr/libexec/dfpaprev:<br>
</p></div><p>Note that if the host in question spools to more than one AppleTalk
    printer, <tt class="filename">/dev/null</tt> should not be used for the
    <span class="emphasis"><em>lp</em></span> capability. Instead, a null device
    should be created with <span class="emphasis"><em>mknod</em></span> for each
    printer, as has been done above.</p><p>Finally, there is a file in the spool directory,
    <tt class="filename">/var/spool/lpd/laser</tt>, called <span class="markup">.paprc</span>,
    which <span class="emphasis"><em>pap</em></span> reads for the AppleTalk name of
    the printer.</p></div><div class="refsect1" lang="en"><a name="id2901683"></a><h2>SEE ALSO</h2><p><a href="psorder.1.html"><span class="citerefentry"><span class="refentrytitle">psorder</span>(1)</span></a>,
    <a href="printcap.5.html"><span class="citerefentry"><span class="refentrytitle">printcap</span>(5)</span></a>,
    <a href="lpd.1.html"><span class="citerefentry"><span class="refentrytitle">lpd</span>(1)</span></a>,
    <a href="mknod.1.html"><span class="citerefentry"><span class="refentrytitle">mknod</span>(1)</span></a>,
    <a href="pap.1.html"><span class="citerefentry"><span class="refentrytitle">pap</span>(1)</span></a>.</p></div></div><div class="refentry" lang="en"><div class="refentry.separator"><hr></div><a name="psorder.1"></a><div class="titlepage"><div></div><div></div></div><div class="refnamediv"><h2>Name</h2><p>psorder &#8212; PostScript pageorder filter</p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><div class="cmdsynopsis"><p><tt class="command">psorder<a class="indexterm" name="id2901799"></a></tt>  [-duf]  <i class="replaceable"><tt>sourcefile</tt></i> </p></div></div><div class="refsect1" lang="en"><a name="id2901829"></a><h2>DESCRIPTION</h2><p><span><b class="command">psorder</b></span> is a filter that re-orders the pages of a
    PostScript document. The result is written to the standard output. By
    default, documents are processed into ascending order (the lowest numbered
    page is printed first). Some PostScript documents specify that the order
    of their pages should never be changed; the default action of
    <span><b class="command">psorder</b></span> is to follow this specification.</p><p>If no source file is given, or if <span class="emphasis"><em>sourcefile</em></span>
    is `<span class="emphasis"><em>-</em></span>', <span><b class="command">psorder</b></span>
    reads from the standard input file.</p></div><div class="refsect1" lang="en"><a name="id2901886"></a><h2>OPTIONS</h2><div class="variablelist"><dl><dt><span class="term"><tt class="option">-d</tt></span></dt><dd><p>Re-order the pages of the document in downward or descending
          order. This is typically used to change the order of a document to
          be printed by a printer that stacks pages face-up, such as an Apple
          LaserWriter or LaserWriter Plus.</p></dd><dt><span class="term"><tt class="option">-u</tt></span></dt><dd><p>Specifies forward order, and is the default. It is used to try
          and ensure the correct ordering when a document will be printed by a
          printer that stacks the pages face-down.</p></dd><dt><span class="term"><tt class="option">-f</tt></span></dt><dd><p>Force <span><b class="command">psorder</b></span> to re-order the pages, even
          if the document claims that its page order is not to be trifled
          with. This option should only be used experimentally, as it may
          cause documents to print incorrectly.</p></dd></dl></div></div><div class="refsect1" lang="en"><a name="id2901976"></a><h2>SEE ALSO</h2><p><a href="psf.8.html"><span class="citerefentry"><span class="refentrytitle">psf</span>(8)</span></a>,
    <a href="lpr.1.html"><span class="citerefentry"><span class="refentrytitle">lpr</span>(1)</span></a>.</p></div></div><div class="refentry" lang="en"><div class="refentry.separator"><hr></div><a name="timelord.8"></a><div class="titlepage"><div></div><div></div></div><div class="refnamediv"><h2>Name</h2><p>timelord &#8212; Macintosh time server daemon</p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><a class="indexterm" name="id2902061"></a></div><div class="refsect1" lang="en"><a name="id2902074"></a><h2>SYNTAX</h2><p>timelord [-d] [-n <span class="emphasis"><em>filename</em></span>]</p></div><div class="refsect1" lang="en"><a name="id2902092"></a><h2>DESCRIPTION</h2><p><span class="emphasis"><em>timelord</em></span> is a simple time server for
    Macintosh computers that use the <span class="emphasis"><em>tardis</em></span>
    client.</p></div><div class="refsect1" lang="en"><a name="id2902118"></a><h2>OPTIONS</h2><div class="variablelist"><dl><dt><span class="term"><tt class="option">-d</tt></span></dt><dd><p>Debug mode, i.e. don't disassociate from controlling
          TTY.</p></dd><dt><span class="term"><tt class="option">-n</tt> <i class="replaceable"><tt>nbpname</tt></i></span></dt><dd><p>Register this server as <span class="emphasis"><em>nbpname</em></span>. This defaults to the hostname.</p></dd></dl></div></div></div><div class="refentry" lang="en"><div class="refentry.separator"><hr></div><a name="timeout.1"></a><div class="titlepage"><div></div><div></div></div><div class="refnamediv"><h2>Name</h2><p>timeout &#8212; Send a signal to a program after a certain time<a class="indexterm" name="id2902235"></a></p></div><div class="refsect1" lang="en"><a name="id2902244"></a><h2>SYNTAX</h2><p>timeout [-s <span class="emphasis"><em>signal</em></span>] <span class="emphasis"><em>seconds</em></span> <span class="emphasis"><em>program</em></span> [<span class="emphasis"><em>args</em></span>]</p></div><div class="refsect1" lang="en"><a name="id2902283"></a><h2>DESCRIPTION</h2><p><span class="emphasis"><em>timeout</em></span> executes a <span class="emphasis"><em>program</em></span> (with arguments <span class="emphasis"><em>args</em></span>)
    and sends a <span class="emphasis"><em>signal</em></span> to it after a certain
    amount of <span class="emphasis"><em>seconds</em></span>.</p></div><div class="refsect1" lang="en"><a name="id2902329"></a><h2>OPTIONS</h2><div class="variablelist"><dl><dt><span class="term"><tt class="option">-s</tt> <i class="replaceable"><tt>signal</tt></i></span></dt><dd><p>Signal to send to the spawned process. This can be a numerical
          or symbolic ID. This defaults to <tt class="envar">TERM</tt>.</p></dd></dl></div></div><div class="refsect1" lang="en"><a name="id2902374"></a><h2>EXAMPLES</h2><div class="variablelist"><dl><dt><span class="term">timeout 10 pap foo.ps</span></dt><dd><p>Execute "pap foo.ps" and send a <tt class="constant">SIGTERM</tt>
          if <span class="emphasis"><em>pap</em></span> doesn't return after 10
          seconds.</p></dd><dt><span class="term">timeout -s HUP 60 sh</span></dt><dd><p>Spawn a shell and send a hangup signal after one minute.</p></dd><dt><span class="term">timeout -s 9 10 evilprog</span></dt><dd><p>Execute a program and <span class="emphasis"><em>KILL</em></span> it
          if it doesn't quit after 10 seconds.</p></dd></dl></div></div></div><div class="refentry" lang="en"><div class="refentry.separator"><hr></div><a name="uniconv.1"></a><div class="titlepage"><div></div><div></div></div><div class="refnamediv"><h2>Name</h2><p>uniconv &#8212; convert Netatalk volume encoding</p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><div class="cmdsynopsis"><p><tt class="command">uniconv<a class="indexterm" name="id2902527"></a></tt>  [-ndv]  -c <i class="replaceable"><tt>cnidbackend</tt></i>   -f <i class="replaceable"><tt>fromcode</tt></i>   -t <i class="replaceable"><tt>tocode</tt></i>  [-m <i class="replaceable"><tt>maccode</tt></i>]  <i class="replaceable"><tt>volumepath</tt></i> </p></div></div><div class="refsect1" lang="en"><a name="id2902606"></a><h2>Description</h2><p><span><b class="command">uniconv</b></span> converts the volume encoding of
    <i class="replaceable"><tt>volumepath</tt></i> from the <i class="replaceable"><tt>fromcode</tt></i>
    to the <i class="replaceable"><tt>tocode</tt></i> encoding.</p></div><div class="refsect1" lang="en"><a name="id2902636"></a><h2>Options</h2><div class="variablelist"><dl><dt><span class="term">-c</span></dt><dd><p>CNID backend used on this volume, usually cdb or dbd. Should
          match the backend selected with afpd for this volume. If not
          specified, the default CNID backend `cdb' is
          used</p></dd><dt><span class="term">-d</span></dt><dd><p>don't CAP encode leading dots (:2e), equivalent to
          <tt class="option">usedots</tt> in <a href="AppleVolumes.default.5.html"><span class="citerefentry"><span class="refentrytitle">AppleVolumes.default</span>(5)</span></a></p></dd><dt><span class="term">-f</span></dt><dd><p>encoding to convert from, use ASCII for CAP encoded volumes</p></dd><dt><span class="term">-h</span></dt><dd><p>display help</p></dd><dt><span class="term">-m</span></dt><dd><p>Macintosh client codepage, required for CAP encoded volumes.
          Defaults to `MAC_ROMAN'</p></dd><dt><span class="term">-n</span></dt><dd><p>`dry run', don't do any real changes</p></dd><dt><span class="term">-t</span></dt><dd><p>volume encoding to convert to, e.g. UTF8</p></dd><dt><span class="term">-v</span></dt><dd><p>verbose output, use twice for maximum logging.</p></dd><dt><span class="term">-V</span></dt><dd><p>print version and exit</p></dd></dl></div><p></p></div><div class="refsect1" lang="en"><a name="id2902824"></a><h2>WARNING</h2><p>Setting the wrong options might render your data unusable!!! Make
    sure you know what you are doing. Always backup your data first.</p><p>It is <span class="bold"><b>*strongly*</b></span> recommended to do
    a `dry run' first and to check the output for conversion errors.</p><p><a href="afpd.8.html"><span class="citerefentry"><span class="refentrytitle">afpd</span>(8)</span></a>
    should <span class="emphasis"><em>not</em></span> be running while you change the volume
    encoding. Remember to change <tt class="option">volcodepage</tt> in
    <a href="AppleVolumes.default.5.html"><span class="citerefentry"><span class="refentrytitle">AppleVolumes.default</span>(5)</span></a>
    to the new codepage, before restarting afpd.</p><p><span class="bold"><b>USE AT YOUR OWN RISK!!!</b></span></p></div><div class="refsect1" lang="en"><a name="id2902891"></a><h2>Selectable charsets</h2><p>Netatalk provides internal support for UTF-8 (pre- and decomposed)
    and CAP. If you want to use other charsets, they must be provided by
    <a href="iconv.1.html"><span class="citerefentry"><span class="refentrytitle">iconv</span>(1)</span></a></p><p><span><b class="command">uniconv</b></span> also knows iso-8859.adapted, an old style
    1.x NLS widely used. This is only intended for upgrading old volumes,
    <a href="afpd.8.html"><span class="citerefentry"><span class="refentrytitle">afpd</span>(8)</span></a>
    cannot handle iso-8859.adapted anymore.</p></div><div class="refsect1" lang="en"><a name="id2902935"></a><h2>CNID background</h2><p>The CNID backends maintains name to ID mappings. If you change a
    filename outside afpd(8) (shell, samba), the CNID db, i.e. the DIDNAME
    index, gets inconsistent. Netatalk tries to recover from such
    inconsistencies as gracefully as possible. The mechanisms to resolve such
    inconsistencies may fail sometimes, though, as this is not an easy task to
    accomplish. I.e. if several names in the path to the file or directory
    have changed, things may go wrong.</p><p>If you change a lot of filenames at once, chances are higher that
    the afpds fallback mechanisms fail, i.e. files will be assigned new IDs,
    even though the file hasn't changed. <span><b class="command">uniconv</b></span>
    therefore updates the CNID entry for each file/directory directly after it
    changes the name to avoid inconsistencies. The two supported backends for
    volumes, dbd and cdb, use the same CNID db format. Therefore, you
    <span class="emphasis"><em>could</em></span> use <span><b class="command">uniconv</b></span> with cdb and
    <span><b class="command">afpd</b></span> with dbd later.</p><p><span class="bold"><b>Warning</b></span>: There must not be two
    processes opening the CNID database using different backends at once! If a
    volume is still opened with dbd (cnid_metad/cnid_dbd) and you start
    <span><b class="command">uniconv</b></span> with cdb, the result will be a corrupted CNID
    database, as the two backends use different locking schemes. You might run
    into additional problems, e.g. if dbd is compiled with transactions, cdb
    will not update the transaction logs.</p><p>In general, it is recommended to use the same backend for
    <span><b class="command">uniconv</b></span> you are using with
    <a href="afpd.8.html"><span class="citerefentry"><span class="refentrytitle">afpd</span>(8)</span></a>.</p></div><div class="refsect1" lang="en"><a name="id2903038"></a><h2>Examples</h2><p>convert 1.x CAP encoded volume to UTF-8, clients used MacRoman
    codepage, cnidscheme is dbd:</p><pre class="screen"><tt class="prompt">example%</tt><b class="userinput"><tt> uniconv -c dbd -f ASCII -t UTF8 -m MAC_ROMAN /path/to/share</tt></b></pre><p>convert iso8859-1 volume to UTF-8, cnidscheme is cdb:</p><pre class="screen"><tt class="prompt">example%</tt><b class="userinput"><tt> uniconv -c cdb -f ISO-8859-1 -t UTF8 -m MAC_ROMAN /path/to/share</tt></b></pre><p>convert 1.x volume using iso8859-1 adapted NLS to CAP encoding:</p><pre class="screen"><tt class="prompt">example%</tt><b class="userinput"><tt> uniconv -f ISO-8859-ADAPTED -t ASCII -m MAC_ROMAN/path/to/share</tt></b></pre><p>convert UTF-8 volume to CAP, for MacCyrillic clients:</p><pre class="screen"><tt class="prompt">example%</tt><b class="userinput"><tt> uniconv -f UTF8 -t ASCII -m MAC_CYRILLIC /path/to/share</tt></b></pre></div><div class="refsect1" lang="en"><a name="id2903138"></a><h2>See also</h2><p><a href="AppleVolumes.default.5.html"><span class="citerefentry"><span class="refentrytitle">AppleVolumes.default</span>(5)</span></a>,<a href="afpd.8.html"><span class="citerefentry"><span class="refentrytitle">afpd</span>(8)</span></a>,<a href="iconv.1.html"><span class="citerefentry"><span class="refentrytitle">iconv</span>(1)</span></a>,<a href="cnid_metad.8.html"><span class="citerefentry"><span class="refentrytitle">cnid_metad</span>(8)</span></a>,<a href="cnid_dbd.8.html"><span class="citerefentry"><span class="refentrytitle">cnid_dbd</span>(8)</span></a></p></div></div></div><div class="index"><div class="titlepage"><div><div><h2 class="title"><a name="manual-index"></a>Index</h2></div></div><div></div></div><div class="index"><div class="indexdiv"><h3>Symbols</h3><dl><dt>2-Way Randnum exchange</dt><dd><dl><dt>"2-Way Randnum exchange" UAM, <a href="#id2880379">UAMs supported by Netatalk</a></dt></dl></dd></dl></div><div class="indexdiv"><h3>A</h3><dl><dt>achfile, <a href="#achfile.1">achfile</a></dt><dt>acleandir, <a href="#acleandir.1">acleandir</a></dt><dt>ADv1</dt><dd><dl><dt>AppleDouble v1, <a href="#volumes-and-filenames">Volumes and filenames</a></dt></dl></dd><dt>ADv2</dt><dd><dl><dt>AppleDouble v2, <a href="#CNID-backends">CNID backends</a>, <a href="#volumes-and-filenames">Volumes and filenames</a></dt></dl></dd><dt>aecho, <a href="#aecho.1">aecho</a></dt><dt>AEP</dt><dd><dl><dt>Apple Echo Protocol, <a href="#aecho.1">aecho</a>, <a href="#atalkd.8">atalkd</a></dt></dl></dd><dt>afile, <a href="#afile.1">afile</a></dt><dt>AFP</dt><dd><dl><dt>Apple Filing Protocol, <a href="#id2815878">File Services</a></dt></dl></dd><dt>afpd, <a href="#id2882707">Starting and stopping Netatalk</a>, <a href="#afpd.8">afpd</a></dt><dt>afpd.conf, <a href="#afpd.conf.5">afpd.conf</a></dt><dt>AFPD_GUEST, <a href="#netatalk.conf.5">netatalk.conf</a></dt><dt>AFPD_MAX_CLIENTS, <a href="#netatalk.conf.5">netatalk.conf</a></dt><dt>AFPD_RUN, <a href="#netatalk.conf.5">netatalk.conf</a></dt><dt>AFPD_UAM_LIST, <a href="#netatalk.conf.5">netatalk.conf</a></dt><dt>afppasswd, <a href="#afppasswd.1">afppasswd</a></dt><dt>AFS Kerberos</dt><dd><dl><dt>"AFS Kerberos" UAM (Kerberos IV), <a href="#id2880379">UAMs supported by Netatalk</a></dt></dl></dd><dt>ALLMULTI</dt><dd><dl><dt>NIC multicast settings, <a href="#atalkd.conf.5">atalkd.conf</a></dt></dl></dd><dt>AppleDB</dt><dd><dl><dt>.AppleDB CNID database store, <a href="#id2883994">How to upgrade if no persistent CNID storage was used</a></dt><dt>CNID database folder, <a href="#CNID-backends">CNID backends</a></dt></dl></dd><dt>AppleShare</dt><dd><dl><dt>Synonym for an AFP server, <a href="#id2815941">Setting up the AFP file server</a></dt></dl></dd><dt>Appletalk</dt><dd><dl><dt>The AppleTalk protocol suite, <a href="#id2815063">Appletalk</a></dt></dl></dd><dt>AppleVolumes.default, <a href="#AppleVolumes.default.5">AppleVolumes.default</a></dt><dt>apple_cp, <a href="#apple_cp.1">apple_cp</a></dt><dt>apple_mv, <a href="#apple_mv.1">apple_mv</a></dt><dt>apple_rm, <a href="#apple_rm.1">apple_rm</a></dt><dt>ASCII</dt><dd><dl><dt>afpd's unixcodepage setting, <a href="#id2879945">afpd and character sets</a></dt><dt>afpd's volcharset setting, <a href="#id2890783">Compatibility with earlier versions</a></dt><dt>American Standard Code for Information
            Interchange, <a href="#id2879464">Why Unicode?</a></dt></dl></dd><dt>asip-status.pl, <a href="#asip-status.pl.1">asip-status.pl</a></dt><dt>atalk, <a href="#atalk.4">atalk</a></dt><dt>atalkd, <a href="#id2882707">Starting and stopping Netatalk</a>, <a href="#atalkd.8">atalkd</a></dt><dt>atalkd.conf, <a href="#atalkd.conf.5">atalkd.conf</a></dt><dt>ATALKD_RUN, <a href="#netatalk.conf.5">netatalk.conf</a></dt><dt>atalk_aton, <a href="#atalk_aton.3">atalk_aton</a></dt><dt>ATALK_BGROUND, <a href="#netatalk.conf.5">netatalk.conf</a></dt><dt>ATALK_MAC_CHARSET, <a href="#netatalk.conf.5">netatalk.conf</a></dt><dt>ATALK_NAME, <a href="#netatalk.conf.5">netatalk.conf</a></dt><dt>ATALK_UNIX_CHARSET, <a href="#netatalk.conf.5">netatalk.conf</a></dt><dt>ATALK_ZONE, <a href="#netatalk.conf.5">netatalk.conf</a></dt><dt>authenticated printing, <a href="#pappipesupport">Using pipes with papd</a>, <a href="#id2899523">Notes</a></dt><dt>Authentication</dt><dd><dl><dt>between AFP client and server, <a href="#authentication">Authentication</a></dt></dl></dd></dl></div><div class="indexdiv"><h3>B</h3><dl><dt>Backend</dt><dd><dl><dt>CNID backend, <a href="#CNID-backends">CNID backends</a></dt><dt>CUPS backend, <a href="#papclient">Using AppleTalk printers</a></dt></dl></dd><dt>BDB</dt><dd><dl><dt>Berkeley DB, <a href="#id2817163">Required third party software</a></dt></dl></dd></dl></div><div class="indexdiv"><h3>C</h3><dl><dt>CAP</dt><dd><dl><dt>Columbia AppleTalk Package, <a href="#volumes-and-filenames">Volumes and filenames</a></dt></dl></dd><dt>CAP encoding</dt><dd><dl><dt>CAP style character encoding, <a href="#id2879945">afpd and character sets</a></dt></dl></dd><dt>CAP-style authentication</dt><dd><dl><dt>old-style printing authentication, <a href="#id2899523">Notes</a></dt></dl></dd><dt>CDB</dt><dd><dl><dt>"cdb" CNID backend, <a href="#id2879310">cdb</a>, <a href="#choosecnidscheme">Choosing a CNID storage scheme</a></dt></dl></dd><dt>Charset</dt><dd><dl><dt>character set, <a href="#charsets">Charsets/Unicode</a></dt></dl></dd><dt>Cleartxt Passwrd</dt><dd><dl><dt>"Cleartxt Passwrd" UAM, <a href="#id2880379">UAMs supported by Netatalk</a></dt></dl></dd><dt>Client Krb v2</dt><dd><dl><dt>"Client Krb v2" UAM (Kerberos V), <a href="#id2880379">UAMs supported by Netatalk</a></dt></dl></dd><dt>CNID</dt><dd><dl><dt>Catalog Node ID, <a href="#CNID-backends">CNID backends</a>, <a href="#choosecnidscheme">Choosing a CNID storage scheme</a></dt></dl></dd><dt>CNID backend, <a href="#CNID-backends">CNID backends</a>, <a href="#cnid_dbd.8">cnid_dbd</a>, <a href="#cnid_index.1">cnid_index</a></dt><dt>cnidscheme</dt><dd><dl><dt>specifying a CNID backend, <a href="#CNID-backends">CNID backends</a>, <a href="#choosecnidscheme">Choosing a CNID storage scheme</a>, <a href="#AppleVolumes.default.5">AppleVolumes.default</a></dt></dl></dd><dt>cnid_dbd, <a href="#cnid_dbd.8">cnid_dbd</a></dt><dt>cnid_index, <a href="#cnid_index.1">cnid_index</a></dt><dt>cnid_metad, <a href="#id2882707">Starting and stopping Netatalk</a>, <a href="#cnid_metad.8">cnid_metad</a></dt><dd><dl><dt>dbd CNID database daemon, <a href="#choosecnidscheme">Choosing a CNID storage scheme</a></dt></dl></dd><dt>CNID_METAD_RUN, <a href="#netatalk.conf.5">netatalk.conf</a></dt><dt>Codepage, <a href="#id2879464">Why Unicode?</a></dt><dt>Compile</dt><dd><dl><dt>Compiling Netatalk from Source, <a href="#compiling-netatalk">Compiling Netatalk</a></dt></dl></dd><dt>CUPS</dt><dd><dl><dt>Common Unix Printing System, <a href="#papserver">Setting up the PAP print server</a></dt></dl></dd><dt>CVS</dt><dd><dl><dt>Concurrent Versioning System, <a href="#id2816832">Anonymous CVS</a></dt></dl></dd></dl></div><div class="indexdiv"><h3>D</h3><dl><dt>DBD</dt><dd><dl><dt>"dbd" CNID backend, <a href="#id2879343">dbd</a>, <a href="#choosecnidscheme">Choosing a CNID storage scheme</a></dt></dl></dd><dt>DDP</dt><dd><dl><dt>Datagram Delivery Protocol, <a href="#id2887994">Transport Options</a></dt></dl></dd><dt>Deb</dt><dd><dl><dt>Debian package, <a href="#id2865508">Binary packages</a></dt></dl></dd><dt>Decomposed</dt><dd><dl><dt>Decomposed Unicode normalization, <a href="#id2879620">character sets used by Apple</a></dt></dl></dd><dt>DHCAST128</dt><dd><dl><dt>"DHCAST128" UAM, <a href="#id2880379">UAMs supported by Netatalk</a></dt></dl></dd><dt>DID</dt><dd><dl><dt>Directory ID, <a href="#CNID-backends">CNID backends</a></dt></dl></dd></dl></div><div class="indexdiv"><h3>F</h3><dl><dt>FID</dt><dd><dl><dt>File ID, <a href="#CNID-backends">CNID backends</a></dt></dl></dd><dt>File Services</dt><dd><dl><dt>Netatalk's File Services, <a href="#id2815878">File Services</a></dt></dl></dd></dl></div><div class="indexdiv"><h3>G</h3><dl><dt>getzones, <a href="#getzones.1">getzones</a></dt></dl></div><div class="indexdiv"><h3>H</h3><dl><dt>hqx2bin, <a href="#megatron.1">megatron</a></dt></dl></div><div class="indexdiv"><h3>I</h3><dl><dt>Iconv</dt><dd><dl><dt>iconv encoding conversion engine, <a href="#id2879945">afpd and character sets</a></dt></dl></dd><dt>IETF</dt><dd><dl><dt>Internet Engineering Task Force, <a href="#id2817243">Optional third party software</a></dt></dl></dd><dt>ISO-8859-1</dt><dd><dl><dt>afpd's volcharset setting, <a href="#id2890581">Charset options</a></dt></dl></dd><dt>ISO-8859-15</dt><dd><dl><dt>afpd's volcharset setting, <a href="#id2890581">Charset options</a></dt></dl></dd></dl></div><div class="indexdiv"><h3>K</h3><dl><dt>Kerberos IV</dt><dd><dl><dt>"Kerberos IV" UAM, <a href="#id2880379">UAMs supported by Netatalk</a></dt></dl></dd><dt>Kerberos V</dt><dd><dl><dt>"Client Krb v2" UAM, <a href="#id2880792">Which UAMs to activate?</a></dt></dl></dd></dl></div><div class="indexdiv"><h3>L</h3><dl><dt>Last</dt><dd><dl><dt>"last" CNID backend, <a href="#id2879389">last</a>, <a href="#choosecnidscheme">Choosing a CNID storage scheme</a></dt></dl></dd><dt>lpd</dt><dd><dl><dt>System V line printer daemon, <a href="#papserver">Setting up the PAP print server</a></dt></dl></dd><dt>LPR</dt><dd><dl><dt>Remote Line Printer Protocol, <a href="#printing">Printing</a></dt></dl></dd><dt>lpr</dt><dd><dl><dt>BSD lpd/lpr daemon, <a href="#papserver">Setting up the PAP print server</a></dt></dl></dd><dt>LPRng</dt><dd><dl><dt>LPR Next Generation, <a href="#papserver">Setting up the PAP print server</a></dt></dl></dd></dl></div><div class="indexdiv"><h3>M</h3><dl><dt>macbinary, <a href="#megatron.1">megatron</a></dt><dt>maccodepage</dt><dd><dl><dt>afpd's maccodepage setting, <a href="#id2879945">afpd and character sets</a></dt></dl></dd><dt>MacRoman</dt><dd><dl><dt>MacRoman charset, <a href="#id2879464">Why Unicode?</a></dt></dl></dd><dt>megatron, <a href="#megatron.1">megatron</a></dt></dl></div><div class="indexdiv"><h3>N</h3><dl><dt>NBP</dt><dd><dl><dt>Name Binding Protocol, <a href="#id2887994">Transport Options</a>, <a href="#atalkd.8">atalkd</a></dt></dl></dd><dt>nbp, <a href="#nbp.1">nbp</a></dt><dt>nbplkup, <a href="#nbp.1">nbp</a></dt><dt>nbprgstr, <a href="#nbp.1">nbp</a></dt><dt>nbpunrgstr, <a href="#nbp.1">nbp</a></dt><dt>nbp_name, <a href="#nbp_name.3">nbp_name</a></dt><dt>Nested volumes, <a href="#CNID-backends">CNID backends</a></dt><dt>net-range</dt><dd><dl><dt>AppleTalk net-range, <a href="#id2892759">Routing</a></dt></dl></dd><dt>netatalk-config, <a href="#netatalkconfig.1">netatalk-config</a></dt><dt>netatalk.conf, <a href="#id2882707">Starting and stopping Netatalk</a>, <a href="#netatalk.conf.5">netatalk.conf</a></dt><dt>NFS</dt><dd><dl><dt>Network File System, <a href="#CNID-backends">CNID backends</a>, <a href="#cnid_dbd.8">cnid_dbd</a></dt></dl></dd><dt>NLS</dt><dd><dl><dt>Native Language Support, <a href="#volumes-and-filenames">Volumes and filenames</a></dt></dl></dd><dt>No User Authent</dt><dd><dl><dt>"No User Authent" UAM (guest access), <a href="#id2880379">UAMs supported by Netatalk</a></dt></dl></dd><dt>NTP</dt><dd><dl><dt>Network Time Protocol, <a href="#timelord">Using Netatalk as a time server for Macintoshes</a></dt></dl></dd></dl></div><div class="indexdiv"><h3>P</h3><dl><dt>page accounting, <a href="#papclient">Using AppleTalk printers</a></dt><dt>PAM</dt><dd><dl><dt>Pluggable Authentication Modules, <a href="#id2817243">Optional third party software</a></dt></dl></dd><dt>Panther</dt><dd><dl><dt>Mac OS X 10.3, <a href="#id2815941">Setting up the AFP file server</a></dt></dl></dd><dt>PAP</dt><dd><dl><dt>Printer Access Protocol, <a href="#printing">Printing</a></dt></dl></dd><dt>pap, <a href="#pap.1">pap</a></dt><dt>papd, <a href="#id2882707">Starting and stopping Netatalk</a>, <a href="#papd.8">papd</a></dt><dt>papd.conf, <a href="#papd.conf.5">papd.conf</a></dt><dt>PAPD_RUN, <a href="#id2882707">Starting and stopping Netatalk</a>, <a href="#netatalk.conf.5">netatalk.conf</a></dt><dt>papstatus, <a href="#papstatus.8">papstatus</a></dt><dt>PGPuam 1.0</dt><dd><dl><dt>"PGPuam 1.0" UAM, <a href="#id2880379">UAMs supported by Netatalk</a></dt></dl></dd><dt>Phase</dt><dd><dl><dt>AppleTalk phase 1 or 2, <a href="#atalkd.8">atalkd</a>, <a href="#atalkd.conf.5">atalkd.conf</a></dt></dl></dd><dt>Ports</dt><dd><dl><dt>FreeBSD port, <a href="#id2865508">Binary packages</a></dt></dl></dd><dt>PPD</dt><dd><dl><dt>PostScript Printer Description file, <a href="#papserver">Setting up the PAP print server</a></dt></dl></dd><dt>Precomposed</dt><dd><dl><dt>Precomposed Unicode normalization, <a href="#id2879620">character sets used by Apple</a></dt></dl></dd><dt>Printing, <a href="#printing">Printing</a></dt><dt>psf, <a href="#psf.8">psf</a></dt><dt>psorder, <a href="#psorder.1">psorder</a></dt><dt>PSSP</dt><dd><dl><dt>Print Server Security Protocol, <a href="#id2899523">Notes</a></dt></dl></dd></dl></div><div class="indexdiv"><h3>Q</h3><dl><dt>Quotas</dt><dd><dl><dt>Disk usage quotas, <a href="#CNID-backends">CNID backends</a></dt></dl></dd></dl></div><div class="indexdiv"><h3>R</h3><dl><dt>Randnum exchange</dt><dd><dl><dt>"Randnum exchange" UAM, <a href="#id2880379">UAMs supported by Netatalk</a></dt></dl></dd><dt>Router</dt><dd><dl><dt>AppleTalk router, <a href="#id2815406">atalkd acting as an AppleTalk router</a></dt></dl></dd><dt>RPM</dt><dd><dl><dt>Red Hat Package Manager package, <a href="#id2865508">Binary packages</a></dt></dl></dd><dt>RTMP</dt><dd><dl><dt>Routing Table Maintainance Protocol, <a href="#atalkd.8">atalkd</a></dt></dl></dd></dl></div><div class="indexdiv"><h3>S</h3><dl><dt>Samba, <a href="#id2879620">character sets used by Apple</a></dt><dt>single2bin, <a href="#megatron.1">megatron</a></dt><dt>SLP</dt><dd><dl><dt>Service Location Protocol, <a href="#id2817243">Optional third party software</a>, <a href="#id2887994">Transport Options</a></dt></dl></dd><dt>Startscript</dt><dd><dl><dt>startup script, <a href="#id2882707">Starting and stopping Netatalk</a>, <a href="#netatalk.conf.5">netatalk.conf</a></dt></dl></dd><dt>SUN</dt><dd><dl><dt>Sun Microsystems, <a href="#id2817243">Optional third party software</a></dt></dl></dd><dt>Symlink</dt><dd><dl><dt>Unix softlink, <a href="#CNID-backends">CNID backends</a></dt></dl></dd></dl></div><div class="indexdiv"><h3>T</h3><dl><dt>Time Services, <a href="#timeservices">Time Services</a></dt><dt>Timelord</dt><dd><dl><dt>AppleTalk time server, <a href="#timeservices">Time Services</a></dt></dl></dd><dt>timelord, <a href="#timelord">Using Netatalk as a time server for Macintoshes</a>, <a href="#id2882707">Starting and stopping Netatalk</a>, <a href="#timelord.8">timelord</a></dt><dt>timeout, <a href="#timeout.1">timeout</a></dt></dl></div><div class="indexdiv"><h3>U</h3><dl><dt>UAM</dt><dd><dl><dt>User Authentication Module, <a href="#id2880338">AFP authentication basics</a>, <a href="#afppasswd.1">afppasswd</a>, <a href="#papd.8">papd</a></dt></dl></dd><dt>uams_cleartxt.so</dt><dd><dl><dt>"Cleartxt Passwrd" UAM, <a href="#id2881086">Netatalk UAM overview table</a></dt></dl></dd><dt>uams_dhx.so</dt><dd><dl><dt>"DHCAST128" UAM, <a href="#id2881086">Netatalk UAM overview table</a></dt></dl></dd><dt>uams_gss.so</dt><dd><dl><dt>"Client Krb v2" UAM (Kerberos V), <a href="#id2881086">Netatalk UAM overview table</a></dt></dl></dd><dt>uams_guest.so</dt><dd><dl><dt>"No User Authent" UAM (guest
                    access), <a href="#id2881086">Netatalk UAM overview table</a></dt></dl></dd><dt>uams_krb4.so</dt><dd><dl><dt>"Kerberos IV" UAM, <a href="#id2880379">UAMs supported by Netatalk</a></dt></dl></dd><dt>uams_pgp.so</dt><dd><dl><dt>"PGPuam 1.0" UAM, <a href="#id2880379">UAMs supported by Netatalk</a></dt></dl></dd><dt>uams_randnum.so</dt><dd><dl><dt>"(2-Way) Randnum exchange" UAM, <a href="#id2881086">Netatalk UAM overview table</a></dt></dl></dd><dt>unbin, <a href="#megatron.1">megatron</a></dt><dt>unhex, <a href="#megatron.1">megatron</a></dt><dt>Unicode, <a href="#charsets">Charsets/Unicode</a></dt><dt>uniconv, <a href="#uniconv.1">uniconv</a></dt><dt>unixcodepage</dt><dd><dl><dt>afpd's unixcodepage setting, <a href="#id2879945">afpd and character sets</a></dt></dl></dd><dt>unsingle, <a href="#megatron.1">megatron</a></dt><dt>UTF8</dt><dd><dl><dt>afpd's volcharset setting, <a href="#id2890581">Charset options</a></dt><dt>Netatalk's precomposed UTF-8 encoding, <a href="#id2879620">character sets used by Apple</a></dt></dl></dd><dt>UTF8-MAC</dt><dd><dl><dt>afpd's volcharset setting, <a href="#id2890581">Charset options</a></dt><dt>Netatalk's decomposed UTF-8 encoding, <a href="#id2879620">character sets used by Apple</a></dt></dl></dd></dl></div><div class="indexdiv"><h3>V</h3><dl><dt>volcharset</dt><dd><dl><dt>afpd's volcharset setting, <a href="#id2879945">afpd and character sets</a></dt></dl></dd></dl></div><div class="indexdiv"><h3>Z</h3><dl><dt>ZIP</dt><dd><dl><dt>Zone Information Protocol, <a href="#atalkd.8">atalkd</a></dt></dl></dd></dl></div></div></div></div></body></html>
